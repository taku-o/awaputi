<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VolumeControlComponent Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .demo-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
        }
        
        .demo-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .demo-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .demo-controls {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .demo-button {
            padding: 10px 20px;
            background: rgba(0, 255, 255, 0.2);
            border: 2px solid #00ffff;
            color: #00ffff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .demo-button:hover {
            background: rgba(0, 255, 255, 0.4);
        }
        
        .stats-display {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            margin-top: 15px;
        }
        
        .log-output {
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .error {
            color: #ff6b6b;
        }
        
        .success {
            color: #51cf66;
        }
        
        .info {
            color: #74c0fc;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>ğŸ”Š VolumeControlComponent Demo</h1>
            <p>Issue #170 - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆè¨­å®šUIç§»è¡Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ - ã‚¿ã‚¹ã‚¯1.1</p>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ“± ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢</h2>
            <div id="volume-control-container">
                <!-- VolumeControlComponent ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ® ãƒ‡ãƒ¢æ“ä½œ</h2>
            <div class="demo-controls">
                <button class="demo-button" onclick="initializeComponent()">åˆæœŸåŒ–</button>
                <button class="demo-button" onclick="testVolumeUp()">éŸ³é‡ã‚¢ãƒƒãƒ—</button>
                <button class="demo-button" onclick="testVolumeDown()">éŸ³é‡ãƒ€ã‚¦ãƒ³</button>
                <button class="demo-button" onclick="setVolumeToHalf()">50%ã«è¨­å®š</button>
                <button class="demo-button" onclick="setVolumeToMax()">æœ€å¤§éŸ³é‡</button>
                <button class="demo-button" onclick="setVolumeToMin()">æœ€å°éŸ³é‡</button>
                <button class="demo-button" onclick="showStats()">çµ±è¨ˆè¡¨ç¤º</button>
                <button class="demo-button" onclick="toggleVisibility()">è¡¨ç¤ºåˆ‡æ›¿</button>
                <button class="demo-button" onclick="disposeComponent()">ç ´æ£„</button>
            </div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ“Š çµ±è¨ˆæƒ…å ±</h2>
            <div id="stats-display" class="stats-display">
                çµ±è¨ˆæƒ…å ±ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
            </div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ“ ãƒ­ã‚°å‡ºåŠ›</h2>
            <div id="log-output" class="log-output">
                ãƒ­ã‚°ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
            </div>
        </div>
    </div>

    <script type="module">
        // MockGameEngine ã®ä½œæˆ
        class MockGameEngine {
            constructor() {
                this.settingsManager = new MockSettingsManager();
                this.audioManager = new MockAudioManager();
            }
        }
        
        class MockSettingsManager {
            constructor() {
                this.settings = { masterVolume: 0.5 };
            }
            
            get(key) {
                logMessage(`Settings get: ${key} = ${this.settings[key]}`, 'info');
                return this.settings[key];
            }
            
            set(key, value) {
                this.settings[key] = value;
                logMessage(`Settings set: ${key} = ${value}`, 'success');
            }
        }
        
        class MockAudioManager {
            playUISound(soundName, options = {}) {
                logMessage(`UI Sound: ${soundName} (volume: ${options.volume || 1.0})`, 'info');
            }
        }
        
        // MockErrorHandler ã®ä½œæˆ
        class MockErrorHandler {
            handleError(error, type, context = {}) {
                logMessage(`Error [${type}]: ${error.message}`, 'error');
                console.error('MockErrorHandler:', error, type, context);
            }
        }
        
        // MockLocalizationManager ã®ä½œæˆ
        class MockLocalizationManager {
            getText(key) {
                const translations = {
                    'settings.audio.masterVolume': 'ãƒã‚¹ã‚¿ãƒ¼éŸ³é‡',
                    'settings.audio.volumeUp': 'éŸ³é‡ã‚’ä¸Šã’ã‚‹',
                    'settings.audio.volumeDown': 'éŸ³é‡ã‚’ä¸‹ã’ã‚‹'
                };
                return translations[key] || key;
            }
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let gameEngine;
        let volumeControl;
        let isVisible = true;
        
        // ãƒ¢ãƒƒã‚¯é–¢æ•°ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«è¨­å®š
        window.getErrorHandler = () => new MockErrorHandler();
        window.getLocalizationManager = () => new MockLocalizationManager();
        
        // ãƒ­ã‚°æ©Ÿèƒ½
        function logMessage(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logOutput = document.getElementById('log-output');
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            logOutput.appendChild(logEntry);
            logOutput.scrollTop = logOutput.scrollHeight;
        }
        
        // çµ±è¨ˆè¡¨ç¤ºæ›´æ–°
        function updateStats() {
            const statsDisplay = document.getElementById('stats-display');
            if (volumeControl) {
                const stats = volumeControl.getStats();
                statsDisplay.innerHTML = `
                    <strong>VolumeControlComponent çµ±è¨ˆ:</strong><br>
                    åˆæœŸåŒ–æ¸ˆã¿: ${stats.isInitialized}<br>
                    ç¾åœ¨éŸ³é‡: ${stats.currentVolume.toFixed(2)} (${stats.currentVolumePercent}%)<br>
                    æœ€å°éŸ³é‡: ${stats.isAtMinVolume}<br>
                    æœ€å¤§éŸ³é‡: ${stats.isAtMaxVolume}<br>
                    æœ‰åŠ¹çŠ¶æ…‹: ${stats.isEnabled}<br>
                    ã‚³ãƒ³ãƒ†ãƒŠæœ‰ç„¡: ${stats.hasContainer}<br>
                    ãƒœã‚¿ãƒ³æœ‰ç„¡: ${stats.hasButtons}
                `;
            } else {
                statsDisplay.innerHTML = 'ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“';
            }
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
        window.initializeComponent = function() {
            try {
                gameEngine = new MockGameEngine();
                
                // VolumeControlComponentã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                import('./VolumeControlComponent.js').then(module => {
                    const { VolumeControlComponent } = module;
                    volumeControl = new VolumeControlComponent(gameEngine);
                    
                    const container = document.getElementById('volume-control-container');
                    container.innerHTML = ''; // ã‚¯ãƒªã‚¢
                    
                    const success = volumeControl.initialize(container);
                    if (success) {
                        logMessage('VolumeControlComponentåˆæœŸåŒ–æˆåŠŸ', 'success');
                        updateStats();
                    } else {
                        logMessage('VolumeControlComponentåˆæœŸåŒ–å¤±æ•—', 'error');
                    }
                }).catch(error => {
                    logMessage(`ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                });
            } catch (error) {
                logMessage(`åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testVolumeUp = function() {
            if (volumeControl) {
                volumeControl.handleVolumeUp();
                updateStats();
            } else {
                logMessage('ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
            }
        };
        
        window.testVolumeDown = function() {
            if (volumeControl) {
                volumeControl.handleVolumeDown();
                updateStats();
            } else {
                logMessage('ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
            }
        };
        
        window.setVolumeToHalf = function() {
            if (volumeControl) {
                volumeControl.setVolume(0.5);
                updateStats();
            }
        };
        
        window.setVolumeToMax = function() {
            if (volumeControl) {
                volumeControl.setVolume(1.0);
                updateStats();
            }
        };
        
        window.setVolumeToMin = function() {
            if (volumeControl) {
                volumeControl.setVolume(0.0);
                updateStats();
            }
        };
        
        window.showStats = function() {
            updateStats();
            if (volumeControl) {
                logMessage('çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'info');
            }
        };
        
        window.toggleVisibility = function() {
            if (volumeControl) {
                isVisible = !isVisible;
                volumeControl.setVisible(isVisible);
                logMessage(`è¡¨ç¤ºçŠ¶æ…‹: ${isVisible ? 'è¡¨ç¤º' : 'éè¡¨ç¤º'}`, 'info');
            }
        };
        
        window.disposeComponent = function() {
            if (volumeControl) {
                volumeControl.dispose();
                volumeControl = null;
                logMessage('ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç ´æ£„ã—ã¾ã—ãŸ', 'info');
                updateStats();
            }
        };
        
        // åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        logMessage('VolumeControlComponent Demo ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'success');
        logMessage('ã€ŒåˆæœŸåŒ–ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„', 'info');
    </script>
</body>
</html>