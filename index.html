<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- PWA Core Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#4CAF50">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#4CAF50">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2E7D32">
    <meta name="background-color" content="#ffffff">
    <meta name="description" content="BubblePop - æ³¡ã‚’å‰²ã£ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ã™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ ">
    <meta name="keywords" content="ã‚²ãƒ¼ãƒ ,æ³¡,ã‚¢ã‚¯ã‚·ãƒ§ãƒ³,HTML5,Canvas">
    
    <!-- Additional PWA Meta Tags -->
    <meta name="format-detection" content="telephone=no">
    <meta name="HandheldFriendly" content="true">
    <meta name="MobileOptimized" content="width">
    <meta name="orientation" content="portrait-primary">
    <meta name="screen-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="browsermode" content="application">
    
    <!-- Security and Privacy -->
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' data: blob:; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline' data: blob: fonts.googleapis.com *.googleapis.com *.gstatic.com; style-src-elem 'self' 'unsafe-inline' data: blob: fonts.googleapis.com *.googleapis.com *.gstatic.com; img-src 'self' data: blob:; connect-src 'self' fonts.gstatic.com *.gstatic.com; font-src 'self' data: blob: fonts.gstatic.com *.gstatic.com; worker-src 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <!-- X-Frame-Options removed for local execution compatibility -->
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <!-- Local Execution Detection Script -->
    <script>
        // Early local execution detection before main scripts load
        (function() {
            if (window.location.protocol === 'file:') {
                // Add local execution class to html element
                document.documentElement.classList.add('awaputi-local-execution');
                
                // Store detection result for main script
                window.AWAPUTI_LOCAL_EXECUTION = true;
                
                // Remove restrictive CSP for local execution and allow Google Fonts
                const cspMeta = document.querySelector('meta[http-equiv="Content-Security-Policy"]');
                if (cspMeta) {
                    cspMeta.setAttribute('content', 'default-src * data: blob: filesystem:; script-src * data: blob: \'unsafe-inline\' \'unsafe-eval\'; style-src * data: blob: \'unsafe-inline\' fonts.googleapis.com *.googleapis.com *.gstatic.com; style-src-elem * data: blob: \'unsafe-inline\' fonts.googleapis.com *.googleapis.com *.gstatic.com; img-src * data: blob: filesystem:; connect-src * data: blob: filesystem: fonts.gstatic.com *.gstatic.com; font-src * data: blob: filesystem: fonts.gstatic.com *.gstatic.com; worker-src * data: blob: filesystem:;');
                }
                
                console.log('ğŸ  Local file execution detected - optimizing for local mode');
            } else {
                window.AWAPUTI_LOCAL_EXECUTION = false;
            }
        })();
    </script>
    
    <!-- Performance Hints -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    
    <!-- SEO Meta Tags will be dynamically injected by SEOMetaManager -->
    <div id="seo-meta-injection-point"></div>
    
    <!-- Structured Data will be dynamically injected by StructuredDataEngine -->
    <div id="structured-data-injection-point"></div>
    <title>BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ </title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- PWAé–¢é€£ãƒ¡ã‚¿ã‚¿ã‚° -->
    <meta name="application-name" content="BubblePop">
    <meta name="msapplication-TileColor" content="#4CAF50">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- Apple PWA ãƒ¡ã‚¿ã‚¿ã‚° -->
    <meta name="apple-mobile-web-app-title" content="BubblePop">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-orientations" content="portrait">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" href="/assets/icons/icon-192x192.png">
    
    <!-- Apple Splash Screens -->
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-1024x1366.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-834x1194.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-768x1024.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-375x812.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-414x896.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-375x667.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-320x568.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    
    <!-- Latest iPhone Models -->
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-390x844.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-393x852.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-430x932.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    
    <!-- Additional Apple Device Support -->
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-896x414.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-812x375.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-1366x1024.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-1194x834.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-1024x768.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    
    <!-- Latest iPhone Models Landscape -->
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-844x390.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-852x393.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="/assets/splash-screens/apple-splash-932x430.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    
    <!-- Microsoft PWA ãƒ¡ã‚¿ã‚¿ã‚° -->
    <meta name="msapplication-starturl" content="/">
    <meta name="msapplication-tooltip" content="BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ ">
    <meta name="msapplication-navbutton-color" content="#4CAF50">
    <meta name="msapplication-window" content="width=1024;height=768">
    <meta name="msapplication-task" content="name=ã‚²ãƒ¼ãƒ é–‹å§‹;action-uri=/;icon-uri=/assets/icons/favicon-32x32.png">
    <meta name="msapplication-task" content="name=çµ±è¨ˆ;action-uri=/?action=stats;icon-uri=/assets/icons/favicon-32x32.png">
    <meta name="msapplication-allowDomainApiCalls" content="true">
    <meta name="msapplication-allowDomainMetaTags" content="true">
    
    <!-- Windows 8/10 Tiles -->
    <meta name="msapplication-square70x70logo" content="/assets/icons/mstile-70x70.png">
    <meta name="msapplication-square150x150logo" content="/assets/icons/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/assets/icons/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/assets/icons/mstile-310x310.png">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4CAF50">
    
    <!-- Additional PWA Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/assets/icons/icon-512x512.png">
    <link rel="stylesheet" href="src/styles/accessibility.css">
    <style>
        /* ãƒªã‚»ãƒƒãƒˆCSS */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            min-height: -webkit-fill-available; /* iOS Safariå¯¾å¿œ */
            position: relative;
        }
        
        /* ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ */
        #gameContainer {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            max-width: 100vw;
            max-height: 100vh;
        }
        
        /* Canvas ã‚¹ã‚¿ã‚¤ãƒ« */
        #gameCanvas {
            border: 2px solid #fff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            background: #000;
            display: block;
            max-width: 100%;
            max-height: 100%;
            
            /* ã‚¿ãƒƒãƒæ“ä½œã®æœ€é©åŒ– */
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            
            /* ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ */
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
            will-change: transform;
        }
        
        /* UI ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
        #gameUI {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 18px;
            z-index: 10;
            pointer-events: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            font-weight: bold;
            line-height: 1.4;
        }
        
        #gameUI > div {
            margin-bottom: 5px;
            background: rgba(0,0,0,0.3);
            padding: 4px 8px;
            border-radius: 4px;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media screen and (max-width: 768px) {
            body {
                padding: 0;
            }
            
            #gameCanvas {
                border-radius: 5px;
                border-width: 1px;
            }
            
            #gameUI {
                font-size: 14px;
                top: 5px;
                left: 5px;
            }
        }
        
        @media screen and (max-width: 480px) {
            #gameUI {
                font-size: 12px;
                top: 2px;
                left: 2px;
            }
            
            #gameUI > div {
                padding: 2px 6px;
                margin-bottom: 3px;
            }
        }
        
        /* æ¨ªå‘ãå¯¾å¿œ */
        @media screen and (orientation: landscape) and (max-height: 500px) {
            #gameUI {
                font-size: 12px;
                top: 2px;
                left: 2px;
            }
        }
        
        /* é«˜DPIå¯¾å¿œ */
        @media screen and (-webkit-min-device-pixel-ratio: 2),
               screen and (min-resolution: 192dpi) {
            #gameCanvas {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
            }
        }
        
        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ */
        @media (prefers-color-scheme: dark) {
            #gameUI {
                color: #f0f0f0;
            }
        }
        
        /* ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³å¯¾å¿œ */
        #gameCanvas:fullscreen {
            border: none;
            border-radius: 0;
        }
        
        #gameCanvas:-webkit-full-screen {
            border: none;
            border-radius: 0;
        }
        
        #gameCanvas:-moz-full-screen {
            border: none;
            border-radius: 0;
        }
        
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            font-size: 24px;
            text-align: center;
        }
        
        #loadingScreen.hidden {
            display: none;
        }
        
        /* ã‚¨ãƒ©ãƒ¼ç”»é¢ */
        .error-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 2000;
            max-width: 90%;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        
        /* ãƒ–ãƒ©ã‚¦ã‚¶å›ºæœ‰ã®èª¿æ•´ */
        
        /* Safari å›ºæœ‰ */
        @supports (-webkit-appearance: none) {
            body {
                -webkit-overflow-scrolling: touch;
            }
            
            #gameCanvas {
                -webkit-backface-visibility: hidden;
                backface-visibility: hidden;
            }
        }
        
        /* Firefox å›ºæœ‰ */
        @-moz-document url-prefix() {
            #gameCanvas {
                image-rendering: -moz-crisp-edges;
            }
        }
        
        /* Edge/IE å›ºæœ‰ */
        @supports (-ms-ime-align: auto) {
            #gameCanvas {
                -ms-interpolation-mode: nearest-neighbor;
            }
        }
        
        /* ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* å°åˆ·å¯¾å¿œ */
        @media print {
            body {
                background: white;
            }
            
            #gameCanvas {
                border: 1px solid black;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ -->
    <div id="loadingScreen" role="status" aria-live="polite" aria-label="ã‚²ãƒ¼ãƒ èª­ã¿è¾¼ã¿ä¸­">
        <div>
            <div>BubblePop</div>
            <div style="font-size: 16px; margin-top: 10px;">èª­ã¿è¾¼ã¿ä¸­...</div>
            <div class="loading-spinner" aria-hidden="true"></div>
        </div>
    </div>
    
    <!-- ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼ç”¨ã®èª¬æ˜ -->
    <div class="screen-reader-only">
        <h1>BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ </h1>
        <p>ç”»é¢ã«ç¾ã‚Œã‚‹æ³¡ã‚’ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ã‚¿ãƒƒãƒ—ã—ã¦å‰²ã‚Šã€é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ã™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ ã§ã™ã€‚</p>
        <p>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ: ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ã§ä¸€æ™‚åœæ­¢ã€Escã‚­ãƒ¼ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€Fã‚­ãƒ¼ã§ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³</p>
    </div>
    
    <!-- ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div id="gameContainer" role="main">
        <canvas id="gameCanvas" 
                width="800" 
                height="600" 
                role="img" 
                aria-label="ã‚²ãƒ¼ãƒ ç”»é¢"
                tabindex="0"
                aria-describedby="gameInstructions"></canvas>
        
        <!-- ã‚²ãƒ¼ãƒ çŠ¶æ…‹è¡¨ç¤º -->
        <div id="gameUI" role="status" aria-live="polite" aria-label="ã‚²ãƒ¼ãƒ çŠ¶æ…‹">
            <div aria-label="ç¾åœ¨ã®ã‚¹ã‚³ã‚¢">ã‚¹ã‚³ã‚¢: <span id="score">0</span></div>
            <div aria-label="æ®‹ã‚ŠHP">HP: <span id="hp">100</span></div>
            <div aria-label="æ®‹ã‚Šæ™‚é–“">æ™‚é–“: <span id="time">5:00</span></div>
        </div>
        
        <!-- ã‚²ãƒ¼ãƒ èª¬æ˜ï¼ˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼ç”¨ï¼‰ -->
        <div id="gameInstructions" class="screen-reader-only">
            <p>æ³¡ã‚’ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ã‚¿ãƒƒãƒ—ã—ã¦å‰²ã£ã¦ãã ã•ã„ã€‚ãƒ‰ãƒ©ãƒƒã‚°ã§æ³¡ã‚’å¹ãé£›ã°ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</p>
            <p>ãƒ”ãƒ³ã‚¯ã®æ³¡ã¯HPã‚’å›å¾©ã—ã€æ¯’ã®æ³¡ã¯ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’ä¸ãˆã¾ã™ã€‚</p>
            <p>æ™‚é–“å†…ã«ã§ãã‚‹ã ã‘å¤šãã®æ³¡ã‚’å‰²ã£ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ã€‚</p>
        </div>
    </div>
    
    <!-- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¡¨ç¤º -->
    <div id="focusIndicator" class="screen-reader-only" aria-live="polite"></div>
    
    <script type="module">
        // SEO ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        import { SEOMetaManager } from './src/seo/SEOMetaManager.js';
        import { StructuredDataEngine } from './src/seo/StructuredDataEngine.js';
        import { seoLogger } from './src/seo/SEOLogger.js';
        import { seoErrorHandler } from './src/seo/SEOErrorHandler.js';
        
        // PWAåˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
        import { getPWAManager } from './src/core/PWAManager.js';
        
        // SEOã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                seoLogger.info('SEO system initialization started');
                
                // SEOMetaManagerã®åˆæœŸåŒ–
                const seoMetaManager = new SEOMetaManager();
                
                // å‹•çš„ãƒ¡ã‚¿ã‚¿ã‚°ã®ç”Ÿæˆã¨æ³¨å…¥
                const metaInjectionPoint = document.getElementById('seo-meta-injection-point');
                if (metaInjectionPoint) {
                    try {
                        await seoMetaManager.updateDynamicContent({});
                        seoLogger.info('Dynamic meta tags updated successfully');
                    } catch (error) {
                        seoLogger.error('Failed to inject dynamic meta tags', error);
                        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: åŸºæœ¬çš„ãªãƒ¡ã‚¿ã‚¿ã‚°ã‚’æ‰‹å‹•ã§è¿½åŠ 
                        metaInjectionPoint.innerHTML = `
                            <!-- Basic SEO Meta Tags (Fallback) -->
                            <meta name="author" content="BubblePop Game Team">
                            <meta name="robots" content="index, follow">
                            <meta name="rating" content="general">
                            <meta property="og:type" content="website">
                            <meta property="og:title" content="BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ ">
                            <meta property="og:description" content="HTML5 Canvas ã‚’ä½¿ç”¨ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—ã‚²ãƒ¼ãƒ ">
                            <meta name="twitter:card" content="summary_large_image">
                            <meta name="twitter:title" content="BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ ">
                        `;
                    }
                }
                
                // StructuredDataEngineã®åˆæœŸåŒ–
                const structuredDataEngine = new StructuredDataEngine();
                
                // æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã¨æ³¨å…¥
                const structuredDataInjectionPoint = document.getElementById('structured-data-injection-point');
                if (structuredDataInjectionPoint) {
                    try {
                        const structuredData = await structuredDataEngine.generateVideoGameSchema();
                        const scriptTag = document.createElement('script');
                        scriptTag.type = 'application/ld+json';
                        scriptTag.textContent = JSON.stringify(structuredData, null, 2);
                        structuredDataInjectionPoint.appendChild(scriptTag);
                        seoLogger.info('Structured data injected successfully');
                    } catch (error) {
                        seoLogger.error('Failed to inject structured data', error);
                        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: åŸºæœ¬çš„ãªæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’æ‰‹å‹•ã§è¿½åŠ 
                        const fallbackScript = document.createElement('script');
                        fallbackScript.type = 'application/ld+json';
                        fallbackScript.textContent = JSON.stringify({
                            "@context": "https://schema.org",
                            "@type": "VideoGame",
                            "name": "BubblePop",
                            "description": "HTML5 Canvas ã‚’ä½¿ç”¨ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—ã‚²ãƒ¼ãƒ ",
                            "genre": ["Action", "Casual"],
                            "applicationCategory": "Game",
                            "operatingSystem": "Web Browser",
                            "isAccessibleForFree": true
                        }, null, 2);
                        structuredDataInjectionPoint.appendChild(fallbackScript);
                    }
                }
                
                // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ã™ã‚‹
                window.seoMetaManager = seoMetaManager;
                window.structuredDataEngine = structuredDataEngine;
                
                seoLogger.info('SEO system initialization completed');
                
            } catch (error) {
                seoErrorHandler.handle(error, 'seoSystemInit');
            }
        });
        
        // PWAæ©Ÿèƒ½ã®åˆæœŸåŒ–
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    console.log('[PWA] PWAæ©Ÿèƒ½ã‚’åˆæœŸåŒ–ä¸­...');
                    
                    // PWAManagerã‚’åˆæœŸåŒ–
                    const pwaManager = getPWAManager();
                    await pwaManager.initialize();
                    
                    console.log('[PWA] PWAæ©Ÿèƒ½åˆæœŸåŒ–å®Œäº†');
                    
                    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ã™ã‚‹
                    window.pwaManager = pwaManager;
                    
                } catch (error) {
                    console.error('[PWA] PWAåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                }
            });
        } else {
            console.log('[PWA] Service Workerã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
        }
        
        // PWAé–¢é€£ã®UIã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('[PWA] ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæº–å‚™å®Œäº†');
        });
        
        window.addEventListener('appinstalled', (e) => {
            console.log('[PWA] ã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã—ãŸ');
        });
        
        // ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ã®ç›£è¦–
        window.addEventListener('online', () => {
            console.log('[PWA] ã‚ªãƒ³ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ã«å¾©å¸°');
        });
        
        window.addEventListener('offline', () => {
            console.log('[PWA] ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ã«ç§»è¡Œ');
        });
    </script>
    <!-- Main Application Script with Local Execution Fallback -->
    <script type="module" src="src/main.js" onerror="handleModuleLoadError(event)"></script>
    
    <!-- Fallback Script for Local Execution -->
    <script>
        function handleModuleLoadError(event) {
            console.warn('ES6 module loading failed, this is expected in local file execution');
            
            // Show user-friendly message for local execution
            if (window.location.protocol === 'file:') {
                const fallbackDiv = document.createElement('div');
                fallbackDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: #fff3cd;
                    color: #856404;
                    padding: 20px;
                    border: 1px solid #ffeaa7;
                    border-radius: 8px;
                    max-width: 500px;
                    z-index: 10000;
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                `;
                
                fallbackDiv.innerHTML = `
                    <h3 style="margin: 0 0 15px 0; color: #721c24;">âš ï¸ Local File Execution Detected</h3>
                    <p style="margin: 0 0 15px 0;">
                        This game is running from a local file. For the best experience, please use a development server:
                    </p>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
                        <strong>Recommended:</strong><br>
                        <code style="background: #e9ecef; padding: 2px 4px; border-radius: 3px;">npm run dev</code>
                    </div>
                    <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">
                        <strong>Alternatives:</strong><br>
                        <code style="background: #e9ecef; padding: 2px 4px; border-radius: 3px;">python -m http.server 8000</code><br>
                        <code style="background: #e9ecef; padding: 2px 4px; border-radius: 3px;">npx serve .</code>
                    </div>
                    <button onclick="this.parentElement.remove()" style="
                        background: #007bff;
                        color: white;
                        border: none;
                        padding: 8px 16px;
                        border-radius: 4px;
                        cursor: pointer;
                        margin-top: 10px;
                    ">Continue Anyway</button>
                `;
                
                document.body.appendChild(fallbackDiv);
            }
        }
        
        // Hide loading screen after a timeout if modules fail to load
        setTimeout(() => {
            const loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen && !loadingScreen.classList.contains('hidden')) {
                loadingScreen.style.display = 'none';
            }
        }, 5000);
    </script>
</body>
</html>