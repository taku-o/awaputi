<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConfigurationManagerä¿®æ­£ãƒ†ã‚¹ãƒˆ - ç°¡æ˜“ç‰ˆ</title>
    <style>
        body {
            font-family: monospace;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1e1e1e;
            color: #fff;
        }
        .container {
            background: #2d2d2d;
            border-radius: 10px;
            padding: 20px;
        }
        h1 { text-align: center; color: #4caf50; }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background: #4caf50;
            color: white;
            cursor: pointer;
        }
        button:hover { background: #45a049; }
        .log {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
        .info { color: #2196f3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ConfigurationManagerä¿®æ­£ãƒ†ã‚¹ãƒˆ</h1>
        
        <div>
            <button onclick="quickTest()">ç°¡æ˜“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <button onclick="detailTest()">è©³ç´°ãƒãƒ–ãƒ«è¨­å®šãƒ†ã‚¹ãƒˆ</button>
            <button onclick="clearLog()">ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
        </div>
        
        <div id="log" class="log">ãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº† - ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</div>
    </div>

    <script type="module">
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type;
            logDiv.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function quickTest() {
            log('=== ConfigurationManagerä¿®æ­£ãƒ†ã‚¹ãƒˆé–‹å§‹ ===', 'info');
            
            try {
                const configModule = await import('./src/core/ConfigurationManager.js');
                const configManager = configModule.getConfigurationManager();
                
                log('âœ“ ConfigurationManagerèª­ã¿è¾¼ã¿æˆåŠŸ', 'success');
                
                // åŸºæœ¬çš„ãªè¨­å®šã‚’ãƒ†ã‚¹ãƒˆ
                const targetFPS = configManager.get('performance', 'targetFPS');
                log(`performance.targetFPS: ${targetFPS}`, targetFPS ? 'success' : 'error');
                
                // ãƒãƒ–ãƒ«è¨­å®šã‚’ãƒ†ã‚¹ãƒˆï¼ˆ5ç¨®é¡ï¼‰
                const bubbleTypes = ['normal', 'stone', 'iron', 'diamond', 'boss'];
                const properties = ['health', 'score', 'color', 'size', 'maxAge'];
                
                let successCount = 0;
                let totalTests = bubbleTypes.length * properties.length;
                
                for (const bubbleType of bubbleTypes) {
                    for (const prop of properties) {
                        const value = configManager.get('game', `bubbles.${bubbleType}.${prop}`);
                        if (value !== null && value !== undefined) {
                            successCount++;
                            log(`âœ“ bubbles.${bubbleType}.${prop}: ${value}`, 'success');
                        } else {
                            log(`âœ— bubbles.${bubbleType}.${prop}: null/undefined`, 'error');
                        }
                    }
                }
                
                const successRate = Math.round((successCount / totalTests) * 100);
                
                if (successRate === 100) {
                    log(`ğŸ‰ ä¿®æ­£æˆåŠŸï¼å…¨è¨­å®šå–å¾—å¯èƒ½: ${successCount}/${totalTests} (${successRate}%)`, 'success');
                } else if (successRate >= 90) {
                    log(`âœ… ä¿®æ­£ã»ã¼æˆåŠŸ: ${successCount}/${totalTests} (${successRate}%)`, 'success');
                } else {
                    log(`âš ï¸ ä¿®æ­£éƒ¨åˆ†æˆåŠŸ: ${successCount}/${totalTests} (${successRate}%)`, 'warning');
                }
                
            } catch (error) {
                log(`âŒ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                console.error(error);
            }
        }

        async function detailTest() {
            log('=== è©³ç´°ãƒãƒ–ãƒ«è¨­å®šãƒ†ã‚¹ãƒˆé–‹å§‹ ===', 'info');
            
            try {
                const configModule = await import('./src/core/ConfigurationManager.js');
                const configManager = configModule.getConfigurationManager();
                
                // å…¨20ç¨®é¡ã®ãƒãƒ–ãƒ«
                const allBubbleTypes = [
                    'normal', 'stone', 'iron', 'diamond', 'boss',
                    'pink', 'poison', 'spiky', 'rainbow', 'clock', 
                    'score', 'electric', 'escaping', 'cracked',
                    'golden', 'frozen', 'magnetic', 'explosive',
                    'phantom', 'multiplier'
                ];
                
                const properties = ['health', 'score', 'color', 'size', 'maxAge'];
                
                let totalSuccess = 0;
                let totalTests = allBubbleTypes.length * properties.length;
                
                log(`å…¨${allBubbleTypes.length}ç¨®é¡ã®ãƒãƒ–ãƒ«è¨­å®šã‚’ãƒ†ã‚¹ãƒˆä¸­...`, 'info');
                
                for (const bubbleType of allBubbleTypes) {
                    let bubbleSuccess = 0;
                    log(`--- ${bubbleType}ãƒãƒ–ãƒ« ---`, 'info');
                    
                    for (const prop of properties) {
                        const value = configManager.get('game', `bubbles.${bubbleType}.${prop}`);
                        if (value !== null && value !== undefined) {
                            totalSuccess++;
                            bubbleSuccess++;
                            log(`  âœ“ ${prop}: ${value}`, 'success');
                        } else {
                            log(`  âœ— ${prop}: null/undefined`, 'error');
                        }
                    }
                    
                    const bubbleRate = Math.round((bubbleSuccess / properties.length) * 100);
                    if (bubbleSuccess === properties.length) {
                        log(`${bubbleType}: å®Œå…¨æˆåŠŸ (${bubbleSuccess}/${properties.length})`, 'success');
                    } else if (bubbleSuccess > 0) {
                        log(`${bubbleType}: éƒ¨åˆ†æˆåŠŸ (${bubbleSuccess}/${properties.length})`, 'warning');
                    } else {
                        log(`${bubbleType}: å¤±æ•— (${bubbleSuccess}/${properties.length})`, 'error');
                    }
                }
                
                const finalRate = Math.round((totalSuccess / totalTests) * 100);
                log('', 'info'); // ç©ºè¡Œ
                log(`=== æœ€çµ‚çµæœ ===`, 'info');
                log(`æˆåŠŸ: ${totalSuccess}/${totalTests} (${finalRate}%)`, finalRate === 100 ? 'success' : finalRate >= 90 ? 'warning' : 'error');
                
            } catch (error) {
                log(`âŒ è©³ç´°ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }

        function clearLog() {
            document.getElementById('log').innerHTML = 'ãƒ­ã‚°ã‚¯ãƒªã‚¢å®Œäº† - ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„\n';
        }

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã¨ã—ã¦å…¬é–‹
        window.quickTest = quickTest;
        window.detailTest = detailTest;
        window.clearLog = clearLog;
        
        log('ConfigurationManagerä¿®æ­£ãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº†');
    </script>
</body>
</html>