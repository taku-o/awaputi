<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation Automation Tools Test - ç¿»è¨³è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 700;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.2em;
        }

        .tool-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #3498db;
        }

        .tool-section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tool-section h3 {
            color: #34495e;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 5px;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }

        .controls label {
            font-weight: 600;
            color: #2c3e50;
            min-width: 120px;
        }

        .controls select, .controls input {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            min-width: 150px;
        }

        .controls select:focus, .controls input:focus {
            border-color: #3498db;
            outline: none;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 10px 0;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
            min-width: auto;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }

        .btn.danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .btn.success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .results {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
            white-space: pre-wrap;
            line-height: 1.4;
        }

        .status {
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 6px;
            font-weight: 600;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #ecf0f1;
        }

        .tab {
            padding: 12px 20px;
            background: #ecf0f1;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #7f8c8d;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #3498db;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .file-input-area {
            border: 2px dashed #bdc3c7;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            margin: 15px 0;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-input-area:hover {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .file-input-area.dragover {
            border-color: #27ae60;
            background: #e8f5e8;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 12px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: #3498db;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .output-format-selector {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .format-option {
            padding: 8px 15px;
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .format-option.selected {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }

        .icon {
            font-size: 1.2em;
            margin-right: 5px;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .controls label {
                min-width: auto;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1;
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– Translation Automation Tools</h1>
        <p class="subtitle">ç¿»è¨³è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ« - ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆãƒ»ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</p>

        <div class="tabs">
            <button class="tab active" onclick="showTab('generator')">
                <span class="icon">ğŸ—ï¸</span>ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
            </button>
            <button class="tab" onclick="showTab('export')">
                <span class="icon">ğŸ“¤</span>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
            </button>
            <button class="tab" onclick="showTab('import')">
                <span class="icon">ğŸ“¥</span>ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
            </button>
            <button class="tab" onclick="showTab('sync')">
                <span class="icon">ğŸ”„</span>åŒæœŸç®¡ç†
            </button>
            <button class="tab" onclick="showTab('extraction')">
                <span class="icon">ğŸ”</span>ã‚­ãƒ¼æŠ½å‡º
            </button>
        </div>

        <!-- ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆã‚¿ãƒ– -->
        <div id="generator" class="tab-content active">
            <div class="tool-section">
                <h2><span class="icon">ğŸ—ï¸</span>ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆãƒ„ãƒ¼ãƒ«</h2>
                
                <h3>æ–°è¨€èªãƒ•ã‚¡ã‚¤ãƒ«ã‚»ãƒƒãƒˆç”Ÿæˆ</h3>
                <div class="controls">
                    <label>å¯¾è±¡è¨€èª:</label>
                    <select id="generateLanguage">
                        <option value="zh-CN">ä¸­å›½èª (ç°¡ä½“å­—)</option>
                        <option value="zh-TW">ä¸­å›½èª (ç¹ä½“å­—)</option>
                        <option value="ko">éŸ“å›½èª</option>
                        <option value="fr">ãƒ•ãƒ©ãƒ³ã‚¹èª</option>
                        <option value="de">ãƒ‰ã‚¤ãƒ„èª</option>
                        <option value="es">ã‚¹ãƒšã‚¤ãƒ³èª</option>
                        <option value="ar">ã‚¢ãƒ©ãƒ“ã‚¢èª</option>
                    </select>
                    
                    <label>åŸºæº–è¨€èª:</label>
                    <select id="baseLanguage">
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="en">è‹±èª</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="includeEmpty" checked>
                        ç©ºç¿»è¨³ã‚’å«ã‚ã‚‹
                    </label>
                    <label>
                        <input type="checkbox" id="generateTemplates" checked>
                        ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
                    </label>
                    <label>
                        <input type="checkbox" id="preserveExisting" checked>
                        æ—¢å­˜ç¿»è¨³ã‚’ä¿æŒ
                    </label>
                </div>

                <button class="btn" onclick="generateLanguageFiles()">
                    <span class="icon">ğŸ—ï¸</span>è¨€èªãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
                </button>
                <button class="btn secondary" onclick="generateTemplate()">
                    <span class="icon">ğŸ“‹</span>ç¿»è¨³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
                </button>
                <button class="btn secondary" onclick="getSupportedLanguages()">
                    <span class="icon">ğŸŒ</span>ã‚µãƒãƒ¼ãƒˆè¨€èªä¸€è¦§
                </button>

                <div id="generatorResults" class="results"></div>
            </div>
        </div>

        <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¿ãƒ– -->
        <div id="export" class="tab-content">
            <div class="tool-section">
                <h2><span class="icon">ğŸ“¤</span>ç¿»è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½</h2>
                
                <h3>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨­å®š</h3>
                <div class="controls">
                    <label>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨€èª:</label>
                    <select id="exportLanguage">
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="en">è‹±èª</option>
                        <option value="zh-CN">ä¸­å›½èª (ç°¡ä½“å­—)</option>
                        <option value="ko">éŸ“å›½èª</option>
                    </select>
                    
                    <label>ã‚«ãƒ†ã‚´ãƒª:</label>
                    <select id="exportCategories" multiple>
                        <option value="common">å…±é€š</option>
                        <option value="menu">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</option>
                        <option value="game">ã‚²ãƒ¼ãƒ </option>
                        <option value="settings">è¨­å®š</option>
                        <option value="errors">ã‚¨ãƒ©ãƒ¼</option>
                        <option value="achievements">å®Ÿç¸¾</option>
                        <option value="help">ãƒ˜ãƒ«ãƒ—</option>
                    </select>
                </div>

                <h3>å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</h3>
                <div class="output-format-selector">
                    <div class="format-option selected" data-format="json">
                        <span class="icon">ğŸ“„</span>JSON
                    </div>
                    <div class="format-option" data-format="csv">
                        <span class="icon">ğŸ“Š</span>CSV
                    </div>
                    <div class="format-option" data-format="xlsx">
                        <span class="icon">ğŸ“ˆ</span>Excel
                    </div>
                    <div class="format-option" data-format="xml">
                        <span class="icon">ğŸ“œ</span>XML
                    </div>
                    <div class="format-option" data-format="properties">
                        <span class="icon">âš™ï¸</span>Properties
                    </div>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="includeMetadata" checked>
                        ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ã‚‹
                    </label>
                    <label>
                        <input type="checkbox" id="includeEmptyKeys">
                        ç©ºã‚­ãƒ¼ã‚’å«ã‚ã‚‹
                    </label>
                    <label>
                        <input type="checkbox" id="flattenStructure">
                        æ§‹é€ ã‚’å¹³å¦åŒ–
                    </label>
                </div>

                <button class="btn" onclick="exportTranslations()">
                    <span class="icon">ğŸ“¤</span>ç¿»è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                </button>
                <button class="btn secondary" onclick="getSupportedFormats()">
                    <span class="icon">ğŸ“‹</span>ã‚µãƒãƒ¼ãƒˆå½¢å¼ä¸€è¦§
                </button>

                <div id="exportResults" class="results"></div>
            </div>
        </div>

        <!-- ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¿ãƒ– -->
        <div id="import" class="tab-content">
            <div class="tool-section">
                <h2><span class="icon">ğŸ“¥</span>ç¿»è¨³ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½</h2>
                
                <h3>ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¨­å®š</h3>
                <div class="controls">
                    <label>å¯¾è±¡è¨€èª:</label>
                    <select id="importLanguage">
                        <option value="">è‡ªå‹•æ¤œå‡º</option>
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="en">è‹±èª</option>
                        <option value="zh-CN">ä¸­å›½èª (ç°¡ä½“å­—)</option>
                        <option value="ko">éŸ“å›½èª</option>
                    </select>
                    
                    <label>ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼:</label>
                    <select id="importFormat">
                        <option value="auto">è‡ªå‹•æ¤œå‡º</option>
                        <option value="json">JSON</option>
                        <option value="csv">CSV</option>
                        <option value="xlsx">Excel</option>
                        <option value="xml">XML</option>
                        <option value="properties">Properties</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="validateKeys" checked>
                        ã‚­ãƒ¼æ¤œè¨¼
                    </label>
                    <label>
                        <input type="checkbox" id="preserveExistingImport" checked>
                        æ—¢å­˜ç¿»è¨³ã‚’ä¿æŒ
                    </label>
                    <label>
                        <input type="checkbox" id="strictMode">
                        å³å¯†ãƒ¢ãƒ¼ãƒ‰
                    </label>
                    <label>
                        <input type="checkbox" id="createBackup" checked>
                        ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
                    </label>
                </div>

                <h3>ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ</h3>
                <div class="file-input-area" id="fileDropArea">
                    <p><span class="icon">ğŸ“</span>ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã‹ã€ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</p>
                    <input type="file" id="fileInput" style="display: none;" accept=".json,.csv,.xlsx,.xml,.properties">
                </div>

                <h3>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ãƒ†ã‚¹ãƒˆ</h3>
                <div class="controls">
                    <button class="btn secondary" onclick="loadSampleJSON()">JSONã‚µãƒ³ãƒ—ãƒ«</button>
                    <button class="btn secondary" onclick="loadSampleCSV()">CSVã‚µãƒ³ãƒ—ãƒ«</button>
                    <button class="btn secondary" onclick="loadSampleXML()">XMLã‚µãƒ³ãƒ—ãƒ«</button>
                </div>

                <button class="btn" onclick="importTranslations()" id="importBtn" disabled>
                    <span class="icon">ğŸ“¥</span>ç¿»è¨³ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                </button>

                <div id="importResults" class="results"></div>
            </div>
        </div>

        <!-- åŒæœŸç®¡ç†ã‚¿ãƒ– -->
        <div id="sync" class="tab-content">
            <div class="tool-section">
                <h2><span class="icon">ğŸ”„</span>ç¿»è¨³åŒæœŸç®¡ç†</h2>
                
                <h3>åŒæœŸè¨­å®š</h3>
                <div class="controls">
                    <label>åŸºæº–è¨€èª:</label>
                    <select id="syncBaseLanguage">
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="en">è‹±èª</option>
                    </select>
                    
                    <label>å¯¾è±¡è¨€èª:</label>
                    <select id="syncTargetLanguages" multiple>
                        <option value="en">è‹±èª</option>
                        <option value="zh-CN">ä¸­å›½èª (ç°¡ä½“å­—)</option>
                        <option value="zh-TW">ä¸­å›½èª (ç¹ä½“å­—)</option>
                        <option value="ko">éŸ“å›½èª</option>
                        <option value="fr">ãƒ•ãƒ©ãƒ³ã‚¹èª</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="addMissingKeys" checked>
                        ä¸è¶³ã‚­ãƒ¼ã‚’è¿½åŠ 
                    </label>
                    <label>
                        <input type="checkbox" id="removeObsoleteKeys">
                        å»ƒæ­¢ã‚­ãƒ¼ã‚’å‰Šé™¤
                    </label>
                    <label>
                        <input type="checkbox" id="updateMetadata" checked>
                        ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°
                    </label>
                    <label>
                        <input type="checkbox" id="generateSyncReport" checked>
                        åŒæœŸãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
                    </label>
                </div>

                <button class="btn" onclick="synchronizeFiles()">
                    <span class="icon">ğŸ”„</span>ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸå®Ÿè¡Œ
                </button>
                <button class="btn secondary" onclick="manageDifferences()">
                    <span class="icon">ğŸ”</span>å·®åˆ†ç®¡ç†
                </button>

                <h3>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†</h3>
                <div class="controls">
                    <label>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨€èª:</label>
                    <select id="backupLanguage">
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="en">è‹±èª</option>
                        <option value="zh-CN">ä¸­å›½èª (ç°¡ä½“å­—)</option>
                        <option value="ko">éŸ“å›½èª</option>
                    </select>
                    
                    <label>èª¬æ˜:</label>
                    <input type="text" id="backupDescription" placeholder="ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®èª¬æ˜ã‚’å…¥åŠ›" value="æ‰‹å‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—">
                </div>

                <button class="btn success" onclick="createBackup()">
                    <span class="icon">ğŸ’¾</span>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
                </button>
                <button class="btn secondary" onclick="listBackups()">
                    <span class="icon">ğŸ“‹</span>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸€è¦§
                </button>

                <div id="syncResults" class="results"></div>
            </div>
        </div>

        <!-- ã‚­ãƒ¼æŠ½å‡ºã‚¿ãƒ– -->
        <div id="extraction" class="tab-content">
            <div class="tool-section">
                <h2><span class="icon">ğŸ”</span>ç¿»è¨³ã‚­ãƒ¼è‡ªå‹•æŠ½å‡º</h2>
                
                <h3>æŠ½å‡ºè¨­å®š</h3>
                <div class="controls">
                    <label>å‡ºåŠ›å½¢å¼:</label>
                    <select id="extractionOutputFormat">
                        <option value="detailed">è©³ç´°</option>
                        <option value="summary">è¦ç´„</option>
                        <option value="keys-only">ã‚­ãƒ¼ã®ã¿</option>
                        <option value="csv">CSV</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="includeContext" checked>
                        ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚ã‚‹
                    </label>
                    <label>
                        <input type="checkbox" id="autoRegister" checked>
                        ã‚­ãƒ¼ã‚’è‡ªå‹•ç™»éŒ²
                    </label>
                    <label>
                        <input type="checkbox" id="showStatistics" checked>
                        çµ±è¨ˆæƒ…å ±è¡¨ç¤º
                    </label>
                </div>

                <h3>æŠ½å‡ºãƒ‘ã‚¿ãƒ¼ãƒ³</h3>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="pattern_t" checked>
                        t('key') ãƒ‘ã‚¿ãƒ¼ãƒ³
                    </label>
                    <label>
                        <input type="checkbox" id="pattern_translate" checked>
                        translate('key') ãƒ‘ã‚¿ãƒ¼ãƒ³
                    </label>
                    <label>
                        <input type="checkbox" id="pattern_getText" checked>
                        getText('key') ãƒ‘ã‚¿ãƒ¼ãƒ³
                    </label>
                    <label>
                        <input type="checkbox" id="pattern_$t" checked>
                        $t('key') ãƒ‘ã‚¿ãƒ¼ãƒ³
                    </label>
                </div>

                <h3>ã‚µãƒ³ãƒ—ãƒ«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h3>
                <div class="controls">
                    <button class="btn secondary" onclick="loadSampleSource()">ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿</button>
                    <button class="btn secondary" onclick="clearExtractionResults()">çµæœã‚¯ãƒªã‚¢</button>
                </div>

                <button class="btn" onclick="extractTranslationKeys()">
                    <span class="icon">ğŸ”</span>ç¿»è¨³ã‚­ãƒ¼æŠ½å‡ºå®Ÿè¡Œ
                </button>

                <div id="extractionResults" class="results"></div>
            </div>
        </div>
    </div>

    <!-- çµ±è¨ˆè¡¨ç¤º -->
    <div class="container">
        <h2><span class="icon">ğŸ“Š</span>è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«çµ±è¨ˆ</h2>
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <div class="stat-number" id="generatedFiles">0</div>
                <div class="stat-label">ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="exportedFiles">0</div>
                <div class="stat-label">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå›æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="importedFiles">0</div>
                <div class="stat-label">ã‚¤ãƒ³ãƒãƒ¼ãƒˆå›æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="syncOperations">0</div>
                <div class="stat-label">åŒæœŸæ“ä½œå›æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="extractedKeys">0</div>
                <div class="stat-label">æŠ½å‡ºã‚­ãƒ¼æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="backupsCreated">0</div>
                <div class="stat-label">ä½œæˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ•°</div>
            </div>
        </div>
    </div>

    <script type="module">
        import { getTranslationFileGenerator } from './src/core/i18n/automation/TranslationFileGenerator.js';
        import { getTranslationImportExport } from './src/core/i18n/automation/TranslationImportExport.js';

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let fileGenerator, importExport;
        let currentFile = null;
        let statistics = {
            generatedFiles: 0,
            exportedFiles: 0,
            importedFiles: 0,
            syncOperations: 0,
            extractedKeys: 0,
            backupsCreated: 0
        };

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                fileGenerator = getTranslationFileGenerator();
                importExport = getTranslationImportExport();
                
                setupEventListeners();
                updateStatistics();
                showStatus('è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆãŒåˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ', 'success');
            } catch (error) {
                console.error('Initialization error:', error);
                showStatus(`åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        });

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        function setupEventListeners() {
            // ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½
            const dropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');

            dropArea.addEventListener('click', () => fileInput.click());
            dropArea.addEventListener('dragover', handleDragOver);
            dropArea.addEventListener('dragleave', handleDragLeave);
            dropArea.addEventListener('drop', handleFileDrop);
            
            fileInput.addEventListener('change', handleFileSelect);

            // ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé¸æŠ
            document.querySelectorAll('.format-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    document.querySelectorAll('.format-option').forEach(opt => opt.classList.remove('selected'));
                    e.target.classList.add('selected');
                });
            });
        }

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        window.showTab = function(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`[onclick="showTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        };

        // ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆæ©Ÿèƒ½
        window.generateLanguageFiles = async function() {
            const language = document.getElementById('generateLanguage').value;
            const baseLanguage = document.getElementById('baseLanguage').value;
            const includeEmpty = document.getElementById('includeEmpty').checked;
            const generateTemplates = document.getElementById('generateTemplates').checked;
            const preserveExisting = document.getElementById('preserveExisting').checked;

            showProgress('è¨€èªãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆä¸­...', 30);
            
            try {
                const result = await fileGenerator.generateLanguageFiles(language, {
                    baseLanguage: baseLanguage,
                    includeEmpty: includeEmpty,
                    generateTemplates: generateTemplates,
                    preserveExisting: preserveExisting
                });

                showProgress('è¨€èªãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆå®Œäº†', 100);
                
                if (result.success) {
                    statistics.generatedFiles += result.results.totalFiles;
                    updateStatistics();
                    
                    displayResults('generatorResults', {
                        title: `${result.results.languageName} (${result.results.language}) è¨€èªãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆçµæœ`,
                        data: {
                            'ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«æ•°': result.results.totalFiles,
                            'ç·ã‚­ãƒ¼æ•°': result.results.totalKeys,
                            'ã‚¨ãƒ©ãƒ¼æ•°': result.results.errors.length,
                            'ç”Ÿæˆæ—¥æ™‚': new Date().toLocaleString('ja-JP')
                        },
                        details: result.results.filesGenerated,
                        files: result.files
                    });
                    showStatus(`${result.results.languageName}ã®è¨€èªãƒ•ã‚¡ã‚¤ãƒ«ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸ`, 'success');
                } else {
                    displayResults('generatorResults', { error: result.error });
                    showStatus(`ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${result.error}`, 'error');
                }
            } catch (error) {
                console.error('Generation error:', error);
                showStatus(`ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                displayResults('generatorResults', { error: error.message });
            }
        };

        window.generateTemplate = async function() {
            showProgress('ç¿»è¨³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆä¸­...', 50);
            
            try {
                // ãƒ¢ãƒƒã‚¯ç¿»è¨³ãƒ‡ãƒ¼ã‚¿
                const baseTranslations = {
                    common: {
                        ok: 'OK',
                        cancel: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
                        save: 'ä¿å­˜'
                    },
                    menu: {
                        play: 'ãƒ—ãƒ¬ã‚¤',
                        settings: 'è¨­å®š'
                    }
                };

                const template = fileGenerator.generateTranslationTemplate(baseTranslations, {
                    language: 'new',
                    includeInstructions: true,
                    includeExamples: true
                });

                showProgress('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆå®Œäº†', 100);
                
                displayResults('generatorResults', {
                    title: 'ç¿»è¨³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆçµæœ',
                    template: template
                });
                showStatus('ç¿»è¨³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸ', 'success');
            } catch (error) {
                console.error('Template generation error:', error);
                showStatus(`ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };

        window.getSupportedLanguages = function() {
            const languages = fileGenerator.getSupportedLanguages();
            displayResults('generatorResults', {
                title: 'ã‚µãƒãƒ¼ãƒˆè¨€èªä¸€è¦§',
                languages: languages
            });
        };

        // ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½
        window.exportTranslations = async function() {
            const language = document.getElementById('exportLanguage').value;
            const categories = Array.from(document.getElementById('exportCategories').selectedOptions).map(opt => opt.value);
            const format = document.querySelector('.format-option.selected').dataset.format;
            const includeMetadata = document.getElementById('includeMetadata').checked;
            const includeEmptyKeys = document.getElementById('includeEmptyKeys').checked;
            const flattenStructure = document.getElementById('flattenStructure').checked;

            showProgress('ç¿»è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆä¸­...', 40);
            
            try {
                const result = await importExport.exportTranslations(language, {
                    format: format,
                    categories: categories,
                    includeMetadata: includeMetadata,
                    includeEmptyKeys: includeEmptyKeys,
                    flattenStructure: flattenStructure
                });

                showProgress('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå®Œäº†', 100);
                
                if (result.success) {
                    statistics.exportedFiles++;
                    updateStatistics();
                    
                    displayResults('exportResults', {
                        title: `${language} ç¿»è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆçµæœ`,
                        data: {
                            'è¨€èª': result.language,
                            'å½¢å¼': result.format,
                            'ãƒ•ã‚¡ã‚¤ãƒ«å': result.fileName,
                            'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º': `${result.size} bytes`,
                            'ç·ã‚­ãƒ¼æ•°': result.statistics.totalKeys,
                            'ç©ºã‚­ãƒ¼æ•°': result.statistics.emptyKeys,
                            'ã‚«ãƒ†ã‚´ãƒªæ•°': result.statistics.categories.length,
                            'ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ—¥æ™‚': new Date(result.exportedAt).toLocaleString('ja-JP')
                        },
                        content: result.content
                    });
                    showStatus(`${language} ã®ç¿»è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ`, 'success');
                } else {
                    displayResults('exportResults', { error: result.error });
                    showStatus(`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${result.error}`, 'error');
                }
            } catch (error) {
                console.error('Export error:', error);
                showStatus(`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };

        window.getSupportedFormats = function() {
            const formats = importExport.getSupportedFormats();
            displayResults('exportResults', {
                title: 'ã‚µãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ä¸€è¦§',
                formats: formats
            });
        };

        // ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½
        window.importTranslations = async function() {
            if (!currentFile) {
                showStatus('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const language = document.getElementById('importLanguage').value;
            const format = document.getElementById('importFormat').value;
            const validateKeys = document.getElementById('validateKeys').checked;
            const preserveExisting = document.getElementById('preserveExistingImport').checked;
            const strictMode = document.getElementById('strictMode').checked;
            const createBackup = document.getElementById('createBackup').checked;

            showProgress('ç¿»è¨³ã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸­...', 60);
            
            try {
                const result = await importExport.importTranslations(currentFile.content, {
                    format: format,
                    language: language,
                    fileName: currentFile.name,
                    validateKeys: validateKeys,
                    preserveExisting: preserveExisting,
                    strictMode: strictMode,
                    createBackup: createBackup
                });

                showProgress('ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†', 100);
                
                if (result.success) {
                    statistics.importedFiles++;
                    if (result.backup?.created) {
                        statistics.backupsCreated++;
                    }
                    updateStatistics();
                    
                    displayResults('importResults', {
                        title: `${result.language} ç¿»è¨³ã‚¤ãƒ³ãƒãƒ¼ãƒˆçµæœ`,
                        data: {
                            'è¨€èª': result.language,
                            'å½¢å¼': result.format,
                            'ç·ã‚­ãƒ¼æ•°': result.statistics.totalKeys,
                            'ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚­ãƒ¼æ•°': result.statistics.importedKeys,
                            'ã‚¹ã‚­ãƒƒãƒ—ã‚­ãƒ¼æ•°': result.statistics.skippedKeys,
                            'æ›´æ–°ã‚­ãƒ¼æ•°': result.statistics.updatedKeys,
                            'æ–°è¦ã‚­ãƒ¼æ•°': result.statistics.newKeys,
                            'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—': result.backup ? 'ä½œæˆæ¸ˆã¿' : 'æœªä½œæˆ',
                            'ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ—¥æ™‚': new Date(result.importedAt).toLocaleString('ja-JP')
                        },
                        validation: result.validation
                    });
                    showStatus(`${result.language} ã®ç¿»è¨³ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ`, 'success');
                } else {
                    displayResults('importResults', { error: result.error });
                    showStatus(`ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${result.error}`, 'error');
                }
            } catch (error) {
                console.error('Import error:', error);
                showStatus(`ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };

        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        window.loadSampleJSON = function() {
            const sampleJSON = `{
  "_metadata": {
    "language": "en",
    "version": "1.0.0",
    "translator": "Sample Translator"
  },
  "common": {
    "ok": "OK",
    "cancel": "Cancel",
    "save": "Save",
    "delete": "Delete"
  },
  "menu": {
    "play": "Play",
    "settings": "Settings",
    "help": "Help",
    "exit": "Exit"
  }
}`;
            currentFile = { name: 'sample.json', content: sampleJSON };
            document.getElementById('importBtn').disabled = false;
            showStatus('JSONã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'info');
        };

        window.loadSampleCSV = function() {
            const sampleCSV = `Key,Value,Category,Notes
"common.ok","OK","common",""
"common.cancel","Cancel","common",""
"common.save","Save","common",""
"menu.play","Play","menu",""
"menu.settings","Settings","menu",""`;
            currentFile = { name: 'sample.csv', content: sampleCSV };
            document.getElementById('importBtn').disabled = false;
            showStatus('CSVã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'info');
        };

        window.loadSampleXML = function() {
            const sampleXML = `<?xml version="1.0" encoding="UTF-8"?>
<translations language="en">
  <common>
    <ok>OK</ok>
    <cancel>Cancel</cancel>
    <save>Save</save>
  </common>
  <menu>
    <play>Play</play>
    <settings>Settings</settings>
  </menu>
</translations>`;
            currentFile = { name: 'sample.xml', content: sampleXML };
            document.getElementById('importBtn').disabled = false;
            showStatus('XMLã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'info');
        };

        // åŒæœŸæ©Ÿèƒ½
        window.synchronizeFiles = async function() {
            const baseLanguage = document.getElementById('syncBaseLanguage').value;
            const targetLanguages = Array.from(document.getElementById('syncTargetLanguages').selectedOptions).map(opt => opt.value);
            const addMissingKeys = document.getElementById('addMissingKeys').checked;
            const removeObsoleteKeys = document.getElementById('removeObsoleteKeys').checked;
            const updateMetadata = document.getElementById('updateMetadata').checked;
            const generateReport = document.getElementById('generateSyncReport').checked;

            if (targetLanguages.length === 0) {
                showStatus('å¯¾è±¡è¨€èªã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
                return;
            }

            showProgress('ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸä¸­...', 70);
            
            try {
                const result = await fileGenerator.synchronizeTranslationFiles(baseLanguage, targetLanguages, {
                    addMissingKeys: addMissingKeys,
                    removeObsoleteKeys: removeObsoleteKeys,
                    updateMetadata: updateMetadata,
                    generateReport: generateReport
                });

                showProgress('åŒæœŸå®Œäº†', 100);
                statistics.syncOperations++;
                updateStatistics();
                
                displayResults('syncResults', {
                    title: `ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸçµæœ`,
                    data: {
                        'åŸºæº–è¨€èª': result.baseLanguage,
                        'å¯¾è±¡è¨€èªæ•°': result.targetLanguages.length,
                        'å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«æ•°': result.summary.filesProcessed,
                        'è¿½åŠ ã‚­ãƒ¼æ•°': result.summary.keysAdded,
                        'æ›´æ–°ã‚­ãƒ¼æ•°': result.summary.keysUpdated,
                        'å‰Šé™¤ã‚­ãƒ¼æ•°': result.summary.keysRemoved,
                        'ã‚¨ãƒ©ãƒ¼æ•°': result.summary.errors,
                        'åŒæœŸæ—¥æ™‚': new Date(result.timestamp).toLocaleString('ja-JP')
                    },
                    changes: Object.fromEntries(result.changes)
                });
                showStatus('ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
            } catch (error) {
                console.error('Synchronization error:', error);
                showStatus(`åŒæœŸã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };

        window.manageDifferences = async function() {
            try {
                // ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§å·®åˆ†ç®¡ç†ã‚’ãƒ†ã‚¹ãƒˆ
                const baseVersion = {
                    common: { ok: 'OK', cancel: 'Cancel' },
                    menu: { play: 'Play' }
                };
                
                const newVersion = {
                    common: { ok: 'OK', cancel: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«', save: 'Save' },
                    menu: { play: 'ãƒ—ãƒ¬ã‚¤', settings: 'Settings' }
                };

                const differences = await importExport.manageDifferences(baseVersion, newVersion, {
                    generatePatch: true,
                    includeMetadata: true
                });

                displayResults('syncResults', {
                    title: 'ç¿»è¨³ãƒ‡ãƒ¼ã‚¿å·®åˆ†ç®¡ç†çµæœ',
                    data: {
                        'ç·å¤‰æ›´æ•°': differences.statistics.totalChanges,
                        'è¿½åŠ æ•°': differences.statistics.addedCount,
                        'å¤‰æ›´æ•°': differences.statistics.modifiedCount,
                        'å‰Šé™¤æ•°': differences.statistics.deletedCount,
                        'åˆ†ææ—¥æ™‚': new Date(differences.timestamp).toLocaleString('ja-JP')
                    },
                    differences: differences
                });
                showStatus('å·®åˆ†åˆ†æãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
            } catch (error) {
                console.error('Difference management error:', error);
                showStatus(`å·®åˆ†ç®¡ç†ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };

        window.createBackup = async function() {
            const language = document.getElementById('backupLanguage').value;
            const description = document.getElementById('backupDescription').value;

            showProgress('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆä¸­...', 80);
            
            try {
                const backup = await importExport.createBackup(language, {
                    description: description,
                    includeMetadata: true
                });

                showProgress('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†', 100);
                statistics.backupsCreated++;
                updateStatistics();
                
                displayResults('syncResults', {
                    title: `${language} ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆçµæœ`,
                    data: {
                        'ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ID': backup.id,
                        'è¨€èª': backup.language,
                        'èª¬æ˜': backup.description,
                        'ä½œæˆæ—¥æ™‚': new Date(backup.timestamp).toLocaleString('ja-JP'),
                        'ç·ã‚­ãƒ¼æ•°': backup.statistics.totalKeys,
                        'å…ƒã‚µã‚¤ã‚º': `${backup.metadata.originalSize} bytes`,
                        'åœ§ç¸®': backup.compressed ? 'ã‚ã‚Š' : 'ãªã—'
                    }
                });
                showStatus(`${language} ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒä½œæˆã•ã‚Œã¾ã—ãŸ`, 'success');
            } catch (error) {
                console.error('Backup creation error:', error);
                showStatus(`ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };

        // ã‚­ãƒ¼æŠ½å‡ºæ©Ÿèƒ½
        window.extractTranslationKeys = async function() {
            const outputFormat = document.getElementById('extractionOutputFormat').value;
            const includeContext = document.getElementById('includeContext').checked;
            const autoRegister = document.getElementById('autoRegister').checked;

            // æŠ½å‡ºãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åé›†
            const patterns = [];
            if (document.getElementById('pattern_t').checked) {
                patterns.push(/t\(['"`]([^'"`]+)['"`]\)/g);
            }
            if (document.getElementById('pattern_translate').checked) {
                patterns.push(/translate\(['"`]([^'"`]+)['"`]\)/g);
            }
            if (document.getElementById('pattern_getText').checked) {
                patterns.push(/getText\(['"`]([^'"`]+)['"`]\)/g);
            }
            if (document.getElementById('pattern_$t').checked) {
                patterns.push(/\$t\(['"`]([^'"`]+)['"`]\)/g);
            }

            showProgress('ç¿»è¨³ã‚­ãƒ¼æŠ½å‡ºä¸­...', 90);
            
            try {
                // ã‚µãƒ³ãƒ—ãƒ«ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«
                const sourceFiles = ['sample1.js', 'sample2.js'];
                
                const result = await fileGenerator.extractTranslationKeys(sourceFiles, {
                    patterns: patterns,
                    includeContext: includeContext,
                    autoRegister: autoRegister,
                    outputFormat: outputFormat
                });

                showProgress('æŠ½å‡ºå®Œäº†', 100);
                statistics.extractedKeys += result.uniqueKeys || 0;
                updateStatistics();
                
                displayResults('extractionResults', {
                    title: 'ç¿»è¨³ã‚­ãƒ¼æŠ½å‡ºçµæœ',
                    data: {
                        'å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«æ•°': result.totalFiles,
                        'ç·ã‚­ãƒ¼æ•°': result.totalKeys,
                        'ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚­ãƒ¼æ•°': result.uniqueKeys,
                        'ã‚¨ãƒ©ãƒ¼æ•°': result.errors.length,
                        'è‡ªå‹•ç™»éŒ²': autoRegister ? 'ã‚ã‚Š' : 'ãªã—',
                        'æŠ½å‡ºæ—¥æ™‚': new Date().toLocaleString('ja-JP')
                    },
                    extractedKeys: result.extractedKeys,
                    keysByFile: Object.fromEntries(result.keysByFile || [])
                });
                showStatus(`${result.uniqueKeys} å€‹ã®ç¿»è¨³ã‚­ãƒ¼ã‚’æŠ½å‡ºã—ã¾ã—ãŸ`, 'success');
            } catch (error) {
                console.error('Key extraction error:', error);
                showStatus(`ã‚­ãƒ¼æŠ½å‡ºã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };

        window.loadSampleSource = function() {
            displayResults('extractionResults', {
                title: 'ã‚µãƒ³ãƒ—ãƒ«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰',
                sourceCode: `// sample1.js
const message = t('common.welcome');
const title = translate('menu.mainTitle');
const error = getText('errors.networkError');

// sample2.js
function showDialog() {
    const okText = t('common.ok');
    const cancelText = $t('common.cancel');
    return getText('dialog.confirmMessage');
}`
            });
            showStatus('ã‚µãƒ³ãƒ—ãƒ«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ', 'info');
        };

        window.clearExtractionResults = function() {
            document.getElementById('extractionResults').innerHTML = '';
            showStatus('æŠ½å‡ºçµæœã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ', 'info');
        };

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function showStatus(message, type) {
            const existing = document.querySelector('.status');
            if (existing) existing.remove();
            
            const status = document.createElement('div');
            status.className = `status ${type}`;
            status.textContent = message;
            document.body.insertBefore(status, document.body.firstChild);
            
            setTimeout(() => status.remove(), 5000);
        }

        function showProgress(message, percent) {
            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼è¡¨ç¤ºã®å®Ÿè£…ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
            console.log(`Progress: ${message} (${percent}%)`);
        }

        function displayResults(elementId, data) {
            const element = document.getElementById(elementId);
            let output = '';

            if (data.error) {
                output = `âŒ ã‚¨ãƒ©ãƒ¼: ${data.error}`;
            } else {
                if (data.title) {
                    output += `ğŸ“‹ ${data.title}\n${'='.repeat(50)}\n\n`;
                }
                
                if (data.data) {
                    output += 'ğŸ“Š åŸºæœ¬æƒ…å ±:\n';
                    for (const [key, value] of Object.entries(data.data)) {
                        output += `  ${key}: ${value}\n`;
                    }
                    output += '\n';
                }
                
                if (data.languages) {
                    output += 'ğŸŒ ã‚µãƒãƒ¼ãƒˆè¨€èª:\n';
                    data.languages.forEach(lang => {
                        output += `  ${lang.code}: ${lang.name} (${lang.direction})\n`;
                    });
                }
                
                if (data.formats) {
                    output += 'ğŸ“„ ã‚µãƒãƒ¼ãƒˆå½¢å¼:\n';
                    data.formats.forEach(format => {
                        output += `  ${format.code}: ${format.name}\n`;
                        output += `    æ‹¡å¼µå­: ${format.extensions.join(', ')}\n`;
                        output += `    ãƒã‚¹ãƒˆ: ${format.supportsNesting ? 'ã‚ã‚Š' : 'ãªã—'}\n\n`;
                    });
                }
                
                if (data.template) {
                    output += 'ğŸ“‹ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…å®¹:\n';
                    output += JSON.stringify(JSON.parse(data.template), null, 2);
                }
                
                if (data.content) {
                    output += 'ğŸ“„ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå†…å®¹ (å…ˆé ­500æ–‡å­—):\n';
                    output += data.content.substring(0, 500);
                    if (data.content.length > 500) {
                        output += '\n... (çœç•¥)';
                    }
                }
                
                if (data.sourceCode) {
                    output += 'ğŸ’» ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰:\n';
                    output += data.sourceCode;
                }
            }
            
            element.textContent = output;
        }

        function updateStatistics() {
            Object.entries(statistics).forEach(([key, value]) => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = value;
                }
            });
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†é–¢æ•°
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('dragover');
        }

        function handleFileDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        function handleFileSelect(e) {
            if (e.target.files.length > 0) {
                processFile(e.target.files[0]);
            }
        }

        function processFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                currentFile = {
                    name: file.name,
                    content: e.target.result,
                    size: file.size,
                    type: file.type
                };
                
                document.getElementById('importBtn').disabled = false;
                showStatus(`ãƒ•ã‚¡ã‚¤ãƒ« "${file.name}" ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`, 'success');
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>