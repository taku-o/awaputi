<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation Management Tools Test - BubblePop</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .tool-section {
            margin: 40px 0;
            padding: 25px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }

        .tool-section h2 {
            color: #2c3e50;
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
            align-items: center;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 500;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        button {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        button:hover:not(:disabled) {
            background: #2980b9;
        }

        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        button.secondary {
            background: #95a5a6;
        }

        button.secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        button.success {
            background: #27ae60;
        }

        button.success:hover:not(:disabled) {
            background: #229954;
        }

        button.warning {
            background: #f39c12;
        }

        button.warning:hover:not(:disabled) {
            background: #e67e22;
        }

        button.danger {
            background: #e74c3c;
        }

        button.danger:hover:not(:disabled) {
            background: #c0392b;
        }

        .results-area {
            margin: 25px 0;
            padding: 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            min-height: 200px;
            max-height: 500px;
            overflow-y: auto;
        }

        .key-item {
            margin: 10px 0;
            padding: 15px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
        }

        .key-item .key-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .key-item .key-details {
            font-size: 0.9em;
            color: #666;
            margin: 5px 0;
        }

        .key-item .usage-info {
            display: flex;
            gap: 15px;
            margin-top: 8px;
            font-size: 0.85em;
        }

        .usage-badge {
            padding: 2px 8px;
            border-radius: 12px;
            color: white;
            font-size: 0.8em;
        }

        .usage-badge.used {
            background: #27ae60;
        }

        .usage-badge.unused {
            background: #e74c3c;
        }

        .usage-badge.recent {
            background: #3498db;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stats-card {
            padding: 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
        }

        .stats-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 5px;
        }

        .stats-card .label {
            color: #666;
            font-size: 0.9em;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: bold;
        }

        .progress-fill.high {
            background: #27ae60;
        }

        .progress-fill.medium {
            background: #f39c12;
        }

        .progress-fill.low {
            background: #e74c3c;
        }

        .command-result {
            margin: 15px 0;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }

        .command-result.success {
            background: #d4edda;
            border-left-color: #27ae60;
        }

        .command-result.error {
            background: #f8d7da;
            border-left-color: #e74c3c;
        }

        .command-result.warning {
            background: #fff3cd;
            border-left-color: #f39c12;
        }

        .command-result .result-header {
            font-weight: bold;
            margin-bottom: 8px;
        }

        .command-result .result-details {
            font-size: 0.9em;
            color: #555;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin: 20px 0 0 0;
        }

        .tab {
            padding: 12px 24px;
            background: #f8f9fa;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .tab.active {
            background: white;
            border-bottom-color: #3498db;
            color: #3498db;
        }

        .tab-content {
            display: none;
            padding: 20px 0;
        }

        .tab-content.active {
            display: block;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .milestone-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .milestone-item.achieved {
            background: #d4edda;
            border-left: 4px solid #27ae60;
        }

        .milestone-name {
            font-weight: 500;
        }

        .milestone-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .validation-command {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .validation-command h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }

        .validation-command .command-description {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .validation-command .command-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .option-group label {
            font-size: 0.85em;
            color: #555;
        }

        .option-group input,
        .option-group select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .csv-download {
            display: inline-block;
            margin: 10px 0;
            padding: 8px 16px;
            background: #27ae60;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .csv-download:hover {
            background: #219a52;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ†Ô∏è ÁøªË®≥ÁÆ°ÁêÜ„ÉÑ„Éº„É´ „ÉÜ„Çπ„Éà„Çπ„Ç§„Éº„Éà</h1>
        <p>BubblePop „ÅÆÁøªË®≥ÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†„ÅÆÂåÖÊã¨ÁöÑ„Å™„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„Åß„Åô„ÄÇÁøªË®≥„Ç≠„ÉºÁÆ°ÁêÜ„ÄÅÈÄ≤ÊçóËøΩË∑°„ÄÅÊ§úË®º„Ç≥„Éû„É≥„Éâ„Çí„ÉÜ„Çπ„Éà„Åß„Åç„Åæ„Åô„ÄÇ</p>

        <!-- ÁøªË®≥„Ç≠„ÉºÁÆ°ÁêÜ -->
        <div class="tool-section">
            <h2>üîë ÁøªË®≥„Ç≠„ÉºÁÆ°ÁêÜ (TranslationKeyManager)</h2>
            
            <div class="tabs">
                <button class="tab active" data-tab="key-registration">„Ç≠„ÉºÁôªÈå≤</button>
                <button class="tab" data-tab="key-search">„Ç≠„ÉºÊ§úÁ¥¢</button>
                <button class="tab" data-tab="key-usage">‰ΩøÁî®Áä∂Ê≥Å</button>
                <button class="tab" data-tab="key-reports">„É¨„Éù„Éº„Éà</button>
            </div>

            <div class="tab-content active" id="key-registration">
                <div class="controls">
                    <div class="form-group">
                        <label>ÁøªË®≥„Ç≠„Éº</label>
                        <input type="text" id="newKeyName" placeholder="‰æã: menu.play, game.score">
                    </div>
                    <div class="form-group">
                        <label>Ë™¨Êòé</label>
                        <input type="text" id="newKeyDescription" placeholder="„Ç≠„Éº„ÅÆË™¨Êòé">
                    </div>
                    <div class="form-group">
                        <label>„Ç´„ÉÜ„Ç¥„É™</label>
                        <select id="newKeyCategory">
                            <option value="common">Common</option>
                            <option value="menu">Menu</option>
                            <option value="game">Game</option>
                            <option value="settings">Settings</option>
                            <option value="errors">Errors</option>
                            <option value="achievements">Achievements</option>
                            <option value="help">Help</option>
                        </select>
                    </div>
                    <button id="registerKeyBtn">„Ç≠„ÉºÁôªÈå≤</button>
                    <button id="loadSampleKeysBtn" class="secondary">„Çµ„É≥„Éó„É´„Ç≠„ÉºË™≠„ÅøËæº„Åø</button>
                </div>
                <div class="results-area" id="keyRegistrationResults">
                    <p>„Ç≠„Éº„ÇíÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>

            <div class="tab-content" id="key-search">
                <div class="controls">
                    <div class="form-group">
                        <label>Ê§úÁ¥¢„ÇØ„Ç®„É™</label>
                        <input type="text" id="searchQuery" placeholder="„Ç≠„ÉºÂêç„ÄÅË™¨Êòé„ÄÅ„Ç´„ÉÜ„Ç¥„É™„ÅßÊ§úÁ¥¢">
                    </div>
                    <div class="form-group">
                        <label>„Ç´„ÉÜ„Ç¥„É™„Éï„Ç£„É´„Çø„Éº</label>
                        <select id="searchCategory">
                            <option value="">„Åô„Åπ„Å¶</option>
                            <option value="common">Common</option>
                            <option value="menu">Menu</option>
                            <option value="game">Game</option>
                            <option value="settings">Settings</option>
                            <option value="errors">Errors</option>
                            <option value="achievements">Achievements</option>
                            <option value="help">Help</option>
                        </select>
                    </div>
                    <button id="searchKeysBtn">Ê§úÁ¥¢ÂÆüË°å</button>
                    <button id="showAllKeysBtn" class="secondary">ÂÖ®„Ç≠„ÉºË°®Á§∫</button>
                </div>
                <div class="results-area" id="keySearchResults">
                    <p>Ê§úÁ¥¢„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>

            <div class="tab-content" id="key-usage">
                <div class="controls">
                    <button id="recordSampleUsageBtn">„Çµ„É≥„Éó„É´‰ΩøÁî®Ë®òÈå≤</button>
                    <button id="showUnusedKeysBtn" class="warning">Êú™‰ΩøÁî®„Ç≠„ÉºË°®Á§∫</button>
                    <button id="showFrequentKeysBtn" class="success">È†ªÁπÅ‰ΩøÁî®„Ç≠„ÉºË°®Á§∫</button>
                    <button id="showRecentKeysBtn" class="secondary">ÊúÄËøë‰ΩøÁî®„Ç≠„ÉºË°®Á§∫</button>
                </div>
                <div class="results-area" id="keyUsageResults">
                    <p>‰ΩøÁî®Áä∂Ê≥Å„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>

            <div class="tab-content" id="key-reports">
                <div class="controls">
                    <div class="form-group">
                        <label>„É¨„Éù„Éº„ÉàÂΩ¢Âºè</label>
                        <select id="reportFormat">
                            <option value="detailed">Ë©≥Á¥∞</option>
                            <option value="summary">„Çµ„Éû„É™„Éº</option>
                            <option value="csv">CSV</option>
                        </select>
                    </div>
                    <button id="generateUsageReportBtn">‰ΩøÁî®„É¨„Éù„Éº„ÉàÁîüÊàê</button>
                    <button id="getCategoryStatsBtn" class="secondary">„Ç´„ÉÜ„Ç¥„É™Áµ±Ë®à</button>
                </div>
                <div class="results-area" id="keyReportsResults">
                    <p>„É¨„Éù„Éº„Éà„ÇíÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>
        </div>

        <!-- ÈÄ≤ÊçóËøΩË∑° -->
        <div class="tool-section">
            <h2>üìä ÈÄ≤ÊçóËøΩË∑° (ProgressTracker)</h2>
            
            <div class="tabs">
                <button class="tab active" data-tab="progress-setup">„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó</button>
                <button class="tab" data-tab="progress-tracking">ÈÄ≤ÊçóËøΩË∑°</button>
                <button class="tab" data-tab="progress-reports">ÈÄ≤Êçó„É¨„Éù„Éº„Éà</button>
                <button class="tab" data-tab="progress-milestones">„Éû„Ç§„É´„Çπ„Éà„Éº„É≥</button>
            </div>

            <div class="tab-content active" id="progress-setup">
                <div class="controls">
                    <div class="form-group">
                        <label>Ë®ÄË™û</label>
                        <select id="progressLanguage">
                            <option value="en">English</option>
                            <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
                            <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ÁøªË®≥„Çª„ÉÉ„ÉàÂêç</label>
                        <input type="text" id="translationSetName" placeholder="‰æã: main-ui, game-content">
                    </div>
                    <div class="form-group">
                        <label>„Ç´„ÉÜ„Ç¥„É™</label>
                        <select id="progressCategory">
                            <option value="common">Common</option>
                            <option value="menu">Menu</option>
                            <option value="game">Game</option>
                            <option value="settings">Settings</option>
                        </select>
                    </div>
                    <button id="registerTranslationSetBtn">ÁøªË®≥„Çª„ÉÉ„ÉàÁôªÈå≤</button>
                    <button id="loadSampleProgressBtn" class="secondary">„Çµ„É≥„Éó„É´ÈÄ≤ÊçóË™≠„ÅøËæº„Åø</button>
                </div>
                <div class="results-area" id="progressSetupResults">
                    <p>ÁøªË®≥„Çª„ÉÉ„Éà„ÇíÁôªÈå≤„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>

            <div class="tab-content" id="progress-tracking">
                <div class="controls">
                    <div class="form-group">
                        <label>ÂØæË±°Ë®ÄË™û</label>
                        <select id="trackingLanguage">
                            <option value="en">English</option>
                            <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
                            <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                        </select>
                    </div>
                    <button id="showLanguageProgressBtn">Ë®ÄË™ûÈÄ≤ÊçóË°®Á§∫</button>
                    <button id="showIncompleteItemsBtn" class="warning">Êú™ÂÆåÊàêÈ†ÖÁõÆË°®Á§∫</button>
                    <button id="updateSampleProgressBtn" class="success">„Çµ„É≥„Éó„É´ÈÄ≤ÊçóÊõ¥Êñ∞</button>
                </div>
                <div class="results-area" id="progressTrackingResults">
                    <div class="stats-grid" id="progressStatsGrid">
                        <!-- ÂãïÁöÑ„Å´ÁîüÊàê -->
                    </div>
                </div>
            </div>

            <div class="tab-content" id="progress-reports">
                <div class="controls">
                    <div class="form-group">
                        <label>ÂØæË±°Ë®ÄË™û</label>
                        <select id="reportLanguage">
                            <option value="en">English</option>
                            <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
                            <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>„É¨„Éù„Éº„ÉàÂΩ¢Âºè</label>
                        <select id="progressReportFormat">
                            <option value="detailed">Ë©≥Á¥∞</option>
                            <option value="summary">„Çµ„Éû„É™„Éº</option>
                            <option value="csv">CSV</option>
                        </select>
                    </div>
                    <button id="generateProgressReportBtn">ÈÄ≤Êçó„É¨„Éù„Éº„ÉàÁîüÊàê</button>
                    <button id="showAllLanguagesProgressBtn" class="secondary">ÂÖ®Ë®ÄË™ûÈÄ≤ÊçóË°®Á§∫</button>
                </div>
                <div class="results-area" id="progressReportsResults">
                    <p>ÈÄ≤Êçó„É¨„Éù„Éº„Éà„ÇíÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>

            <div class="tab-content" id="progress-milestones">
                <div class="controls">
                    <div class="form-group">
                        <label>ÂØæË±°Ë®ÄË™û</label>
                        <select id="milestoneLanguage">
                            <option value="en">English</option>
                            <option value="zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
                            <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>„Éû„Ç§„É´„Çπ„Éà„Éº„É≥Âêç</label>
                        <input type="text" id="milestoneName" placeholder="‰æã: Alpha Release, Beta Complete">
                    </div>
                    <div class="form-group">
                        <label>ÁõÆÊ®ôÂÆåÊàêÁéá (%)</label>
                        <input type="number" id="milestoneTarget" min="0" max="100" value="80">
                    </div>
                    <button id="setMilestoneBtn">„Éû„Ç§„É´„Çπ„Éà„Éº„É≥Ë®≠ÂÆö</button>
                    <button id="showMilestonesBtn" class="secondary">„Éû„Ç§„É´„Çπ„Éà„Éº„É≥Ë°®Á§∫</button>
                    <button id="predictGoalBtn" class="success">ÁõÆÊ®ôÈÅîÊàê‰∫àÊ∏¨</button>
                </div>
                <div class="results-area" id="progressMilestonesResults">
                    <p>„Éû„Ç§„É´„Çπ„Éà„Éº„É≥„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                </div>
            </div>
        </div>

        <!-- Ê§úË®º„Ç≥„Éû„É≥„Éâ -->
        <div class="tool-section">
            <h2>‚úÖ Ê§úË®º„Ç≥„Éû„É≥„Éâ (ValidationCommands)</h2>
            
            <div class="validation-commands" id="validationCommands">
                <!-- ÂãïÁöÑ„Å´ÁîüÊàê -->
            </div>

            <div class="controls">
                <button id="runAllValidationsBtn" class="danger">„Åô„Åπ„Å¶„ÅÆÊ§úË®ºÂÆüË°å</button>
                <button id="generateValidationReportBtn" class="success">Ê§úË®º„É¨„Éù„Éº„ÉàÁîüÊàê</button>
                <button id="clearValidationResultsBtn" class="secondary">ÁµêÊûú„ÇØ„É™„Ç¢</button>
            </div>

            <div class="results-area" id="validationResults">
                <p>Ê§úË®º„Ç≥„Éû„É≥„Éâ„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
            </div>
        </div>

        <!-- „É≠„Éº„Éá„Ç£„É≥„Ç∞Ë°®Á§∫ -->
        <div class="loading" id="loadingIndicator">
            <div class="spinner"></div>
            Âá¶ÁêÜ‰∏≠...
        </div>
    </div>

    <script type="module">
        import { getTranslationKeyManager } from './src/core/i18n/management/TranslationKeyManager.js';
        import { getProgressTracker } from './src/core/i18n/management/ProgressTracker.js';
        import { getValidationCommands } from './src/core/i18n/management/ValidationCommands.js';

        class TranslationManagementTestUI {
            constructor() {
                this.keyManager = getTranslationKeyManager();
                this.progressTracker = getProgressTracker();
                this.validationCommands = getValidationCommands();
                
                this.initializeElements();
                this.setupEventListeners();
                this.setupTabs();
                this.initializeValidationCommands();
                this.loadSampleData();
            }

            initializeElements() {
                this.elements = {
                    // „Ç≠„ÉºÁÆ°ÁêÜ
                    newKeyName: document.getElementById('newKeyName'),
                    newKeyDescription: document.getElementById('newKeyDescription'),
                    newKeyCategory: document.getElementById('newKeyCategory'),
                    registerKeyBtn: document.getElementById('registerKeyBtn'),
                    loadSampleKeysBtn: document.getElementById('loadSampleKeysBtn'),
                    keyRegistrationResults: document.getElementById('keyRegistrationResults'),
                    
                    // „Ç≠„ÉºÊ§úÁ¥¢
                    searchQuery: document.getElementById('searchQuery'),
                    searchCategory: document.getElementById('searchCategory'),
                    searchKeysBtn: document.getElementById('searchKeysBtn'),
                    showAllKeysBtn: document.getElementById('showAllKeysBtn'),
                    keySearchResults: document.getElementById('keySearchResults'),
                    
                    // „Ç≠„Éº‰ΩøÁî®Áä∂Ê≥Å
                    recordSampleUsageBtn: document.getElementById('recordSampleUsageBtn'),
                    showUnusedKeysBtn: document.getElementById('showUnusedKeysBtn'),
                    showFrequentKeysBtn: document.getElementById('showFrequentKeysBtn'),
                    showRecentKeysBtn: document.getElementById('showRecentKeysBtn'),
                    keyUsageResults: document.getElementById('keyUsageResults'),
                    
                    // „Ç≠„Éº„É¨„Éù„Éº„Éà
                    reportFormat: document.getElementById('reportFormat'),
                    generateUsageReportBtn: document.getElementById('generateUsageReportBtn'),
                    getCategoryStatsBtn: document.getElementById('getCategoryStatsBtn'),
                    keyReportsResults: document.getElementById('keyReportsResults'),
                    
                    // ÈÄ≤Êçó„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
                    progressLanguage: document.getElementById('progressLanguage'),
                    translationSetName: document.getElementById('translationSetName'),
                    progressCategory: document.getElementById('progressCategory'),
                    registerTranslationSetBtn: document.getElementById('registerTranslationSetBtn'),
                    loadSampleProgressBtn: document.getElementById('loadSampleProgressBtn'),
                    progressSetupResults: document.getElementById('progressSetupResults'),
                    
                    // ÈÄ≤ÊçóËøΩË∑°
                    trackingLanguage: document.getElementById('trackingLanguage'),
                    showLanguageProgressBtn: document.getElementById('showLanguageProgressBtn'),
                    showIncompleteItemsBtn: document.getElementById('showIncompleteItemsBtn'),
                    updateSampleProgressBtn: document.getElementById('updateSampleProgressBtn'),
                    progressTrackingResults: document.getElementById('progressTrackingResults'),
                    progressStatsGrid: document.getElementById('progressStatsGrid'),
                    
                    // ÈÄ≤Êçó„É¨„Éù„Éº„Éà
                    reportLanguage: document.getElementById('reportLanguage'),
                    progressReportFormat: document.getElementById('progressReportFormat'),
                    generateProgressReportBtn: document.getElementById('generateProgressReportBtn'),
                    showAllLanguagesProgressBtn: document.getElementById('showAllLanguagesProgressBtn'),
                    progressReportsResults: document.getElementById('progressReportsResults'),
                    
                    // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥
                    milestoneLanguage: document.getElementById('milestoneLanguage'),
                    milestoneName: document.getElementById('milestoneName'),
                    milestoneTarget: document.getElementById('milestoneTarget'),
                    setMilestoneBtn: document.getElementById('setMilestoneBtn'),
                    showMilestonesBtn: document.getElementById('showMilestonesBtn'),
                    predictGoalBtn: document.getElementById('predictGoalBtn'),
                    progressMilestonesResults: document.getElementById('progressMilestonesResults'),
                    
                    // Ê§úË®º„Ç≥„Éû„É≥„Éâ
                    validationCommands: document.getElementById('validationCommands'),
                    runAllValidationsBtn: document.getElementById('runAllValidationsBtn'),
                    generateValidationReportBtn: document.getElementById('generateValidationReportBtn'),
                    clearValidationResultsBtn: document.getElementById('clearValidationResultsBtn'),
                    validationResults: document.getElementById('validationResults'),
                    
                    // ÂÖ±ÈÄö
                    loadingIndicator: document.getElementById('loadingIndicator')
                };
            }

            setupEventListeners() {
                // „Ç≠„ÉºÁÆ°ÁêÜ
                this.elements.registerKeyBtn.addEventListener('click', () => this.registerKey());
                this.elements.loadSampleKeysBtn.addEventListener('click', () => this.loadSampleKeys());
                
                // „Ç≠„ÉºÊ§úÁ¥¢
                this.elements.searchKeysBtn.addEventListener('click', () => this.searchKeys());
                this.elements.showAllKeysBtn.addEventListener('click', () => this.showAllKeys());
                
                // „Ç≠„Éº‰ΩøÁî®Áä∂Ê≥Å
                this.elements.recordSampleUsageBtn.addEventListener('click', () => this.recordSampleUsage());
                this.elements.showUnusedKeysBtn.addEventListener('click', () => this.showUnusedKeys());
                this.elements.showFrequentKeysBtn.addEventListener('click', () => this.showFrequentKeys());
                this.elements.showRecentKeysBtn.addEventListener('click', () => this.showRecentKeys());
                
                // „Ç≠„Éº„É¨„Éù„Éº„Éà
                this.elements.generateUsageReportBtn.addEventListener('click', () => this.generateUsageReport());
                this.elements.getCategoryStatsBtn.addEventListener('click', () => this.getCategoryStats());
                
                // ÈÄ≤Êçó„Çª„ÉÉ„Éà„Ç¢„ÉÉ„Éó
                this.elements.registerTranslationSetBtn.addEventListener('click', () => this.registerTranslationSet());
                this.elements.loadSampleProgressBtn.addEventListener('click', () => this.loadSampleProgress());
                
                // ÈÄ≤ÊçóËøΩË∑°
                this.elements.showLanguageProgressBtn.addEventListener('click', () => this.showLanguageProgress());
                this.elements.showIncompleteItemsBtn.addEventListener('click', () => this.showIncompleteItems());
                this.elements.updateSampleProgressBtn.addEventListener('click', () => this.updateSampleProgress());
                
                // ÈÄ≤Êçó„É¨„Éù„Éº„Éà
                this.elements.generateProgressReportBtn.addEventListener('click', () => this.generateProgressReport());
                this.elements.showAllLanguagesProgressBtn.addEventListener('click', () => this.showAllLanguagesProgress());
                
                // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥
                this.elements.setMilestoneBtn.addEventListener('click', () => this.setMilestone());
                this.elements.showMilestonesBtn.addEventListener('click', () => this.showMilestones());
                this.elements.predictGoalBtn.addEventListener('click', () => this.predictGoal());
                
                // Ê§úË®º„Ç≥„Éû„É≥„Éâ
                this.elements.runAllValidationsBtn.addEventListener('click', () => this.runAllValidations());
                this.elements.generateValidationReportBtn.addEventListener('click', () => this.generateValidationReport());
                this.elements.clearValidationResultsBtn.addEventListener('click', () => this.clearValidationResults());
            }

            setupTabs() {
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const tabName = e.target.dataset.tab;
                        if (tabName) {
                            this.switchTab(e.target.closest('.tool-section'), tabName);
                        }
                    });
                });
            }

            switchTab(section, tabName) {
                // „Çø„Éñ„ÅÆÂàá„ÇäÊõø„Åà
                section.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                section.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

                section.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                section.querySelector(`#${tabName}`).classList.add('active');
            }

            showLoading(show) {
                this.elements.loadingIndicator.classList.toggle('show', show);
            }

            // „Ç≠„ÉºÁÆ°ÁêÜ„É°„ÇΩ„ÉÉ„Éâ
            registerKey() {
                const key = this.elements.newKeyName.value.trim();
                const description = this.elements.newKeyDescription.value.trim();
                const category = this.elements.newKeyCategory.value;

                if (!key) {
                    alert('ÁøªË®≥„Ç≠„Éº„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    return;
                }

                const result = this.keyManager.registerKey(key, {
                    description: description,
                    category: category,
                    tags: [category]
                });

                if (result) {
                    this.elements.keyRegistrationResults.innerHTML = `
                        <div class="command-result success">
                            <div class="result-header">‚úÖ „Ç≠„ÉºÁôªÈå≤ÊàêÂäü</div>
                            <div class="result-details">
                                „Ç≠„Éº: ${key}<br>
                                „Ç´„ÉÜ„Ç¥„É™: ${category}<br>
                                Ë™¨Êòé: ${description || 'Ôºà„Å™„ÅóÔºâ'}
                            </div>
                        </div>
                    `;
                    
                    // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢
                    this.elements.newKeyName.value = '';
                    this.elements.newKeyDescription.value = '';
                } else {
                    this.elements.keyRegistrationResults.innerHTML = `
                        <div class="command-result error">
                            <div class="result-header">‚ùå „Ç≠„ÉºÁôªÈå≤Â§±Êïó</div>
                            <div class="result-details">„Ç≠„Éº„ÅÆÂΩ¢Âºè„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</div>
                        </div>
                    `;
                }
            }

            loadSampleKeys() {
                const sampleKeys = {
                    'common.ok': { description: 'OK „Éú„Çø„É≥', category: 'common' },
                    'common.cancel': { description: '„Ç≠„É£„É≥„Çª„É´ „Éú„Çø„É≥', category: 'common' },
                    'common.save': { description: '‰øùÂ≠ò „Éú„Çø„É≥', category: 'common' },
                    'menu.play': { description: '„Éó„É¨„Ç§ „É°„Éã„É•„Éº', category: 'menu' },
                    'menu.settings': { description: 'Ë®≠ÂÆö „É°„Éã„É•„Éº', category: 'menu' },
                    'menu.exit': { description: 'ÁµÇ‰∫Ü „É°„Éã„É•„Éº', category: 'menu' },
                    'game.score': { description: '„Çπ„Ç≥„Ç¢Ë°®Á§∫', category: 'game', parameters: ['{score}'] },
                    'game.level': { description: '„É¨„Éô„É´Ë°®Á§∫', category: 'game', parameters: ['{level}'] },
                    'settings.volume': { description: 'Èü≥ÈáèË®≠ÂÆö', category: 'settings' },
                    'settings.difficulty': { description: 'Èõ£ÊòìÂ∫¶Ë®≠ÂÆö', category: 'settings' }
                };

                const results = this.keyManager.registerKeys(sampleKeys);
                
                this.elements.keyRegistrationResults.innerHTML = `
                    <div class="command-result success">
                        <div class="result-header">üì¶ „Çµ„É≥„Éó„É´„Ç≠„ÉºË™≠„ÅøËæº„ÅøÂÆå‰∫Ü</div>
                        <div class="result-details">
                            ÊàêÂäü: ${results.successful.length} ÂÄã<br>
                            Â§±Êïó: ${results.failed.length} ÂÄã<br>
                            ${results.successful.length > 0 ? `ÁôªÈå≤„Åï„Çå„Åü„Ç≠„Éº: ${results.successful.slice(0, 5).join(', ')}${results.successful.length > 5 ? '...' : ''}` : ''}
                        </div>
                    </div>
                `;
            }

            searchKeys() {
                const query = this.elements.searchQuery.value.trim();
                const category = this.elements.searchCategory.value;

                if (!query) {
                    alert('Ê§úÁ¥¢„ÇØ„Ç®„É™„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    return;
                }

                const results = this.keyManager.searchKeys(query, {
                    category: category || null,
                    searchIn: ['key', 'description', 'context']
                });

                this.displayKeyResults(results, this.elements.keySearchResults);
            }

            showAllKeys() {
                // ÂÖ®„Ç≠„Éº„ÇíÂèñÂæó„Åô„Çã„Åü„ÇÅ„Å´Á©∫ÊñáÂ≠ó„ÅßÊ§úÁ¥¢
                const results = this.keyManager.searchKeys('', {
                    searchIn: ['key']
                });

                this.displayKeyResults(results, this.elements.keySearchResults);
            }

            displayKeyResults(results, container) {
                if (results.length === 0) {
                    container.innerHTML = '<p>ÁµêÊûú„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ</p>';
                    return;
                }

                let html = `<h4>Ê§úÁ¥¢ÁµêÊûú: ${results.length} ‰ª∂</h4>`;
                
                results.forEach(result => {
                    const usage = result.usage;
                    const usageBadge = usage && usage.count > 0 ? 
                        `<span class="usage-badge used">‰ΩøÁî®Ê∏à„Åø (${usage.count}Âõû)</span>` :
                        `<span class="usage-badge unused">Êú™‰ΩøÁî®</span>`;

                    html += `
                        <div class="key-item">
                            <div class="key-name">${result.key}</div>
                            <div class="key-details">${result.metadata.description || 'ÔºàË™¨Êòé„Å™„ÅóÔºâ'}</div>
                            <div class="usage-info">
                                <span>„Ç´„ÉÜ„Ç¥„É™: ${result.metadata.category}</span>
                                ${usageBadge}
                                ${usage && usage.lastUsed ? `<span>ÊúÄÁµÇ‰ΩøÁî®: ${new Date(usage.lastUsed).toLocaleString('ja-JP')}</span>` : ''}
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }

            recordSampleUsage() {
                const sampleUsage = [
                    { key: 'common.ok', context: 'dialog', location: 'MainMenu' },
                    { key: 'common.cancel', context: 'dialog', location: 'Settings' },
                    { key: 'menu.play', context: 'menu', location: 'MainMenu' },
                    { key: 'game.score', context: 'hud', location: 'GameScene' },
                    { key: 'settings.volume', context: 'settings', location: 'SettingsScene' }
                ];

                this.keyManager.recordBatchUsage(sampleUsage);

                this.elements.keyUsageResults.innerHTML = `
                    <div class="command-result success">
                        <div class="result-header">üìä „Çµ„É≥„Éó„É´‰ΩøÁî®Ë®òÈå≤ÂÆå‰∫Ü</div>
                        <div class="result-details">
                            ${sampleUsage.length} ÂÄã„ÅÆ„Ç≠„Éº„ÅÆ‰ΩøÁî®„ÇíË®òÈå≤„Åó„Åæ„Åó„Åü„ÄÇ
                        </div>
                    </div>
                `;
            }

            showUnusedKeys() {
                const unusedKeys = this.keyManager.getUnusedKeys();
                
                if (unusedKeys.length === 0) {
                    this.elements.keyUsageResults.innerHTML = '<p>‚úÖ Êú™‰ΩøÁî®„ÅÆ„Ç≠„Éº„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                let html = `<h4>‚ö†Ô∏è Êú™‰ΩøÁî®„Ç≠„Éº: ${unusedKeys.length} ‰ª∂</h4>`;
                
                unusedKeys.forEach(keyInfo => {
                    html += `
                        <div class="key-item">
                            <div class="key-name">${keyInfo.key}</div>
                            <div class="key-details">${keyInfo.metadata.description}</div>
                            <div class="usage-info">
                                <span>„Ç´„ÉÜ„Ç¥„É™: ${keyInfo.metadata.category}</span>
                                <span class="usage-badge unused">Êú™‰ΩøÁî®</span>
                                <span>ÁôªÈå≤Êó•: ${new Date(keyInfo.registeredAt).toLocaleDateString('ja-JP')}</span>
                            </div>
                        </div>
                    `;
                });

                this.elements.keyUsageResults.innerHTML = html;
            }

            showFrequentKeys() {
                const frequentKeys = this.keyManager.getFrequentlyUsedKeys(10);
                
                if (frequentKeys.length === 0) {
                    this.elements.keyUsageResults.innerHTML = '<p>‰ΩøÁî®„Åï„Çå„Åü„Ç≠„Éº„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                let html = `<h4>üî• È†ªÁπÅ„Å´‰ΩøÁî®„Åï„Çå„Çã„Ç≠„Éº: ${frequentKeys.length} ‰ª∂</h4>`;
                
                frequentKeys.forEach(keyInfo => {
                    html += `
                        <div class="key-item">
                            <div class="key-name">${keyInfo.key}</div>
                            <div class="key-details">${keyInfo.metadata?.description || 'ÔºàË™¨Êòé„Å™„ÅóÔºâ'}</div>
                            <div class="usage-info">
                                <span class="usage-badge used">‰ΩøÁî®ÂõûÊï∞: ${keyInfo.count}</span>
                                ${keyInfo.lastUsed ? `<span>ÊúÄÁµÇ‰ΩøÁî®: ${new Date(keyInfo.lastUsed).toLocaleString('ja-JP')}</span>` : ''}
                                <span>„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà: ${keyInfo.contexts.join(', ')}</span>
                            </div>
                        </div>
                    `;
                });

                this.elements.keyUsageResults.innerHTML = html;
            }

            showRecentKeys() {
                const recentKeys = this.keyManager.getRecentlyUsedKeys(7, 20);
                
                if (recentKeys.length === 0) {
                    this.elements.keyUsageResults.innerHTML = '<p>ÊúÄËøë‰ΩøÁî®„Åï„Çå„Åü„Ç≠„Éº„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                let html = `<h4>üïí ÊúÄËøë‰ΩøÁî®„Åï„Çå„Åü„Ç≠„Éº (7Êó•‰ª•ÂÜÖ): ${recentKeys.length} ‰ª∂</h4>`;
                
                recentKeys.forEach(keyInfo => {
                    html += `
                        <div class="key-item">
                            <div class="key-name">${keyInfo.key}</div>
                            <div class="key-details">${keyInfo.metadata?.description || 'ÔºàË™¨Êòé„Å™„ÅóÔºâ'}</div>
                            <div class="usage-info">
                                <span class="usage-badge recent">ÊúÄËøë‰ΩøÁî®</span>
                                <span>‰ΩøÁî®ÂõûÊï∞: ${keyInfo.count}</span>
                                <span>ÊúÄÁµÇ‰ΩøÁî®: ${new Date(keyInfo.lastUsed).toLocaleString('ja-JP')}</span>
                            </div>
                        </div>
                    `;
                });

                this.elements.keyUsageResults.innerHTML = html;
            }

            generateUsageReport() {
                const format = this.elements.reportFormat.value;
                const report = this.keyManager.generateUsageReport({
                    format: format,
                    includeUnused: true,
                    includeDeprecated: false
                });

                if (format === 'csv') {
                    // CSV „Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                    const blob = new Blob([report], { type: 'text/csv' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `key-usage-report-${Date.now()}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);

                    this.elements.keyReportsResults.innerHTML = `
                        <div class="command-result success">
                            <div class="result-header">üìÑ CSV„É¨„Éù„Éº„ÉàÁîüÊàêÂÆå‰∫Ü</div>
                            <div class="result-details">„Éï„Ç°„Ç§„É´„Åå„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åï„Çå„Åæ„Åó„Åü„ÄÇ</div>
                        </div>
                    `;
                } else {
                    let html = '<h4>üìä ‰ΩøÁî®„É¨„Éù„Éº„Éà</h4>';
                    
                    if (format === 'summary') {
                        html += `
                            <div class="stats-grid">
                                <div class="stats-card">
                                    <div class="value">${report.summary.totalKeys}</div>
                                    <div class="label">Á∑è„Ç≠„ÉºÊï∞</div>
                                </div>
                                <div class="stats-card">
                                    <div class="value">${report.summary.usedKeys}</div>
                                    <div class="label">‰ΩøÁî®Ê∏à„Åø„Ç≠„Éº</div>
                                </div>
                                <div class="stats-card">
                                    <div class="value">${report.summary.unusedKeys}</div>
                                    <div class="label">Êú™‰ΩøÁî®„Ç≠„Éº</div>
                                </div>
                                <div class="stats-card">
                                    <div class="value">${report.summary.usageRate}%</div>
                                    <div class="label">‰ΩøÁî®Áéá</div>
                                </div>
                            </div>
                            <h5>„Çà„Åè‰ΩøÁî®„Åï„Çå„Çã„Ç≠„Éº:</h5>
                            <ul>
                                ${report.topUsedKeys.map(k => `<li>${k.key} (${k.count}Âõû)</li>`).join('')}
                            </ul>
                        `;
                    } else {
                        html += `<pre>${JSON.stringify(report, null, 2)}</pre>`;
                    }
                    
                    this.elements.keyReportsResults.innerHTML = html;
                }
            }

            getCategoryStats() {
                const stats = this.keyManager.getCategoryStatistics();
                
                let html = '<h4>üìà „Ç´„ÉÜ„Ç¥„É™Âà•Áµ±Ë®à</h4><div class="stats-grid">';
                
                for (const [category, categoryStats] of Object.entries(stats)) {
                    const usageRate = categoryStats.total > 0 ? 
                        Math.round((categoryStats.used / categoryStats.total) * 100) : 0;
                    
                    html += `
                        <div class="stats-card">
                            <div class="value">${categoryStats.total}</div>
                            <div class="label">${category}</div>
                            <div style="font-size: 0.8em; margin-top: 5px;">
                                ‰ΩøÁî®Áéá: ${usageRate}%<br>
                                ‰ΩøÁî®Ê∏à„Åø: ${categoryStats.used}<br>
                                Êú™‰ΩøÁî®: ${categoryStats.unused}
                            </div>
                        </div>
                    `;
                }
                
                html += '</div>';
                this.elements.keyReportsResults.innerHTML = html;
            }

            // ÈÄ≤ÊçóËøΩË∑°„É°„ÇΩ„ÉÉ„Éâ
            registerTranslationSet() {
                const language = this.elements.progressLanguage.value;
                const setName = this.elements.translationSetName.value.trim();
                const category = this.elements.progressCategory.value;

                if (!setName) {
                    alert('ÁøªË®≥„Çª„ÉÉ„ÉàÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    return;
                }

                // „Çµ„É≥„Éó„É´ÁøªË®≥„Éá„Éº„Çø
                const sampleTranslations = {
                    common: {
                        ok: 'OK',
                        cancel: 'Cancel',
                        save: 'Save'
                    },
                    menu: {
                        play: 'Play',
                        settings: 'Settings'
                    }
                };

                const result = this.progressTracker.registerTranslationSet(
                    language,
                    setName,
                    sampleTranslations,
                    { category: category, priority: 'normal' }
                );

                if (result) {
                    this.elements.progressSetupResults.innerHTML = `
                        <div class="command-result success">
                            <div class="result-header">‚úÖ ÁøªË®≥„Çª„ÉÉ„ÉàÁôªÈå≤ÊàêÂäü</div>
                            <div class="result-details">
                                Ë®ÄË™û: ${language}<br>
                                „Çª„ÉÉ„ÉàÂêç: ${setName}<br>
                                „Ç´„ÉÜ„Ç¥„É™: ${category}<br>
                                „Ç≠„ÉºÊï∞: ${Object.keys(this.progressTracker.flattenTranslations ? this.progressTracker.flattenTranslations(sampleTranslations) : sampleTranslations).length}
                            </div>
                        </div>
                    `;
                    
                    this.elements.translationSetName.value = '';
                } else {
                    this.elements.progressSetupResults.innerHTML = `
                        <div class="command-result error">
                            <div class="result-header">‚ùå ÁøªË®≥„Çª„ÉÉ„ÉàÁôªÈå≤Â§±Êïó</div>
                        </div>
                    `;
                }
            }

            loadSampleProgress() {
                const languages = ['en', 'zh-CN', 'zh-TW', 'ko'];
                const sets = ['main-ui', 'game-content', 'help-text'];
                let registered = 0;

                languages.forEach(language => {
                    sets.forEach(setName => {
                        const sampleTranslations = this.generateSampleTranslations(setName);
                        const result = this.progressTracker.registerTranslationSet(
                            language,
                            setName,
                            sampleTranslations,
                            { 
                                category: setName.includes('ui') ? 'common' : 
                                        setName.includes('game') ? 'game' : 'help',
                                priority: 'normal'
                            }
                        );
                        if (result) registered++;
                    });
                });

                this.elements.progressSetupResults.innerHTML = `
                    <div class="command-result success">
                        <div class="result-header">üìä „Çµ„É≥„Éó„É´ÈÄ≤Êçó„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂÆå‰∫Ü</div>
                        <div class="result-details">
                            ${registered} ÂÄã„ÅÆÁøªË®≥„Çª„ÉÉ„Éà„ÇíÁôªÈå≤„Åó„Åæ„Åó„Åü„ÄÇ<br>
                            Ë®ÄË™û: ${languages.join(', ')}<br>
                            „Çª„ÉÉ„Éà: ${sets.join(', ')}
                        </div>
                    </div>
                `;
            }

            generateSampleTranslations(setName) {
                const baseTranslations = {
                    'main-ui': {
                        common: { ok: 'OK', cancel: 'Cancel', save: 'Save', load: 'Load' },
                        menu: { play: 'Play', settings: 'Settings', exit: 'Exit' }
                    },
                    'game-content': {
                        game: { score: 'Score: {score}', level: 'Level {level}', time: 'Time: {time}' },
                        hud: { pause: 'Pause', resume: 'Resume' }
                    },
                    'help-text': {
                        help: { title: 'Help', controls: 'Controls', tips: 'Tips' },
                        tutorial: { welcome: 'Welcome', next: 'Next', prev: 'Previous' }
                    }
                };

                return baseTranslations[setName] || { test: { key: 'value' } };
            }

            showLanguageProgress() {
                const language = this.elements.trackingLanguage.value;
                const progress = this.progressTracker.getLanguageProgress(language);

                if (!progress) {
                    this.elements.progressStatsGrid.innerHTML = '<p>„Åì„ÅÆË®ÄË™û„ÅÆÈÄ≤Êçó„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                this.elements.progressStatsGrid.innerHTML = `
                    <div class="stats-card">
                        <div class="value">${progress.completionRate}%</div>
                        <div class="label">ÂÆåÊàêÁéá</div>
                    </div>
                    <div class="stats-card">
                        <div class="value">${progress.qualityScore}%</div>
                        <div class="label">ÂìÅË≥™„Çπ„Ç≥„Ç¢</div>
                    </div>
                    <div class="stats-card">
                        <div class="value">${progress.totalKeys}</div>
                        <div class="label">Á∑è„Ç≠„ÉºÊï∞</div>
                    </div>
                    <div class="stats-card">
                        <div class="value">${progress.totalSets}</div>
                        <div class="label">ÁøªË®≥„Çª„ÉÉ„ÉàÊï∞</div>
                    </div>
                `;

                // ÈÄ≤Êçó„Éê„Éº„ÇíË°®Á§∫
                const progressBar = `
                    <div style="grid-column: 1 / -1; margin-top: 20px;">
                        <h4>${language} ÁøªË®≥ÈÄ≤Êçó</h4>
                        <div class="progress-bar">
                            <div class="progress-fill ${this.getProgressClass(progress.completionRate)}" 
                                 style="width: ${progress.completionRate}%">
                                ${progress.completionRate}%
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.9em; margin-top: 5px;">
                            <span>ÁøªË®≥Ê∏à„Åø: ${progress.translated}</span>
                            <span>„É¨„Éì„É•„ÉºÊ∏à„Åø: ${progress.reviewed}</span>
                            <span>ÊâøË™çÊ∏à„Åø: ${progress.approved}</span>
                            <span>Êú™ÂÆåÊàê: ${progress.empty}</span>
                        </div>
                    </div>
                `;

                this.elements.progressStatsGrid.innerHTML += progressBar;
            }

            getProgressClass(percentage) {
                if (percentage >= 80) return 'high';
                if (percentage >= 50) return 'medium';
                return 'low';
            }

            showIncompleteItems() {
                const language = this.elements.trackingLanguage.value;
                const incompleteItems = this.progressTracker.getIncompleteItems(language, {
                    status: ['empty', 'translated'],
                    limit: 20
                });

                if (incompleteItems.length === 0) {
                    this.elements.progressTrackingResults.innerHTML = '<p>‚úÖ Êú™ÂÆåÊàêÈ†ÖÁõÆ„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                let html = `<h4>‚ö†Ô∏è Êú™ÂÆåÊàêÈ†ÖÁõÆ: ${incompleteItems.length} ‰ª∂</h4>`;
                
                incompleteItems.forEach(item => {
                    html += `
                        <div class="key-item">
                            <div class="key-name">${item.key}</div>
                            <div class="key-details">„Çª„ÉÉ„Éà: ${item.set} | „Ç´„ÉÜ„Ç¥„É™: ${item.category}</div>
                            <div class="usage-info">
                                <span class="usage-badge ${item.status === 'empty' ? 'unused' : 'used'}">${item.status}</span>
                                <span>ÂÑ™ÂÖàÂ∫¶: ${item.priority}</span>
                                ${item.lastUpdated ? `<span>Êõ¥Êñ∞: ${new Date(item.lastUpdated).toLocaleDateString('ja-JP')}</span>` : ''}
                            </div>
                        </div>
                    `;
                });

                this.elements.progressTrackingResults.innerHTML = html;
            }

            updateSampleProgress() {
                const language = this.elements.trackingLanguage.value;
                const sampleUpdates = [
                    { key: 'common.ok', status: 'reviewed', value: 'OK', metadata: { quality: 'review' } },
                    { key: 'common.cancel', status: 'approved', value: 'Cancel', metadata: { quality: 'approved' } },
                    { key: 'menu.play', status: 'translated', value: 'Play', metadata: { quality: 'draft' } }
                ];

                const results = this.progressTracker.batchUpdateTranslationStatus(
                    language,
                    'main-ui',
                    sampleUpdates
                );

                this.elements.progressTrackingResults.innerHTML = `
                    <div class="command-result success">
                        <div class="result-header">üìù „Çµ„É≥„Éó„É´ÈÄ≤ÊçóÊõ¥Êñ∞ÂÆå‰∫Ü</div>
                        <div class="result-details">
                            ÊàêÂäü: ${results.successful.length} ÂÄã<br>
                            Â§±Êïó: ${results.failed.length} ÂÄã<br>
                            Êõ¥Êñ∞„Åï„Çå„Åü„Ç≠„Éº: ${results.successful.join(', ')}
                        </div>
                    </div>
                `;

                // ÈÄ≤Êçó„ÇíÂÜçË°®Á§∫
                setTimeout(() => this.showLanguageProgress(), 500);
            }

            generateProgressReport() {
                const language = this.elements.reportLanguage.value;
                const format = this.elements.progressReportFormat.value;

                const report = this.progressTracker.generateProgressReport(language, {
                    format: format,
                    includeSets: true,
                    includeCategories: true,
                    includeDetails: format === 'detailed'
                });

                if (!report) {
                    this.elements.progressReportsResults.innerHTML = '<p>„Åì„ÅÆË®ÄË™û„ÅÆ„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                if (format === 'csv') {
                    // CSV „Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                    const blob = new Blob([report], { type: 'text/csv' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `progress-report-${language}-${Date.now()}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);

                    this.elements.progressReportsResults.innerHTML = `
                        <div class="command-result success">
                            <div class="result-header">üìÑ ÈÄ≤ÊçóCSV„É¨„Éù„Éº„ÉàÁîüÊàêÂÆå‰∫Ü</div>
                            <div class="result-details">„Éï„Ç°„Ç§„É´„Åå„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åï„Çå„Åæ„Åó„Åü„ÄÇ</div>
                        </div>
                    `;
                } else {
                    let html = `<h4>üìä ${language} ÈÄ≤Êçó„É¨„Éù„Éº„Éà</h4>`;
                    
                    if (format === 'summary') {
                        html += `
                            <div class="stats-grid">
                                <div class="stats-card">
                                    <div class="value">${report.completionRate}%</div>
                                    <div class="label">ÂÆåÊàêÁéá</div>
                                </div>
                                <div class="stats-card">
                                    <div class="value">${report.qualityScore}%</div>
                                    <div class="label">ÂìÅË≥™„Çπ„Ç≥„Ç¢</div>
                                </div>
                                <div class="stats-card">
                                    <div class="value">${report.totalKeys}</div>
                                    <div class="label">Á∑è„Ç≠„ÉºÊï∞</div>
                                </div>
                            </div>
                        `;
                    } else {
                        html += `<pre style="max-height: 400px; overflow-y: auto;">${JSON.stringify(report, null, 2)}</pre>`;
                    }
                    
                    this.elements.progressReportsResults.innerHTML = html;
                }
            }

            showAllLanguagesProgress() {
                const allProgress = this.progressTracker.getAllLanguageProgress();
                
                if (Object.keys(allProgress).length === 0) {
                    this.elements.progressReportsResults.innerHTML = '<p>ÈÄ≤Êçó„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                let html = '<h4>üåê ÂÖ®Ë®ÄË™ûÈÄ≤Êçó„Çµ„Éû„É™„Éº</h4><div class="stats-grid">';
                
                for (const [language, progress] of Object.entries(allProgress)) {
                    html += `
                        <div class="stats-card">
                            <div class="value">${progress.completionRate}%</div>
                            <div class="label">${language}</div>
                            <div style="font-size: 0.8em; margin-top: 5px;">
                                ÂìÅË≥™: ${progress.qualityScore}%<br>
                                „Ç≠„ÉºÊï∞: ${progress.totalKeys}<br>
                                „Çª„ÉÉ„ÉàÊï∞: ${progress.totalSets}
                            </div>
                        </div>
                    `;
                }
                
                html += '</div>';
                this.elements.progressReportsResults.innerHTML = html;
            }

            // „Éû„Ç§„É´„Çπ„Éà„Éº„É≥„É°„ÇΩ„ÉÉ„Éâ
            setMilestone() {
                const language = this.elements.milestoneLanguage.value;
                const name = this.elements.milestoneName.value.trim();
                const target = parseInt(this.elements.milestoneTarget.value);

                if (!name) {
                    alert('„Éû„Ç§„É´„Çπ„Éà„Éº„É≥Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    return;
                }

                this.progressTracker.setMilestone(language, name, target, `${name} - ${target}% ÂÆåÊàêÁõÆÊ®ô`);

                this.elements.progressMilestonesResults.innerHTML = `
                    <div class="command-result success">
                        <div class="result-header">üéØ „Éû„Ç§„É´„Çπ„Éà„Éº„É≥Ë®≠ÂÆöÂÆå‰∫Ü</div>
                        <div class="result-details">
                            Ë®ÄË™û: ${language}<br>
                            ÂêçÂâç: ${name}<br>
                            ÁõÆÊ®ô: ${target}%
                        </div>
                    </div>
                `;

                this.elements.milestoneName.value = '';
            }

            showMilestones() {
                const language = this.elements.milestoneLanguage.value;
                const milestones = this.progressTracker.getMilestones(language);

                if (milestones.length === 0) {
                    this.elements.progressMilestonesResults.innerHTML = '<p>Ë®≠ÂÆö„Åï„Çå„Åü„Éû„Ç§„É´„Çπ„Éà„Éº„É≥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>';
                    return;
                }

                let html = `<h4>üéØ ${language} „Éû„Ç§„É´„Çπ„Éà„Éº„É≥</h4>`;
                
                milestones.forEach(milestone => {
                    html += `
                        <div class="milestone-item ${milestone.achieved ? 'achieved' : ''}">
                            <div>
                                <div class="milestone-name">${milestone.name}</div>
                                <div style="font-size: 0.9em; color: #666;">
                                    ÁõÆÊ®ô: ${milestone.targetPercentage}%
                                    ${milestone.achieved ? `| ÈÅîÊàêÊó•: ${new Date(milestone.achievedAt).toLocaleDateString('ja-JP')}` : ''}
                                </div>
                            </div>
                            <div class="milestone-progress">
                                ${milestone.achieved ? '‚úÖ ÈÅîÊàê' : '‚è≥ Êú™ÈÅîÊàê'}
                            </div>
                        </div>
                    `;
                });

                this.elements.progressMilestonesResults.innerHTML = html;
            }

            predictGoal() {
                const language = this.elements.milestoneLanguage.value;
                
                // „Çµ„É≥„Éó„É´ÁõÆÊ®ô„ÇíË®≠ÂÆö„Åó„Å¶„Åã„Çâ‰∫àÊ∏¨
                const targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + 30); // 30Êó•Âæå
                
                this.progressTracker.setProgressGoal(language, targetDate, 90, '90% ÂÆåÊàêÁõÆÊ®ô');
                
                const prediction = this.progressTracker.predictGoalAchievement(language);

                if (!prediction) {
                    this.elements.progressMilestonesResults.innerHTML = '<p>‰∫àÊ∏¨„Å´ÂøÖË¶Å„Å™„Éá„Éº„Çø„Åå‰∏çË∂≥„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>';
                    return;
                }

                const statusClass = prediction.isOnTrack ? 'success' : 'warning';
                const statusText = prediction.isOnTrack ? '‚úÖ È†ÜË™ø' : '‚ö†Ô∏è ÈÅÖ„ÇåÊ∞óÂë≥';

                this.elements.progressMilestonesResults.innerHTML = `
                    <div class="command-result ${statusClass}">
                        <div class="result-header">üîÆ ÁõÆÊ®ôÈÅîÊàê‰∫àÊ∏¨</div>
                        <div class="result-details">
                            ÁèæÂú®„ÅÆÈÄ≤Êçó: ${prediction.currentProgress}%<br>
                            ÁõÆÊ®ôÈÄ≤Êçó: ${prediction.targetProgress}%<br>
                            ÁõÆÊ®ôÊó•: ${new Date(prediction.targetDate).toLocaleDateString('ja-JP')}<br>
                            ‰∫àÊ∏¨ÂÆå‰∫ÜÊó•: ${new Date(prediction.estimatedCompletionDate).toLocaleDateString('ja-JP')}<br>
                            Êó•Ê¨°ÈÄ≤ÊçóÁéá: ${prediction.dailyProgressRate}%<br>
                            ÊÆã„ÇäÊó•Êï∞: ${prediction.daysToGoal} Êó•<br>
                            Áä∂ÊÖã: ${statusText} (${prediction.daysAheadBehind > 0 ? `${prediction.daysAheadBehind}Êó•ÂâçÂÄí„Åó` : `${Math.abs(prediction.daysAheadBehind)}Êó•ÈÅÖ„Çå`})
                        </div>
                    </div>
                `;
            }

            // Ê§úË®º„Ç≥„Éû„É≥„Éâ„É°„ÇΩ„ÉÉ„Éâ
            initializeValidationCommands() {
                const commands = this.validationCommands.getAvailableCommands();
                
                let html = '';
                commands.forEach(command => {
                    html += `
                        <div class="validation-command">
                            <h4>${command.displayName}</h4>
                            <div class="command-description">${command.description}</div>
                            <div class="command-options" id="options-${command.name}">
                                <!-- „Ç™„Éó„Ç∑„Éß„É≥„ÅØÁ∞°Áï•Âåñ -->
                            </div>
                            <button onclick="window.testUI.runValidationCommand('${command.name}')" class="secondary">
                                ${command.name} ÂÆüË°å
                            </button>
                        </div>
                    `;
                });

                this.elements.validationCommands.innerHTML = html;
                
                // „Ç∞„É≠„Éº„Éê„É´„Ç¢„ÇØ„Çª„ÇπÁî®
                window.testUI = this;
            }

            async runValidationCommand(commandName) {
                this.showLoading(true);

                try {
                    const result = await this.validationCommands.executeCommand(commandName, {
                        languages: ['en', 'zh-CN']
                    });

                    const statusClass = result.success && result.result?.passed ? 'success' : 'error';
                    const statusText = result.success && result.result?.passed ? '‚úÖ ÂêàÊ†º' : '‚ùå ÂïèÈ°å„ÅÇ„Çä';

                    let details = '';
                    if (result.result?.summary) {
                        const summary = result.result.summary;
                        details = `
                            ÂÆüË°åÊôÇÈñì: ${result.executionTime}ms<br>
                            ${summary.totalIssues !== undefined ? `ÂïèÈ°åÊï∞: ${summary.totalIssues}` : ''}
                            ${summary.totalLanguages !== undefined ? `ÂØæË±°Ë®ÄË™û: ${summary.totalLanguages}` : ''}
                            ${summary.passedLanguages !== undefined ? `ÂêàÊ†ºË®ÄË™û: ${summary.passedLanguages}` : ''}
                            ${summary.failedLanguages !== undefined ? `‰∏çÂêàÊ†ºË®ÄË™û: ${summary.failedLanguages}` : ''}
                        `;
                    }

                    this.elements.validationResults.innerHTML += `
                        <div class="command-result ${statusClass}">
                            <div class="result-header">${commandName} - ${statusText}</div>
                            <div class="result-details">${details}</div>
                        </div>
                    `;

                } catch (error) {
                    this.elements.validationResults.innerHTML += `
                        <div class="command-result error">
                            <div class="result-header">${commandName} - ‚ùå „Ç®„É©„Éº</div>
                            <div class="result-details">„Ç®„É©„Éº: ${error.message}</div>
                        </div>
                    `;
                } finally {
                    this.showLoading(false);
                }
            }

            async runAllValidations() {
                this.showLoading(true);
                this.elements.validationResults.innerHTML = '<h4>üîç Áµ±ÂêàÊ§úË®ºÂÆüË°å‰∏≠...</h4>';

                try {
                    const result = await this.validationCommands.executeCommand('validate-all', {
                        languages: ['en', 'zh-CN'],
                        exitOnError: false,
                        generateReport: true
                    });

                    const statusClass = result.success && result.result?.summary?.overallPassed ? 'success' : 'error';
                    const statusText = result.success && result.result?.summary?.overallPassed ? '‚úÖ ÂÖ®Ê§úË®ºÂêàÊ†º' : '‚ùå ÂïèÈ°å„ÅÇ„Çä';

                    let details = '';
                    if (result.result?.summary) {
                        const summary = result.result.summary;
                        details = `
                            ÂÆüË°åÊôÇÈñì: ${result.executionTime}ms<br>
                            Á∑è„Ç≥„Éû„É≥„ÉâÊï∞: ${summary.totalCommands}<br>
                            ÂêàÊ†º„Ç≥„Éû„É≥„Éâ: ${summary.passedCommands}<br>
                            ‰∏çÂêàÊ†º„Ç≥„Éû„É≥„Éâ: ${summary.failedCommands}<br>
                            Á∑èÂïèÈ°åÊï∞: ${summary.totalIssues}<br>
                            „É¨„Éù„Éº„ÉàÁîüÊàê: ${result.result.reportGenerated ? '‚úÖ' : '‚ùå'}
                        `;
                    }

                    this.elements.validationResults.innerHTML = `
                        <div class="command-result ${statusClass}">
                            <div class="result-header">Áµ±ÂêàÊ§úË®ºÁµêÊûú - ${statusText}</div>
                            <div class="result-details">${details}</div>
                        </div>
                    `;

                } catch (error) {
                    this.elements.validationResults.innerHTML = `
                        <div class="command-result error">
                            <div class="result-header">Áµ±ÂêàÊ§úË®º - ‚ùå „Ç®„É©„Éº</div>
                            <div class="result-details">„Ç®„É©„Éº: ${error.message}</div>
                        </div>
                    `;
                } finally {
                    this.showLoading(false);
                }
            }

            async generateValidationReport() {
                this.showLoading(true);

                try {
                    const result = await this.validationCommands.executeCommand('generate-report', {
                        format: 'html',
                        includeDetails: true
                    });

                    if (result.success) {
                        // HTML„É¨„Éù„Éº„Éà„ÇíÊñ∞„Åó„ÅÑ„Ç¶„Ç£„É≥„Éâ„Ç¶„ÅßË°®Á§∫
                        const newWindow = window.open('', '_blank');
                        newWindow.document.write(result.result.content);
                        newWindow.document.close();

                        this.elements.validationResults.innerHTML += `
                            <div class="command-result success">
                                <div class="result-header">üìä Ê§úË®º„É¨„Éù„Éº„ÉàÁîüÊàêÂÆå‰∫Ü</div>
                                <div class="result-details">
                                    ÂΩ¢Âºè: ${result.result.format}<br>
                                    „Çµ„Ç§„Ç∫: ${Math.round(result.result.size / 1024)} KB<br>
                                    „É¨„Éù„Éº„Éà„ÅåÊñ∞„Åó„ÅÑ„Ç¶„Ç£„É≥„Éâ„Ç¶„ÅßÈñã„Åã„Çå„Åæ„Åó„Åü„ÄÇ
                                </div>
                            </div>
                        `;
                    }

                } catch (error) {
                    this.elements.validationResults.innerHTML += `
                        <div class="command-result error">
                            <div class="result-header">„É¨„Éù„Éº„ÉàÁîüÊàê - ‚ùå „Ç®„É©„Éº</div>
                            <div class="result-details">„Ç®„É©„Éº: ${error.message}</div>
                        </div>
                    `;
                } finally {
                    this.showLoading(false);
                }
            }

            clearValidationResults() {
                this.elements.validationResults.innerHTML = '<p>Ê§úË®º„Ç≥„Éû„É≥„Éâ„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>';
            }

            // ÂàùÊúüÂåñ„É°„ÇΩ„ÉÉ„Éâ
            loadSampleData() {
                // Âü∫Êú¨ÁöÑ„Å™„Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø
                setTimeout(() => {
                    this.loadSampleKeys();
                    this.loadSampleProgress();
                }, 1000);
            }
        }

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÂÆå‰∫ÜÂæå„Å´ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            new TranslationManagementTestUI();
        });
    </script>
</body>
</html>