<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Performance Optimizer Test - BubblePop</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .button:hover {
            background: #45a049;
        }
        .button.secondary {
            background: #2196F3;
        }
        .button.secondary:hover {
            background: #1976D2;
        }
        .button.warning {
            background: #FF9800;
        }
        .button.warning:hover {
            background: #F57C00;
        }
        .output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .metric-card {
            background: #e8f5e8;
            border: 1px solid #c8e6c9;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #2e7d32;
            margin: 10px 0;
        }
        .metric-label {
            font-size: 14px;
            color: #666;
        }
        .performance-chart {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            min-height: 300px;
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #f5f5f5;
            border: none;
            font-size: 16px;
            transition: all 0.3s;
        }
        .tab:hover,
        .tab.active {
            background: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .info-box {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .info-box h4 {
            color: #1565c0;
            margin-top: 0;
        }
        .progress {
            width: 100%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-bar {
            height: 100%;
            background-color: #4CAF50;
            transition: width 0.3s ease;
        }
        .image-preview {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .image-comparison {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            min-width: 200px;
        }
        .image-comparison img {
            max-width: 150px;
            max-height: 150px;
            border: 1px solid #ccc;
            margin: 10px 0;
        }
        .compression-info {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš¡ SEOãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«</h1>
        <p>SEOé–¢é€£ã‚¢ã‚»ãƒƒãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã€ç›£è¦–ã—ã¾ã™ã€‚</p>
        
        <div class="info-box">
            <h4>ğŸ”§ ãƒ†ã‚¹ãƒˆå¯¾è±¡æ©Ÿèƒ½</h4>
            <ul>
                <li><strong>ç”»åƒæœ€é©åŒ–:</strong> WebPå¯¾å¿œã€åœ§ç¸®ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½</li>
                <li><strong>æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æœ€é©åŒ–:</strong> JSON-LDæœ€å°åŒ–ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½</li>
                <li><strong>ãƒ¡ã‚¿ã‚¿ã‚°æœ€é©åŒ–:</strong> ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæœ€é©åŒ–ã€é‡è¤‡é™¤å»</li>
                <li><strong>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–:</strong> ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§èƒ½ãƒ¡ãƒˆãƒªã‚¯ã‚¹</li>
                <li><strong>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†:</strong> åŠ¹ç‡çš„ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥</li>
            </ul>
        </div>
    </div>
    
    <div class="container">
        <div class="tabs">
            <button class="tab active" data-tab="optimization">æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</button>
            <button class="tab" data-tab="performance">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–</button>
            <button class="tab" data-tab="cache">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†</button>
            <button class="tab" data-tab="comparison">æ¯”è¼ƒãƒ†ã‚¹ãƒˆ</button>
        </div>
        
        <!-- æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¿ãƒ– -->
        <div class="tab-content active" id="optimization">
            <h3>ğŸš€ SEOæœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</h3>
            <div class="controls">
                <button class="button" onclick="testImageOptimization()">ğŸ–¼ï¸ ç”»åƒæœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</button>
                <button class="button" onclick="testStructuredDataOptimization()">ğŸ“Š æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æœ€é©åŒ–</button>
                <button class="button" onclick="testMetaTagOptimization()">ğŸ·ï¸ ãƒ¡ã‚¿ã‚¿ã‚°æœ€é©åŒ–</button>
                <button class="button secondary" onclick="runComprehensiveOptimization()">âš¡ åŒ…æ‹¬æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div class="output" id="optimizationOutput">æœ€é©åŒ–ãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
            <div class="image-preview" id="imagePreview"></div>
        </div>
        
        <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã‚¿ãƒ– -->
        <div class="tab-content" id="performance">
            <h3>ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–</h3>
            <div class="controls">
                <button class="button" onclick="startPerformanceMonitoring()">â–¶ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–é–‹å§‹</button>
                <button class="button warning" onclick="stopPerformanceMonitoring()">â¹ï¸ ç›£è¦–åœæ­¢</button>
                <button class="button secondary" onclick="generatePerformanceReport()">ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</button>
            </div>
            
            <div class="metrics-grid" id="metricsGrid">
                <div class="metric-card">
                    <div class="metric-value" id="cacheHitRate">-</div>
                    <div class="metric-label">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="avgProcessingTime">-</div>
                    <div class="metric-label">å¹³å‡å‡¦ç†æ™‚é–“ (ms)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="totalOptimizations">-</div>
                    <div class="metric-label">æœ€é©åŒ–å®Ÿè¡Œå›æ•°</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="compressionRatio">-</div>
                    <div class="metric-label">å¹³å‡åœ§ç¸®ç‡</div>
                </div>
            </div>
            
            <div class="performance-chart" id="performanceChart">
                <h4>â±ï¸ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h4>
                <canvas id="performanceCanvas" width="800" height="200"></canvas>
            </div>
            
            <div class="output" id="performanceOutput">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
        
        <!-- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†ã‚¿ãƒ– -->
        <div class="tab-content" id="cache">
            <h3>ğŸ’¾ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†</h3>
            <div class="controls">
                <button class="button" onclick="analyzeCacheEfficiency()">ğŸ“Š ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡åˆ†æ</button>
                <button class="button secondary" onclick="testCacheStrategies()">ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ãƒ†ã‚¹ãƒˆ</button>
                <button class="button warning" onclick="clearAllCaches()">ğŸ—‘ï¸ å…¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢</button>
            </div>
            <div class="output" id="cacheOutput">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
        
        <!-- æ¯”è¼ƒãƒ†ã‚¹ãƒˆã‚¿ãƒ– -->
        <div class="tab-content" id="comparison">
            <h3>âš–ï¸ æœ€é©åŒ–å‰å¾Œæ¯”è¼ƒ</h3>
            <div class="controls">
                <button class="button" onclick="runBeforeAfterComparison()">ğŸ“Š æœ€é©åŒ–å‰å¾Œæ¯”è¼ƒ</button>
                <button class="button secondary" onclick="benchmarkDifferentSizes()">ğŸ“ ã‚µã‚¤ã‚ºåˆ¥ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</button>
                <button class="button secondary" onclick="testBrowserCompatibility()">ğŸŒ ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§ãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div class="output" id="comparisonOutput">æ¯”è¼ƒãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
    </div>
    
    <div class="container">
        <h2>ğŸ® å®Ÿéš›ã®ã‚²ãƒ¼ãƒ çµ±åˆãƒ†ã‚¹ãƒˆ</h2>
        <div class="controls">
            <button class="button" onclick="simulateGameSEOOptimization()">ğŸ•¹ï¸ ã‚²ãƒ¼ãƒ SEOæœ€é©åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
            <button class="button secondary" onclick="testRealTimeOptimization()">âš¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æœ€é©åŒ–ãƒ†ã‚¹ãƒˆ</button>
        </div>
        <div class="output" id="integrationOutput">çµ±åˆãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
    </div>

    <script type="module">
        import { SEOPerformanceOptimizer } from './src/seo/SEOPerformanceOptimizer.js';
        
        let performanceOptimizer;
        let monitoringInterval;
        let performanceData = [];
        let isMonitoring = false;
        
        // åˆæœŸåŒ–
        async function initialize() {
            try {
                performanceOptimizer = new SEOPerformanceOptimizer();
                log('ğŸš€ SEOãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¾ã—ãŸ');
                log('ğŸ“Š å„ã‚¿ãƒ–ã§ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã‚’è©¦ã—ã¦ãã ã•ã„');
            } catch (error) {
                log(`âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã®å®šç¾©
        window.testImageOptimization = async function() {
            try {
                log('ğŸ–¼ï¸ ç”»åƒæœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                // ãƒ†ã‚¹ãƒˆç”¨ã®ç”»åƒãƒ‡ãƒ¼ã‚¿URLï¼ˆå°ã•ãªèµ¤ã„æ­£æ–¹å½¢ï¼‰
                const testImageDataUrl = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABUlEQVR42mNkYPhfDwABIgCBWW+6zAAAAABJRU5ErkJggg==';
                
                // è¤‡æ•°ã®æœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆ
                const optimizationTests = [
                    { width: 32, height: 32, quality: 85, format: 'auto' },
                    { width: 64, height: 64, quality: 75, format: 'webp' },
                    { width: 128, height: 128, quality: 90, format: 'png' },
                    { width: 256, height: 256, quality: 80, format: 'jpg' }
                ];
                
                const imagePreview = document.getElementById('imagePreview');
                imagePreview.innerHTML = '';
                
                for (const options of optimizationTests) {
                    const startTime = performance.now();
                    const optimizedUrl = await performanceOptimizer.optimizeImage(testImageDataUrl, options);
                    const endTime = performance.now();
                    
                    log(`âœ… æœ€é©åŒ–å®Œäº† (${options.width}x${options.height}, ${options.format}): ${(endTime - startTime).toFixed(2)}ms`);
                    
                    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
                    const comparison = document.createElement('div');
                    comparison.className = 'image-comparison';
                    comparison.innerHTML = `
                        <h4>${options.width}x${options.height} (${options.format})</h4>
                        <div>å…ƒç”»åƒ</div>
                        <img src="${testImageDataUrl}" alt="Original">
                        <div>æœ€é©åŒ–å¾Œ</div>
                        <img src="${optimizedUrl}" alt="Optimized">
                        <div class="compression-info">å‡¦ç†æ™‚é–“: ${(endTime - startTime).toFixed(2)}ms</div>
                    `;
                    imagePreview.appendChild(comparison);
                }
                
                log('âœ¨ ç”»åƒæœ€é©åŒ–ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ!');
            } catch (error) {
                log(`âŒ ç”»åƒæœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testStructuredDataOptimization = async function() {
            try {
                log('ğŸ“Š æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                const testStructuredData = {
                    "@context": "https://schema.org",
                    "@type": "VideoGame",
                    "name": "BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ ",
                    "description": "HTML5 Canvas ã‚’ä½¿ç”¨ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—ã‚²ãƒ¼ãƒ ã€‚18ç¨®é¡ä»¥ä¸Šã®ç‰¹æ®Šãªæ³¡ã‚’å‰²ã£ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†ï¼",
                    "genre": "ãƒ‘ã‚ºãƒ«ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³",
                    "gamePlatform": ["Web Browser", "Progressive Web App"],
                    "operatingSystem": ["Any"],
                    "applicationCategory": "Game",
                    "image": "https://example.com/game-screenshot-large.png",
                    "screenshot": [
                        "https://example.com/screenshot1.png",
                        "https://example.com/screenshot2.png"
                    ],
                    "offers": {
                        "@type": "Offer",
                        "price": "0",
                        "priceCurrency": "JPY",
                        "availability": "https://schema.org/InStock"
                    },
                    "creator": {
                        "@type": "Organization",
                        "name": "BubblePop Development Team"
                    },
                    "datePublished": "2024-01-01",
                    "dateModified": new Date().toISOString().split('T')[0],
                    "optionalField": "",
                    "emptyArray": [],
                    "nullValue": null
                };
                
                const originalSize = JSON.stringify(testStructuredData).length;
                log(`ğŸ“ å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: ${originalSize} æ–‡å­—`);
                
                // æœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³åˆ¥ãƒ†ã‚¹ãƒˆ
                const optimizationOptions = [
                    { minify: true, removeOptionalFields: false, compressImages: false },
                    { minify: true, removeOptionalFields: true, compressImages: false },
                    { minify: true, removeOptionalFields: true, compressImages: true }
                ];
                
                for (const options of optimizationOptions) {
                    const startTime = performance.now();
                    const optimized = await performanceOptimizer.optimizeStructuredData(testStructuredData, options);
                    const endTime = performance.now();
                    
                    const optimizedSize = JSON.stringify(optimized).length;
                    const compressionRatio = ((originalSize - optimizedSize) / originalSize * 100).toFixed(1);
                    
                    log(`âœ… æœ€é©åŒ–å®Œäº† (minify:${options.minify}, removeOptional:${options.removeOptionalFields})`);
                    log(`   ğŸ“‰ ã‚µã‚¤ã‚ºå‰Šæ¸›: ${originalSize} â†’ ${optimizedSize} æ–‡å­— (${compressionRatio}%å‰Šæ¸›)`);
                    log(`   â±ï¸ å‡¦ç†æ™‚é–“: ${(endTime - startTime).toFixed(2)}ms`);
                }
                
                log('âœ¨ æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æœ€é©åŒ–ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ!');
            } catch (error) {
                log(`âŒ æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testMetaTagOptimization = async function() {
            try {
                log('ğŸ·ï¸ ãƒ¡ã‚¿ã‚¿ã‚°æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                const testMetaTags = {
                    title: 'BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ  - ç„¡æ–™ã§éŠã¹ã‚‹HTML5ãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ ',
                    description: 'HTML5 Canvas ã‚’ä½¿ç”¨ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—ã‚²ãƒ¼ãƒ ã€‚18ç¨®é¡ä»¥ä¸Šã®ç‰¹æ®Šãªæ³¡ã‚’å‰²ã£ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†ï¼ç„¡æ–™ã§ãƒ–ãƒ©ã‚¦ã‚¶ã§éŠã¹ã‚‹ãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ ã§ã™ã€‚',
                    keywords: 'ãƒãƒ–ãƒ«ãƒãƒƒãƒ—,ã‚²ãƒ¼ãƒ ,HTML5,ãƒ–ãƒ©ã‚¦ã‚¶ã‚²ãƒ¼ãƒ ,ç„¡æ–™,æ³¡å‰²ã‚Š,ãƒ‘ã‚ºãƒ«,ãƒãƒ–ãƒ«ãƒãƒƒãƒ—,ã‚²ãƒ¼ãƒ ,HTML5', // é‡è¤‡ã‚ã‚Š
                    image: 'https://example.com/large-social-image.png',
                    ogTitle: 'BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ  - ç„¡æ–™ã§éŠã¹ã‚‹HTML5ãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ ',
                    ogDescription: 'HTML5 Canvas ã‚’ä½¿ç”¨ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—ã‚²ãƒ¼ãƒ ã€‚18ç¨®é¡ä»¥ä¸Šã®ç‰¹æ®Šãªæ³¡ã‚’å‰²ã£ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†ï¼ç„¡æ–™ã§ãƒ–ãƒ©ã‚¦ã‚¶ã§éŠã¹ã‚‹ãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ ã§ã™ã€‚',
                    twitterTitle: 'BubblePop - æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ  - ç„¡æ–™ã§éŠã¹ã‚‹HTML5ãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ ',
                    twitterDescription: 'HTML5 Canvas ã‚’ä½¿ç”¨ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—ã‚²ãƒ¼ãƒ ã€‚18ç¨®é¡ä»¥ä¸Šã®ç‰¹æ®Šãªæ³¡ã‚’å‰²ã£ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†ï¼ç„¡æ–™ã§ãƒ–ãƒ©ã‚¦ã‚¶ã§éŠã¹ã‚‹ãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ ã§ã™ã€‚',
                    charset: 'UTF-8'
                };
                
                const optimizationOptions = [
                    { compressDescriptions: true, optimizeImages: false, removeDuplicates: true, prioritizeCharset: true },
                    { compressDescriptions: true, optimizeImages: true, removeDuplicates: true, prioritizeCharset: true }
                ];
                
                for (const options of optimizationOptions) {
                    const startTime = performance.now();
                    const optimized = await performanceOptimizer.optimizeMetaTags(testMetaTags, options);
                    const endTime = performance.now();
                    
                    log(`âœ… ãƒ¡ã‚¿ã‚¿ã‚°æœ€é©åŒ–å®Œäº† (ç”»åƒæœ€é©åŒ–:${options.optimizeImages})`);
                    log(`   ğŸ“ ã‚¿ã‚¤ãƒˆãƒ«é•·: ${testMetaTags.title.length} â†’ ${optimized.title.length} æ–‡å­—`);
                    log(`   ğŸ“ èª¬æ˜æ–‡é•·: ${testMetaTags.description.length} â†’ ${optimized.description.length} æ–‡å­—`);
                    log(`   ğŸ”— ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ•°: ${testMetaTags.keywords.split(',').length} â†’ ${optimized.keywords.split(',').length} å€‹`);
                    log(`   â±ï¸ å‡¦ç†æ™‚é–“: ${(endTime - startTime).toFixed(2)}ms`);
                }
                
                log('âœ¨ ãƒ¡ã‚¿ã‚¿ã‚°æœ€é©åŒ–ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ!');
            } catch (error) {
                log(`âŒ ãƒ¡ã‚¿ã‚¿ã‚°æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.runComprehensiveOptimization = async function() {
            try {
                log('âš¡ åŒ…æ‹¬æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                // è¤‡æ•°ã®æœ€é©åŒ–ã‚’åŒæ™‚å®Ÿè¡Œ
                const tasks = [
                    testImageOptimization,
                    testStructuredDataOptimization,
                    testMetaTagOptimization
                ];
                
                const startTime = performance.now();
                await Promise.all(tasks.map(task => task()));
                const endTime = performance.now();
                
                log(`âœ¨ åŒ…æ‹¬æœ€é©åŒ–ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ! ç·å®Ÿè¡Œæ™‚é–“: ${(endTime - startTime).toFixed(2)}ms`);
                
                // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®è¡¨ç¤º
                const metrics = performanceOptimizer.getPerformanceMetrics();
                log('ğŸ“Š æœ€çµ‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹:');
                log(`   ğŸ’¾ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: ${metrics.cacheEfficiency}%`);
                log(`   â±ï¸ å¹³å‡å‡¦ç†æ™‚é–“: ${metrics.averageProcessingTime}ms`);
                log(`   ğŸ”¢ æœ€é©åŒ–å®Ÿè¡Œå›æ•°: ${metrics.imageOptimizations}`);
                log(`   ğŸ“¦ ç·ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚º: ${metrics.totalCacheSize}`);
                
            } catch (error) {
                log(`âŒ åŒ…æ‹¬æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.startPerformanceMonitoring = function() {
            if (isMonitoring) {
                log('âš ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã¯æ—¢ã«å®Ÿè¡Œä¸­ã§ã™', 'warning');
                return;
            }
            
            log('â–¶ï¸ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã‚’é–‹å§‹...');
            isMonitoring = true;
            
            monitoringInterval = setInterval(() => {
                const metrics = performanceOptimizer.getPerformanceMetrics();
                
                // ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤ºã®æ›´æ–°
                document.getElementById('cacheHitRate').textContent = `${metrics.cacheEfficiency}%`;
                document.getElementById('avgProcessingTime').textContent = `${metrics.averageProcessingTime}ms`;
                document.getElementById('totalOptimizations').textContent = metrics.imageOptimizations;
                document.getElementById('compressionRatio').textContent = `${metrics.averageCompressionRatio.toFixed(1)}%`;
                
                // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã®è¨˜éŒ²
                performanceData.push({
                    timestamp: Date.now(),
                    ...metrics
                });
                
                // ãƒ‡ãƒ¼ã‚¿ã¯æœ€å¤§100ãƒã‚¤ãƒ³ãƒˆã¾ã§
                if (performanceData.length > 100) {
                    performanceData.shift();
                }
                
                // ãƒãƒ£ãƒ¼ãƒˆã®æ›´æ–°
                updatePerformanceChart();
                
            }, 1000);
            
            log('âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸï¼ˆ1ç§’é–“éš”ï¼‰');
        };
        
        window.stopPerformanceMonitoring = function() {
            if (!isMonitoring) {
                log('âš ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã¯å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“', 'warning');
                return;
            }
            
            clearInterval(monitoringInterval);
            isMonitoring = false;
            
            log('â¹ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã‚’åœæ­¢ã—ã¾ã—ãŸ');
        };
        
        window.generatePerformanceReport = function() {
            if (performanceData.length === 0) {
                log('âš ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç›£è¦–ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚', 'warning');
                return;
            }
            
            try {
                log('ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆä¸­...');
                
                const latest = performanceData[performanceData.length - 1];
                const oldest = performanceData[0];
                const duration = (latest.timestamp - oldest.timestamp) / 1000;
                
                const report = {
                    ç›£è¦–æœŸé–“: `${duration.toFixed(1)}ç§’`,
                    ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆæ•°: performanceData.length,
                    æœ€çµ‚ãƒ¡ãƒˆãƒªã‚¯ã‚¹: {
                        ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: `${latest.cacheEfficiency}%`,
                        å¹³å‡å‡¦ç†æ™‚é–“: `${latest.averageProcessingTime}ms`,
                        æœ€é©åŒ–å®Ÿè¡Œå›æ•°: latest.imageOptimizations,
                        åœ§ç¸®ç‡: `${latest.averageCompressionRatio.toFixed(1)}%`,
                        ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚º: latest.totalCacheSize
                    },
                    WebPå¯¾å¿œ: latest.webpSupported ? 'âœ… å¯¾å¿œ' : 'âŒ éå¯¾å¿œ'
                };
                
                log('ğŸ“‹ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ:');
                log(JSON.stringify(report, null, 2));
                
                // ãƒ¬ãƒãƒ¼ãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `seo-performance-report-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                log('âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸ');
                
            } catch (error) {
                log(`âŒ ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.analyzeCacheEfficiency = function() {
            try {
                log('ğŸ“Š ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡åˆ†æã‚’å®Ÿè¡Œä¸­...');
                
                const metrics = performanceOptimizer.getPerformanceMetrics();
                const cacheHeaders = performanceOptimizer.generateCacheHeaders('image');
                
                log('ğŸ’¾ ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ†æçµæœ:');
                log(`   ãƒ’ãƒƒãƒˆç‡: ${metrics.cacheEfficiency}% (${metrics.cacheHits}/${metrics.cacheHits + metrics.cacheMisses})`);
                log(`   ç·ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚º: ${metrics.totalCacheSize} ã‚¢ã‚¤ãƒ†ãƒ `);
                log(`   æ¨å¥¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ˜ãƒƒãƒ€ãƒ¼:`);
                Object.entries(cacheHeaders).forEach(([key, value]) => {
                    log(`     ${key}: ${value}`);
                });
                
                // ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡ã®è©•ä¾¡
                let efficiency = 'Unknown';
                if (metrics.cacheEfficiency >= 80) efficiency = 'å„ªç§€';
                else if (metrics.cacheEfficiency >= 60) efficiency = 'è‰¯å¥½';
                else if (metrics.cacheEfficiency >= 40) efficiency = 'æ”¹å–„ã®ä½™åœ°ã‚ã‚Š';
                else efficiency = 'è¦æ”¹å–„';
                
                log(`   ğŸ“ˆ åŠ¹ç‡è©•ä¾¡: ${efficiency}`);
                
            } catch (error) {
                log(`âŒ ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ†æã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testCacheStrategies = async function() {
            try {
                log('ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                // ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿
                const testImageUrl = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABUlEQVR42mNkYPhfDwABIgCBWW+6zAAAAABJRU5ErkJggg==';
                
                // åŒã˜ç”»åƒã‚’è¤‡æ•°å›æœ€é©åŒ–ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœã‚’ãƒ†ã‚¹ãƒˆ
                log('ğŸ“Š ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãƒ†ã‚¹ãƒˆ...');
                
                for (let i = 0; i < 5; i++) {
                    const startTime = performance.now();
                    await performanceOptimizer.optimizeImage(testImageUrl, { width: 32, height: 32 });
                    const endTime = performance.now();
                    
                    log(`   å®Ÿè¡Œ ${i + 1}: ${(endTime - startTime).toFixed(2)}ms`);
                }
                
                const finalMetrics = performanceOptimizer.getPerformanceMetrics();
                log(`âœ… æœ€çµ‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: ${finalMetrics.cacheEfficiency}%`);
                
            } catch (error) {
                log(`âŒ ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.clearAllCaches = function() {
            try {
                log('ğŸ—‘ï¸ å…¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ä¸­...');
                
                performanceOptimizer.clearCache('all');
                
                // ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®æ›´æ–°
                const metrics = performanceOptimizer.getPerformanceMetrics();
                document.getElementById('cacheHitRate').textContent = `${metrics.cacheEfficiency}%`;
                document.getElementById('totalOptimizations').textContent = metrics.imageOptimizations;
                
                log('âœ… å…¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚¯ãƒªã‚¢ã•ã‚Œã¾ã—ãŸ');
                
            } catch (error) {
                log(`âŒ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.runBeforeAfterComparison = async function() {
            try {
                log('ğŸ“Š æœ€é©åŒ–å‰å¾Œæ¯”è¼ƒãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                // ãƒ†ã‚¹ãƒˆç”¨ã®å¤§ãã‚ã®ç”»åƒãƒ‡ãƒ¼ã‚¿
                const testImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABUlEQVR42mNkYPhfDwABIgCBWW+6zAAAAABJRU5ErkJggg==';
                
                const comparisons = [
                    { size: '32x32', width: 32, height: 32, quality: 85 },
                    { size: '64x64', width: 64, height: 64, quality: 75 },
                    { size: '128x128', width: 128, height: 128, quality: 90 }
                ];
                
                log('âš–ï¸ æœ€é©åŒ–å‰å¾Œã®æ¯”è¼ƒ:');
                
                for (const comp of comparisons) {
                    const originalSize = testImage.length;
                    
                    const startTime = performance.now();
                    const optimized = await performanceOptimizer.optimizeImage(testImage, comp);
                    const endTime = performance.now();
                    
                    const optimizedSize = optimized.length;
                    const reduction = ((originalSize - optimizedSize) / originalSize * 100).toFixed(1);
                    
                    log(`   ğŸ“ ${comp.size}: ${originalSize} â†’ ${optimizedSize} bytes (${reduction}%å‰Šæ¸›, ${(endTime - startTime).toFixed(2)}ms)`);
                }
                
                log('âœ… æœ€é©åŒ–å‰å¾Œæ¯”è¼ƒãŒå®Œäº†ã—ã¾ã—ãŸ');
                
            } catch (error) {
                log(`âŒ æ¯”è¼ƒãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.benchmarkDifferentSizes = async function() {
            try {
                log('ğŸ“ ã‚µã‚¤ã‚ºåˆ¥ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                const sizes = [
                    { name: 'å° (16x16)', width: 16, height: 16 },
                    { name: 'ä¸­ (64x64)', width: 64, height: 64 },
                    { name: 'å¤§ (256x256)', width: 256, height: 256 },
                    { name: 'ç‰¹å¤§ (512x512)', width: 512, height: 512 }
                ];
                
                const testImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABUlEQVR42mNkYPhfDwABIgCBWW+6zAAAAABJRU5ErkJggg==';
                
                log('âš¡ ã‚µã‚¤ã‚ºåˆ¥å‡¦ç†æ™‚é–“:');
                
                for (const size of sizes) {
                    const times = [];
                    
                    // å„ã‚µã‚¤ã‚ºã‚’3å›ãƒ†ã‚¹ãƒˆã—ã¦å¹³å‡ã‚’ç®—å‡º
                    for (let i = 0; i < 3; i++) {
                        const startTime = performance.now();
                        await performanceOptimizer.optimizeImage(testImage, size);
                        const endTime = performance.now();
                        times.push(endTime - startTime);
                    }
                    
                    const avgTime = times.reduce((a, b) => a + b, 0) / times.length;
                    log(`   ${size.name}: å¹³å‡ ${avgTime.toFixed(2)}ms`);
                }
                
                log('âœ… ã‚µã‚¤ã‚ºåˆ¥ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸ');
                
            } catch (error) {
                log(`âŒ ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testBrowserCompatibility = async function() {
            try {
                log('ğŸŒ ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                const compatibility = {
                    WebPå¯¾å¿œ: 'webpSupported' in performanceOptimizer ? await performanceOptimizer._detectWebPSupport() : false,
                    Canvas2D: 'CanvasRenderingContext2D' in window,
                    FileAPI: 'File' in window && 'FileReader' in window,
                    IntersectionObserver: 'IntersectionObserver' in window,
                    PerformanceObserver: 'PerformanceObserver' in window,
                    ServiceWorker: 'serviceWorker' in navigator
                };
                
                log('ğŸ” ãƒ–ãƒ©ã‚¦ã‚¶æ©Ÿèƒ½å¯¾å¿œçŠ¶æ³:');
                Object.entries(compatibility).forEach(([feature, supported]) => {
                    log(`   ${feature}: ${supported ? 'âœ… å¯¾å¿œ' : 'âŒ éå¯¾å¿œ'}`);
                });
                
                // äº’æ›æ€§ã‚¹ã‚³ã‚¢ã®è¨ˆç®—
                const supportedFeatures = Object.values(compatibility).filter(Boolean).length;
                const totalFeatures = Object.keys(compatibility).length;
                const compatibilityScore = Math.round((supportedFeatures / totalFeatures) * 100);
                
                log(`ğŸ“Š äº’æ›æ€§ã‚¹ã‚³ã‚¢: ${compatibilityScore}% (${supportedFeatures}/${totalFeatures})`);
                
            } catch (error) {
                log(`âŒ äº’æ›æ€§ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.simulateGameSEOOptimization = async function() {
            try {
                log('ğŸ•¹ï¸ ã‚²ãƒ¼ãƒ SEOæœ€é©åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹...');
                
                // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                const gameState = {
                    currentScene: 'GameScene',
                    score: 125000,
                    level: 7,
                    bubblesPopped: 850,
                    achievements: ['bubble_master', 'combo_king'],
                    playTime: 1800 // 30åˆ†
                };
                
                // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã«åŸºã¥ãå‹•çš„ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
                const dynamicMetadata = {
                    title: `BubblePop - ã‚¹ã‚³ã‚¢ ${gameState.score.toLocaleString()} | ãƒ¬ãƒ™ãƒ« ${gameState.level}`,
                    description: `ç¾åœ¨ã®ã‚¹ã‚³ã‚¢: ${gameState.score.toLocaleString()}ç‚¹ã€ãƒ¬ãƒ™ãƒ« ${gameState.level}ã€‚${gameState.bubblesPopped}å€‹ã®æ³¡ã‚’ç ´å£Šã—ã€${gameState.achievements.length}å€‹ã®å®Ÿç¸¾ã‚’è§£é™¤ã€‚`,
                    image: '/assets/images/dynamic-score-share.png',
                    ogTitle: `BubblePop - é«˜ã‚¹ã‚³ã‚¢é”æˆï¼ ${gameState.score.toLocaleString()}ç‚¹`,
                    gameData: gameState
                };
                
                // ãƒ¡ã‚¿ã‚¿ã‚°ã®æœ€é©åŒ–
                const optimizedMeta = await performanceOptimizer.optimizeMetaTags(dynamicMetadata, {
                    compressDescriptions: true,
                    optimizeImages: true,
                    removeDuplicates: true
                });
                
                // æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã¨æœ€é©åŒ–
                const structuredData = {
                    "@context": "https://schema.org",
                    "@type": "VideoGame",
                    "name": "BubblePop",
                    "description": optimizedMeta.description,
                    "gameLocation": {
                        "@type": "VirtualLocation",
                        "name": gameState.currentScene
                    },
                    "quest": {
                        "@type": "Thing",
                        "name": `ãƒ¬ãƒ™ãƒ« ${gameState.level}`,
                        "description": `ç¾åœ¨ã‚¹ã‚³ã‚¢: ${gameState.score.toLocaleString()}`
                    },
                    "achievement": gameState.achievements.map(achievement => ({
                        "@type": "Achievement",
                        "name": achievement
                    }))
                };
                
                const optimizedStructuredData = await performanceOptimizer.optimizeStructuredData(structuredData, {
                    minify: true,
                    removeOptionalFields: true
                });
                
                log('ğŸ® ã‚²ãƒ¼ãƒ çŠ¶æ…‹ãƒ™ãƒ¼ã‚¹SEOæœ€é©åŒ–çµæœ:');
                log(`   ğŸ“Š ã‚¹ã‚³ã‚¢: ${gameState.score.toLocaleString()}ç‚¹`);
                log(`   ğŸ¯ ãƒ¬ãƒ™ãƒ«: ${gameState.level}`);
                log(`   ğŸ’¥ ç ´å£Šæ³¡æ•°: ${gameState.bubblesPopped}å€‹`);
                log(`   ğŸ† å®Ÿç¸¾æ•°: ${gameState.achievements.length}å€‹`);
                log(`   ğŸ“ æœ€é©åŒ–å¾Œã‚¿ã‚¤ãƒˆãƒ«é•·: ${optimizedMeta.title.length}æ–‡å­—`);
                log(`   ğŸ“„ æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚º: ${JSON.stringify(optimizedStructuredData).length}æ–‡å­—`);
                
                log('âœ¨ ã‚²ãƒ¼ãƒ SEOæœ€é©åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Œäº†ã—ã¾ã—ãŸ!');
                
            } catch (error) {
                log(`âŒ ã‚²ãƒ¼ãƒ æœ€é©åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testRealTimeOptimization = async function() {
            try {
                log('âš¡ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹...');
                
                // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æœ€é©åŒ–ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                const scenarios = [
                    { event: 'ã‚¹ã‚³ã‚¢æ›´æ–°', score: 50000 },
                    { event: 'ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—', level: 3 },
                    { event: 'å®Ÿç¸¾è§£é™¤', achievement: 'speed_demon' },
                    { event: 'ãƒã‚¤ã‚¹ã‚³ã‚¢æ›´æ–°', score: 200000 },
                    { event: 'ã‚²ãƒ¼ãƒ çµ‚äº†', finalScore: 185000, playTime: 900 }
                ];
                
                for (const scenario of scenarios) {
                    log(`ğŸ“¢ ã‚¤ãƒ™ãƒ³ãƒˆ: ${scenario.event}`);
                    
                    const startTime = performance.now();
                    
                    // ãƒ¡ã‚¿ã‚¿ã‚°ã®å‹•çš„æ›´æ–°
                    const metaTags = {
                        title: `BubblePop - ${scenario.event}`,
                        description: `ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°: ${JSON.stringify(scenario)}`,
                        image: '/assets/images/realtime-update.png'
                    };
                    
                    const optimized = await performanceOptimizer.optimizeMetaTags(metaTags);
                    const endTime = performance.now();
                    
                    log(`   âš¡ æœ€é©åŒ–å®Œäº†: ${(endTime - startTime).toFixed(2)}ms`);
                    log(`   ğŸ“ ã‚¿ã‚¤ãƒˆãƒ«: "${optimized.title}"`);
                    
                    // çŸ­ã„é–“éš”ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                const finalMetrics = performanceOptimizer.getPerformanceMetrics();
                log(`ğŸ“Š ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æœ€é©åŒ–æ€§èƒ½:`);
                log(`   âš¡ å¹³å‡å‡¦ç†æ™‚é–“: ${finalMetrics.averageProcessingTime}ms`);
                log(`   ğŸ’¾ ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡: ${finalMetrics.cacheEfficiency}%`);
                
                log('âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æœ€é©åŒ–ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ!');
                
            } catch (error) {
                log(`âŒ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æœ€é©åŒ–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function log(message, type = 'info') {
            const activeTab = document.querySelector('.tab.active').dataset.tab;
            const outputId = `${activeTab}Output`;
            const output = document.getElementById(outputId);
            
            const timestamp = new Date().toLocaleTimeString();
            const formattedMessage = `[${timestamp}] ${message}\n`;
            
            if (output.textContent.includes('çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...')) {
                output.textContent = '';
            }
            
            output.textContent += formattedMessage;
            output.scrollTop = output.scrollHeight;
            
            console.log(`[SEO Performance Test] ${message}`);
        }
        
        function updatePerformanceChart() {
            const canvas = document.getElementById('performanceCanvas');
            const ctx = canvas.getContext('2d');
            
            if (!performanceData.length) return;
            
            // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ã‚°ãƒ©ãƒ•ã®æç”»é ˜åŸŸ
            const padding = 40;
            const graphWidth = canvas.width - padding * 2;
            const graphHeight = canvas.height - padding * 2;
            
            // è»¸ã®æç”»
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();
            
            if (performanceData.length < 2) return;
            
            // ãƒ‡ãƒ¼ã‚¿ã®æ­£è¦åŒ–
            const maxProcessingTime = Math.max(...performanceData.map(d => d.averageProcessingTime || 0));
            const maxCacheEfficiency = 100;
            
            // å‡¦ç†æ™‚é–“ã®ã‚°ãƒ©ãƒ•ï¼ˆé’ï¼‰
            ctx.strokeStyle = '#2196F3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            performanceData.forEach((data, index) => {
                const x = padding + (index / (performanceData.length - 1)) * graphWidth;
                const y = canvas.height - padding - ((data.averageProcessingTime || 0) / maxProcessingTime) * (graphHeight / 2);
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡ã®ã‚°ãƒ©ãƒ•ï¼ˆç·‘ï¼‰
            ctx.strokeStyle = '#4CAF50';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            performanceData.forEach((data, index) => {
                const x = padding + (index / (performanceData.length - 1)) * graphWidth;
                const y = canvas.height - padding - (graphHeight / 2) - ((data.cacheEfficiency || 0) / maxCacheEfficiency) * (graphHeight / 2);
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // å‡¡ä¾‹
            ctx.font = '12px Arial';
            ctx.fillStyle = '#2196F3';
            ctx.fillText('å‡¦ç†æ™‚é–“ (ms)', padding + 10, padding + 20);
            ctx.fillStyle = '#4CAF50';
            ctx.fillText('ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡ (%)', padding + 10, padding + 40);
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.addEventListener('DOMContentLoaded', function() {
            // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.dataset.tab;
                    
                    // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–ã®æ›´æ–°
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(targetTab).classList.add('active');
                });
            });
        });
        
        // åˆæœŸåŒ–ã®å®Ÿè¡Œ
        initialize();
    </script>
</body>
</html>