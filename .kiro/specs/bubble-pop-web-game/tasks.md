# 実装計画

## Phase 1: コア機能実装

- [x] 1. プロジェクト基盤セットアップ
  - HTML5 Canvas の基本セットアップ
  - ES6+ モジュール構造の構築
  - 基本的なスタイリング
  - _要件: 11.1, 11.4_

- [x] 2. ゲームエンジンコアの実装
  - GameEngine クラスの基本構造実装
  - ゲームループ（update/render）の実装
  - requestAnimationFrame による60FPS制御
  - deltaTime 計算とフレーム管理
  - _要件: 12.1, 12.2_

- [x] 3. 基本的な入力システム実装
  - マウスクリック・タッチイベントの統一処理
  - Canvas座標系への変換処理
  - GameEngine での入力処理統合
  - _要件: 1.1, 1.2, 11.2, 11.4_

- [x] 4. 基本泡クラスの実装
  - Bubble 基底クラスの実装
  - 泡の基本プロパティ（位置、サイズ、耐久値）
  - 泡の描画メソッド実装
  - 泡の更新ロジック（年齢管理、移動）
  - _要件: 2.1, 5.1_

- [x] 5. 泡の生成・管理システム
  - BubbleManager クラスの実装
  - 泡の生成・削除・更新処理
  - 泡とマウス/タッチ位置の衝突判定
  - 基本的な泡の種類（普通の泡）の実装
  - _要件: 1.1, 2.1, 2.2_

## Phase 2: ゲームプレイ機能

- [x] 6. スコアシステムの実装
  - ScoreManager クラスの実装
  - 基本スコア計算ロジック
  - 時間経過によるスコア変動システム
  - スコア表示UI の実装
  - _要件: 4.1, 4.2, 4.3, 6.1_

- [x] 7. コンボシステムの実装
  - 連続撃破カウンター
  - コンボボーナス計算
  - コンボ表示UI
  - コンボリセット条件の実装
  - _要件: 4.4, 4.5, 6.3_

- [x] 8. HPシステムとゲームオーバー処理
  - PlayerData クラスのHP管理機能
  - ダメージ処理とHP表示
  - ゲームオーバー判定（HP0、時間切れ）
  - ゲームオーバー画面の実装
  - _要件: 3.1, 3.2, 3.3, 3.4, 6.5_

- [x] 9. 特殊泡の種類実装（基本セット）
  - 硬い泡（石、鉄、ダイヤモンド）の実装
  - 複数回クリック処理
  - ピンクの泡（HP回復）の実装
  - 毒の泡（ダメージ）の実装
  - _要件: 1.4, 3.5, 5.1, 5.2, 5.7_

- [x] 10. 特殊泡の種類実装（効果セット）
  - とげとげの泡（連鎖破壊）の実装
  - 虹色の泡（ボーナスタイム）の実装
  - 時計の泡（時間停止効果）の実装
  - S字の泡（追加スコア）の実装
  - _要件: 5.3, 5.4, 5.5_

- [x] 11. 特殊泡の種類実装（挙動セット）
  - ビリビリの泡（画面揺れ・操作不能）の実装
  - 逃げる泡の実装
  - ひび割れの泡（早期破裂）の実装
  - ボス泡（大型・高耐久）の実装
  - _要件: 5.6, 5.8_

- [x] 12. ドラッグ操作と泡の吹き飛ばし
  - ドラッグ検出とベクトル計算の実装
  - 泡の物理的移動処理の実装
  - 画面端での跳ね返り処理の強化
  - 特定泡（虹色・ピンク・時計・S字・ビリビリ・毒）の画面外消滅処理
  - _要件: 1.5, 2.5_

## Phase 3: ステージ・進歩システム

- [x] 13. ステージシステムの基盤実装
  - Stage Configuration の定義
  - ステージ選択画面の実装
  - ステージ固有の泡出現ロジック
  - ステージ開放条件の管理
  - _要件: 7.1, 7.2, 7.3_

- [x] 14. 全ステージタイプの実装
  - 1分ステージ（チュートリアル）
  - 普通のアワアワ〜全部入りアワアワまで9種類
  - ボスアワアワの特別処理
  - ステージ別の難易度調整
  - _要件: 7.4, 7.5_

- [x] 15. 永続データシステムの強化
  - AP/TAP の計算・蓄積処理の実装（ゲームオーバー時のスコア変換）
  - ハイスコア記録システムの実装
  - ステージ別データ管理の追加
  - データ整合性チェックの実装
  - _要件: 8.1, 8.2, 11.5_

- [x] 16. アイテムシステムの実装
  - アイテム定義とデータ構造
  - アイテムショップ画面の実装
  - アイテム購入・所持状態管理
  - アイテム効果の適用システム
  - _要件: 8.3, 8.4, 9.1, 9.2, 9.3, 9.4, 9.5_

## Phase 4: UI・UX・メニューシステム

- [x] 17. メインメニューシステムの実装
  - メインメニュー画面の作成
  - ユーザー名登録・変更機能
  - メニューからステージ選択への遷移
  - 設定・オプション画面の基本実装
  - _要件: 10.1, 10.3_

- [x] 18. ユーザー情報管理画面の実装
  - ユーザー情報表示画面
  - スコア確認画面（ステージ別ハイスコア）
  - データクリア機能
  - 統計情報の表示
  - _要件: 10.2, 10.4, 10.5_

- [x] 19. ドラッグ操作システムの実装
  - ドラッグ検出とベクトル計算
  - 泡の物理的移動処理
  - 特定泡の画面外消滅処理
  - ドラッグ操作のビジュアルフィードバック
  - _要件: 1.5, 2.5_

- [x] 20. ゲーム中UIの完成
  - ギブアップボタンの実装
  - フローティングテキスト効果の実装（現在はconsole.logのみ）
  - UI要素の配置とスタイリング改善
  - ゲーム中の情報表示の強化
  - _要件: 6.1, 6.2, 6.4_

- [x] 21. 視覚・音響効果の実装
  - Web Audio API による効果音システム
  - 泡が割れる時のパーティクル効果
  - 画面揺れ・フラッシュ効果の強化
  - BGM システムの実装
  - _要件: 1.3, 5.6_

## Phase 5: 最適化・テスト・デプロイ

- [x] 22. パフォーマンス最適化の実装
  - オブジェクトプーリングシステム
  - 差分レンダリングの実装
  - メモリリーク対策
  - 60FPS維持の最適化
  - _要件: 12.1, 12.3_

- [x] 23. クロスブラウザ・デバイス対応の強化
  - レスポンシブデザインの実装（Canvas サイズ調整）
  - タッチデバイス最適化（ジェスチャー認識改善）
  - 各ブラウザでの動作確認・修正
  - フォールバック処理の実装（古いブラウザ対応）
  - _要件: 11.1, 11.2, 11.3, 11.4_

- [x] 24. エラーハンドリングと安定性向上
  - ErrorHandler クラスの実装
  - グレースフルデグラデーション
  - 入力値検証の強化
  - 異常状態からの復旧処理
  - _要件: 12.4_

- [x] 25. テストスイートの実装
  - Jest による単体テストの作成
  - 主要機能の統合テスト
  - E2E テストシナリオの実装
  - パフォーマンステストの自動化
  - _要件: 12.1, 12.2, 12.3_

- [x] 26. ビルド・デプロイ設定
  - Vite ビルド設定の最適化
  - アセット最適化（画像圧縮、コード分割）
  - デプロイメント自動化
  - 監視・分析ツールの設定
  - _要件: 11.1, 12.5_

## Phase 6: 追加機能・改善

- [x] 27. ユーザーインターフェース改善
  - 設定画面の拡張（音量調整、品質設定）
  - キーボードショートカットの追加
  - アクセシビリティ機能の強化
  - 多言語対応の基盤実装
  - _要件: 11.1, 11.4_

- [x] 28. ゲームバランス調整
  - 各ステージの難易度バランス調整
  - アイテム価格・効果の調整
  - スコア計算式の最適化
  - プレイヤーフィードバックに基づく改善
  - _要件: 7.4, 8.3, 4.1_

- [ ] 29. 追加コンテンツ
  - 新しい泡タイプの追加
  - 特別イベントステージの実装
  - 実績システムの追加
  - プレイヤー統計の詳細化
  - _要件: 5.1, 7.1, 10.2_

- [ ] 30. 最終調整・ポリッシュ
  - 全体的なバグ修正
  - パフォーマンスの最終調整
  - ユーザビリティテストの実施
  - リリース準備
  - _要件: 12.1, 12.2, 12.3_