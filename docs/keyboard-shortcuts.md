# キーボードショートカット一覧

Bubble Popゲームで利用可能なキーボードショートカットの完全ガイドです。

> **🆕 更新情報**: Issue #163により統一ナビゲーションシステムを導入し、多言語対応とコンテキスト依存のナビゲーションを強化しました。

## 📋 目次

- [統一ナビゲーションシステム](#統一ナビゲーションシステム)
- [基本ゲーム操作](#基本ゲーム操作)
- [UI・メニュー操作](#uiメニュー操作)
- [ヘルプ・設定アクセス](#ヘルプ設定アクセス)
- [多言語キーボードサポート](#多言語キーボードサポート)
- [音量調整](#音量調整)
- [アクセシビリティ機能](#アクセシビリティ機能)
- [デバッグ・開発者向け](#デバッグ開発者向け)
- [シーン別の追加操作](#シーン別の追加操作)
- [使用上の注意事項](#使用上の注意事項)

## 統一ナビゲーションシステム

### 🔄 コンテキスト依存ナビゲーション
統一ナビゲーションシステムにより、どの画面からヘルプや設定にアクセスしても、適切な元の画面に戻れるようになりました。

| 機能 | 説明 |
|------|------|
| **NavigationContextManager** | 画面遷移の履歴を管理し、適切な戻り先を自動判定 |
| **統一シーンルーティング** | ヘルプ・設定画面への一貫したアクセス方法 |
| **多言語対応** | 6言語（日本語、英語、ドイツ語、フランス語、アラビア語、ヘブライ語）でのキーボードマッピング |

### 🌐 RTL言語サポート
アラビア語・ヘブライ語使用時は、ナビゲーションキーの方向が自動調整されます：
- **←キー**: 右方向移動（RTL言語環境）
- **→キー**: 左方向移動（RTL言語環境）

## 基本ゲーム操作

| キー | 機能 | 説明 |
|------|------|------|
| **Space** | ゲーム一時停止/再開 | ゲーム中にゲームを一時停止または再開します |
| **Escape** | メニューに戻る/画面を閉じる | ゲーム中はメインメニューに戻り、設定画面などを閉じます |
| **F** | フルスクリーン切り替え | フルスクリーンモードのオン/オフを切り替えます |
| **M** | 音声ミュート切り替え | 全ての音声のミュート/ミュート解除を切り替えます |
| **G** | ギブアップ | ゲーム中のみ有効。確認ダイアログが表示されます |
| **R** | ゲーム再開始 | ゲーム中のみ有効。確認ダイアログが表示されます |

## UI・メニュー操作

| キー | 機能 | 説明 |
|------|------|------|
| **↑** | 上に移動 | メニュー項目やリストの選択を上に移動します |
| **↓** | 下に移動 | メニュー項目やリストの選択を下に移動します |
| **Enter** | 決定/選択実行 | 現在選択されている項目を実行します |

## ヘルプ・設定アクセス

### 🆕 統一されたアクセス方法

| キー | 機能 | 説明 | 戻り動作 |
|------|------|------|---------|
| **F1** | コンテキスト依存ヘルプ | 現在の画面に特化したヘルプを表示 | 自動的に元の画面に戻る |
| **Ctrl+H** | ドキュメントヘルプ | 詳細なドキュメントとAPIリファレンスを表示 | 自動的に元の画面に戻る |

### 🔄 ナビゲーション特徴
- **どの画面からでもアクセス可能**: メニュー、ゲーム中、他の設定画面からでも利用可能
- **自動的な戻り先判定**: 開いた元の画面を記憶し、適切に戻る
- **コンテキスト情報の保持**: アクセス方法（キーボード、マウス）と元のシーンを記録

## 多言語キーボードサポート

### 🌍 対応言語とキーマッピング

| 言語 | コンテキストヘルプ | ドキュメントヘルプ | 備考 |
|------|-----------|---------|------|
| **日本語** | F1 (ヘルプ) | Ctrl+H (詳細ヘルプ) | 標準QWERTY配列 |
| **英語** | F1 (help) | Ctrl+H (documentation) | 標準QWERTY配列 |
| **ドイツ語** | F1 (hilfe) | Ctrl+H (dokumentation) | QWERTZ配列に最適化 |
| **フランス語** | F1 (aide) | Ctrl+H (documentation) | AZERTY配列に最適化 |
| **アラビア語** | F1 (مساعدة) | Ctrl+H (وثائق) | RTL対応、方向キー自動調整 |
| **ヘブライ語** | F1 (עזרה) | Ctrl+H (תיעוד) | RTL対応、方向キー自動調整 |

### ⚙️ 自動言語検出
- システム言語設定から自動検出
- LocalizationManagerとの連携
- キーボードレイアウトの自動調整

## 音量調整

| キー | 機能 | 説明 |
|------|------|------|
| **Ctrl + ↑** | 音量アップ | マスター音量を10%上げます |
| **Ctrl + ↓** | 音量ダウン | マスター音量を10%下げます |

## アクセシビリティ機能

### 🆕 統合されたアクセシビリティ設定
アクセシビリティ機能は統一された設定画面に統合されました。

| キー | 機能 | 説明 |
|------|------|------|
| **設定画面 → アクセシビリティ** | 統合設定画面 | UI経由で設定画面を開き、アクセシビリティカテゴリでまとめて設定 |
| **Ctrl + Alt + H** | ハイコントラスト切り替え | 高コントラストモードのオン/オフを切り替えます |
| **Ctrl + Alt + T** | 大きなテキスト切り替え | テキストサイズの拡大/標準を切り替えます |
| **Ctrl + Alt + M** | モーション軽減切り替え | アニメーション効果の軽減/標準を切り替えます |

### 🆕 設定画面内のアクセシビリティ機能
| キー | 機能 | 説明 |
|------|------|------|
| **Ctrl + P** | プロファイル切り替え | デフォルト、高コントラスト、運動機能配慮の3つのプロファイル |
| **Ctrl + E** | 設定エクスポート | アクセシビリティ設定をJSON形式でエクスポート |
| **Ctrl + I** | 設定インポート | 以前エクスポートした設定をインポート |

## デバッグ・開発者向け

| キー | 機能 | 説明 |
|------|------|------|
| **F12** | デバッグ情報表示 | コンソールにデバッグ情報を出力します |
| **Ctrl + Shift + D** | デバッグモード切り替え | デバッグモードのオン/オフを切り替えます（要ページリロード） |

## シーン別の追加操作

### ステージ選択画面

| キー | 機能 | 説明 |
|------|------|------|
| **↑↓** | ステージ選択移動 | 利用可能なステージ間を移動します |
| **Enter** | ステージ決定 | 選択したステージでゲームを開始します |

### ショップ画面

| キー | 機能 | 説明 |
|------|------|------|
| **↑↓** | アイテム選択移動 | 購入可能なアイテム間を移動します |
| **Enter** | アイテム購入 | 選択したアイテムを購入します |

### 設定画面

| キー | 機能 | 説明 |
|------|------|------|
| **↑↓** | 設定項目選択 | 設定項目間を移動します |
| **←→** | カテゴリ切り替え | 設定カテゴリ間を移動します |
| **Enter** | 設定変更 | 選択した設定項目を変更します |

## 使用上の注意事項

### ⚠️ 重要な注意点

1. **🆕 統一ナビゲーションシステム**
   - **ESCキー**: 統一ナビゲーションシステムにより、適切な画面に自動的に戻ります
   - **NavigationContextManager**: 画面遷移履歴を管理し、循環ナビゲーションを検出・防止します
   - **フォールバック機能**: 統一シーン切り替えに失敗した場合、従来方式に自動フォールバック

2. **多言語対応**
   - **言語自動検出**: システム設定またはゲーム内設定から言語を自動検出
   - **RTL言語**: アラビア語・ヘブライ語では方向キーが自動調整されます
   - **キーマッピング**: 各言語のキーボード配列に最適化されたショートカット

3. **ユーザー名入力中の制限**
   - ユーザー名入力画面では、一部のショートカットが意図しない動作を引き起こす可能性があります
   - 入力中は文字入力に集中し、ショートカットの使用は避けてください

4. **デバッグ機能**
   - デバッグ関連のショートカットは開発モードでのみ有効です
   - 本番環境では一部の機能が制限される場合があります

### 💡 使用のコツ

- **🆕 統一アクセス**: F1、Ctrl+Hキーでどの画面からでもヘルプにアクセス可能
- **🆕 コンテキスト保持**: どの画面から開いても、適切な元の画面に戻れます
- **効率的なナビゲーション**: 矢印キーとEnterキーを組み合わせることで、マウスを使わずに全ての操作が可能です
- **アクセシビリティ**: 視覚的な制約がある場合は、統合されたアクセシビリティ設定を活用してください
- **音量調整**: ゲーム中でもCtrl+矢印キーで素早く音量調整ができます
- **🆕 多言語**: 使用言語に応じてキーマッピングが自動調整されます

## 技術詳細

### 🔧 実装アーキテクチャ
- **NavigationContextManager**: `src/core/navigation/NavigationContextManager.js`
- **KeyboardShortcutRouter**: `src/core/navigation/KeyboardShortcutRouter.js`  
- **CoreKeyboardShortcutManager**: `src/core/KeyboardShortcutManager.js`
- **LanguageSpecificAccessibility**: `src/accessibility/LanguageSpecificAccessibility.js`

### 📊 統計情報
- **削除された重複コード**: 4,330行
- **テストカバレッジ**: 200+ テストケース
- **対応言語**: 6言語（多言語キーボードマッピング）
- **統合されたコンポーネント**: ContextualHelpSystem、AccessibilitySettingsUI

## 関連ドキュメント

- [アクセシビリティガイド](accessibility-api-documentation.md)
- [開発者ガイド](development-guide.md)
- [トラブルシューティング](troubleshooting-guide.md)
- [Issue #163: 重複画面統合プロジェクト](../work-progress-issue-163.md)
- [キーボードショートカット実装分析](keyboard-shortcut-mapping-analysis.md)

---

**🎉 統一ナビゲーションシステムにより、より直感的で一貫したキーボード操作をお楽しみください！**

> **バージョン情報**: この更新はIssue #163の統一ナビゲーションシステム導入により実現されました。従来の4,330行の重複コードを削除し、統一されたユーザーエクスペリエンスを提供します。