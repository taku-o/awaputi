# ゲーム分析機能 ユーザーガイド

## 概要

BubblePopゲームの分析機能は、あなたのプレイスタイルを分析し、上達をサポートする包括的なシステムです。プレイヤーの行動パターン、ゲームパフォーマンス、スキル進歩を自動的に追跡・分析し、個別化された改善提案を提供します。

## 主な機能

### 📊 プレイヤー行動分析
- **セッション追跡**: プレイ時間、ステージ進行、離脱ポイントの詳細分析
- **反応時間測定**: バブルクリックの反応速度とその改善傾向
- **成功率分析**: バブル種類別の成功率と苦手パターンの特定
- **プレイスタイル分類**: 攻撃的・守備的・戦略的な傾向の分析

### 🎯 ゲームバランス分析
- **バブル出現分析**: 各バブルタイプの出現頻度と対処成功率
- **スコア分布分析**: 獲得スコアのパターンとボーナス効率
- **アイテム効果測定**: アイテム使用のタイミングと効果分析
- **難易度バランス**: ステージ別の難易度適正性チェック

### 🚀 パフォーマンス監視
- **フレームレート監視**: ゲーム実行時のFPS追跡と安定性分析
- **メモリ使用量監視**: メモリ消費パターンと最適化状況
- **エラー追跡**: 発生エラーの分類と頻度分析
- **ロード時間測定**: アセット読み込み時間と最適化効果

### 📈 トレンド分析
- **スキル向上トレンド**: 時系列でのパフォーマンス改善分析
- **週次・月次レポート**: 定期的な成長サマリー
- **異常パターン検出**: 通常と異なるプレイパターンの検出
- **季節性分析**: プレイ傾向の季節的変化

### 🏆 比較分析
- **過去の自分との比較**: 1週間前、1ヶ月前の成績との詳細比較
- **全体平均との比較**: 匿名化された全プレイヤー平均との比較
- **ステージ別比較**: 各ステージでの相対的パフォーマンス
- **改善提案**: データに基づく具体的なスキルアップアドバイス

## 初期設定

### 1. 分析機能の有効化

ゲーム初回起動時に、データ収集に関する同意確認ダイアログが表示されます。

![同意確認ダイアログ](images/consent-dialog.png)

- **「同意する」**: 全ての分析機能が有効になります
- **「拒否する」**: エラー情報のみの最小限データ収集になります

### 2. プライバシー設定の調整

設定画面 → プライバシー設定で、データ収集の詳細を調整できます。

![プライバシー設定](images/privacy-settings.png)

#### 設定可能項目：
- **行動分析**: プレイヤーの操作パターン分析
- **パフォーマンス分析**: ゲーム実行性能の分析
- **エラー分析**: エラー情報の収集（常に有効）

## 分析ダッシュボードの使い方

### アクセス方法

1. **デバッグモード**: `F12`キーを押してデバッグパネルを開く
2. **分析タブ**: 「Analytics」タブをクリック
3. **ダッシュボード表示**: 各種分析結果が表示されます

![分析ダッシュボード](images/analytics-dashboard.png)

### 基本統計セクション

#### プレイ時間
- **総プレイ時間**: 累計ゲームプレイ時間
- **平均セッション時間**: 1回あたりの平均プレイ時間
- **最長セッション**: 最も長くプレイした記録

#### スコア統計
- **平均スコア**: 全セッションの平均獲得スコア
- **最高スコア**: これまでの最高記録
- **スコア向上率**: 過去1週間との比較

#### 成功率統計
- **総合成功率**: 全バブルクリックの成功率
- **バブル種類別成功率**: タイプ別の詳細成功率
- **コンボ成功率**: 連続成功の継続率

### バブルタイプ別分析

![バブル分析](images/bubble-analysis.png)

#### 円グラフ表示
各バブルタイプの遭遇頻度を視覚化：
- **Normal**: 基本バブル
- **Stone/Iron/Diamond**: 硬いバブル
- **Rainbow**: ボーナスバブル
- **Electric**: 妨害バブル
- **Boss**: 大型バブル

#### 棒グラフ表示
バブルタイプ別の成功率比較：
- 緑色: 高成功率（80%以上）
- 黄色: 中成功率（60-80%）
- 赤色: 低成功率（60%未満）

### トレンド分析

![トレンド分析](images/trend-analysis.png)

#### 時系列グラフ
- **スコア推移**: 日別・週別のスコア変化
- **反応時間推移**: 操作速度の改善トレンド
- **成功率推移**: 精度の向上状況

#### トレンド評価
- **改善中** 🔼: 継続的な向上が見られる
- **安定** ➡️: 一定レベルを維持
- **低下** 🔽: 注意が必要な下降トレンド

### パフォーマンス監視

![パフォーマンス監視](images/performance-monitor.png)

#### リアルタイム表示
- **FPS**: 現在のフレームレート
- **メモリ使用量**: リアルタイムメモリ消費
- **処理時間**: イベント処理にかかる時間

#### 警告システム
- **🟢 正常**: 全て正常範囲内
- **🟡 注意**: 軽微なパフォーマンス低下
- **🔴 警告**: 重大なパフォーマンス問題

## 改善提案の活用

### 個別化されたアドバイス

分析結果に基づいて、あなた専用の改善アドバイスが生成されます。

![改善提案](images/improvement-suggestions.png)

#### 提案例：

**反応時間改善**
```
現在の平均反応時間: 520ms
目標反応時間: 450ms

💡 改善アドバイス:
- Normal バブルに集中した練習を行いましょう
- 画面中央部分のバブルから始めて、徐々に端に移動する練習が効果的です
```

**成功率向上**
```
Electric バブルの成功率: 65%
全体平均: 78%

💡 改善アドバイス:
- Electric バブルの震動パターンを覚えましょう
- 震動が止まった瞬間を狙うとより確実にクリックできます
```

**プレイスタイル最適化**
```
あなたのプレイスタイル: 守備的 (70%)

💡 改善アドバイス:
- 時々積極的なプレイを試してみましょう
- Rainbow バブルを見つけたら優先的に狙うことで、スコアが大幅に向上します
```

### 練習メニュー提案

弱点分析に基づいた効果的な練習方法：

1. **反応速度向上練習**
   - Normal バブルのみのステージで連続クリック練習
   - 目標: 平均反応時間 400ms以下

2. **精度向上練習**
   - 小さなバブルを中心とした精密クリック練習
   - 目標: 成功率 90%以上

3. **コンボ継続練習**
   - Rainbow バブルを活用したコンボ構築練習
   - 目標: 最大コンボ数 20以上

## データのエクスポートとバックアップ

### データエクスポート

自分のプレイデータを外部ファイルとして保存できます。

![データエクスポート](images/data-export.png)

#### エクスポート形式：
- **JSON形式**: プログラマ向け詳細データ
- **CSV形式**: 表計算ソフトで分析可能
- **テキスト形式**: 人間が読みやすい形式

#### エクスポート手順：
1. 分析ダッシュボードを開く
2. 「データエクスポート」ボタンをクリック
3. 形式を選択して「エクスポート」をクリック
4. ファイルが自動ダウンロードされます

### データバックアップ

重要なプレイデータを失わないように、定期的なバックアップが推奨されます。

#### 自動バックアップ：
- **頻度**: 7日間隔で自動実行
- **保存場所**: ブラウザのローカルストレージ
- **保持期間**: 最新3世代を保持

#### 手動バックアップ：
1. 設定画面 → データ管理
2. 「バックアップ作成」をクリック
3. バックアップファイルがダウンロードされます

## プライバシーとデータ保護

### データの匿名化

収集されるすべてのデータは自動的に匿名化されます：

- **個人識別情報の除去**: 名前、メールアドレスなどは記録されません
- **IP アドレスの匿名化**: ネットワーク情報は匿名化されます
- **タイムスタンプの曖昧化**: 正確な時間情報は除去されます

### GDPR準拠

欧州圏内からのアクセスの場合、GDPR（一般データ保護規則）に完全準拠：

- **明示的同意**: データ収集前の明確な同意取得
- **アクセス権**: 自分のデータの確認・ダウンロード権
- **削除権**: データの完全削除要求権
- **修正権**: 不正確なデータの修正権

### データ削除

すべてのデータを完全に削除したい場合：

1. 設定画面 → プライバシー設定
2. 「すべてのデータを削除」をクリック
3. 確認ダイアログで「削除する」をクリック
4. データが即座に完全削除されます

![データ削除](images/data-deletion.png)

## トラブルシューティング

### よくある問題と解決法

#### Q: 分析ダッシュボードが表示されない
**A**: 以下を確認してください：
1. データ収集に同意しているか
2. F12キーでデバッグパネルが開いているか  
3. ブラウザでJavaScriptが有効になっているか

#### Q: データが収集されていない
**A**: 以下を確認してください：
1. プライバシー設定で分析機能が有効になっているか
2. ブラウザのLocalStorage/IndexedDBが利用可能か
3. アドブロッカーやプライバシー拡張機能が干渉していないか

#### Q: パフォーマンス警告が頻繁に表示される
**A**: 以下の対処法を試してください：
1. ブラウザの他のタブを閉じる
2. ブラウザを再起動する
3. 設定画面でエフェクト品質を下げる

#### Q: エクスポートファイルが開けない
**A**: ファイル形式を確認してください：
- JSON: テキストエディタまたはJSON viewer
- CSV: Excel、Numbers、Google Sheetsなど
- テキスト: 任意のテキストエディタ

### サポート情報

#### エラーレポート

システムエラーが発生した場合、自動的にエラーレポートが生成されます。この情報は問題解決のために使用され、個人を特定する情報は含まれません。

#### パフォーマンス最適化

ゲームが重く感じる場合の最適化手順：

1. **品質設定の調整**
   - 設定画面 → 表示設定
   - エフェクト品質を「低」に設定

2. **バッチ処理の調整**
   - デバッグパネル → Analytics → 設定
   - バッチサイズを小さく調整（推奨: 20-30）

3. **キャッシュクリア**
   - 設定画面 → データ管理
   - 「キャッシュクリア」をクリック

## 高度な使用方法

### 開発者向け機能

ゲーム開発に興味がある方向けの高度な機能：

#### カスタム分析クエリ

ブラウザコンソールで直接データを分析：

```javascript
// 週間スコア推移の取得
const weeklyScores = await analyticsManager.storageManager.getData('sessions', {
    startTime: { $gte: Date.now() - 7 * 24 * 60 * 60 * 1000 }
});

// バブルタイプ別成功率の計算
const bubbleStats = await analyticsManager.storageManager.aggregateData('bubbleInteractions', {
    groupBy: 'bubbleType',
    aggregations: {
        successRate: { $avg: { $cond: [{ $eq: ['action', 'popped'] }, 1, 0] } }
    }
});
```

#### API アクセス

プログラマティックなデータアクセス：

```javascript
// 分析APIを使用したデータ取得
const summaryData = await analyticsAPI.getData({
    endpoint: '/stats/summary',
    parameters: { period: 'month' }
});

// カスタムフィルタでのデータエクスポート
const customData = await exportManager.exportFiltered({
    table: 'sessions',
    filters: { completed: true, finalScore: { $gt: 5000 } },
    format: 'json'
});
```

## まとめ

ゲーム分析機能を活用することで：

- **🎯 弱点の特定**: データに基づいた客観的な弱点分析
- **📈 成長の可視化**: 継続的な上達の実感
- **🏆 目標設定**: 具体的で達成可能な目標設定
- **🛡️ プライバシー保護**: 安全で透明なデータ管理

あなたのBubblePopスキル向上の旅をサポートします！

---

### 更新履歴

- **v1.0.0** (2025-01-XX): 初版リリース
  - 基本分析機能
  - プライバシー管理
  - データエクスポート

- **v1.1.0** (2025-XX-XX): 機能拡張
  - トレンド分析強化
  - 比較分析追加
  - パフォーマンス最適化

### フィードバック

機能に関するご意見・ご質問は、ゲーム内のフィードバック機能またはプロジェクトのGitHubリポジトリまでお寄せください。皆様のフィードバックが、より良い分析体験の実現につながります。