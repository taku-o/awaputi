<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO I18n Test - BubblePop</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .button:hover {
            background: #45a049;
        }
        .button.secondary {
            background: #2196F3;
        }
        .button.secondary:hover {
            background: #1976D2;
        }
        .output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .meta-preview {
            background: #e8f5e8;
            border: 1px solid #c8e6c9;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .meta-preview h3 {
            color: #2e7d32;
            margin-top: 0;
        }
        .language-selector {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .language-btn {
            padding: 8px 16px;
            border: 2px solid #4CAF50;
            background: white;
            color: #4CAF50;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .language-btn:hover,
        .language-btn.active {
            background: #4CAF50;
            color: white;
        }
        .info-box {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        .info-box h4 {
            color: #1565c0;
            margin-top: 0;
        }
        .validation-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .validation-result.valid {
            background: #e8f5e8;
            border: 1px solid #c8e6c9;
            color: #2e7d32;
        }
        .validation-result.invalid {
            background: #ffebee;
            border: 1px solid #ffcdd2;
            color: #d32f2f;
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #f5f5f5;
            border: none;
            font-size: 16px;
            transition: all 0.3s;
        }
        .tab:hover,
        .tab.active {
            background: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ SEOå¤šè¨€èªåŒ–ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«</h1>
        <p>SEOå›½éš›åŒ–æ©Ÿèƒ½ï¼ˆhreflangã‚¿ã‚°ã€å¤šè¨€èªãƒ¡ã‚¿ã‚¿ã‚°ã€æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        
        <div class="info-box">
            <h4>ğŸ“‹ ãƒ†ã‚¹ãƒˆå¯¾è±¡æ©Ÿèƒ½</h4>
            <ul>
                <li><strong>hreflangã‚¿ã‚°ç”Ÿæˆ:</strong> å…¨ã‚µãƒãƒ¼ãƒˆè¨€èªã®hreflangã‚¿ã‚°</li>
                <li><strong>å¤šè¨€èªãƒ¡ã‚¿ã‚¿ã‚°:</strong> è¨€èªåˆ¥ã®title, description, keywords</li>
                <li><strong>æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿:</strong> è¨€èªå›ºæœ‰ã®JSON-LD</li>
                <li><strong>åœ°åŸŸåŒ–æ©Ÿèƒ½:</strong> é€šè²¨ã€ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã€åœ°åŸŸè¨­å®š</li>
                <li><strong>å¤šè¨€èªã‚µã‚¤ãƒˆãƒãƒƒãƒ—:</strong> hreflangå¯¾å¿œsitemap.xml</li>
            </ul>
        </div>
        
        <div class="language-selector">
            <span><strong>è¨€èªé¸æŠ:</strong></span>
            <button class="language-btn active" data-lang="ja">æ—¥æœ¬èª (ja)</button>
            <button class="language-btn" data-lang="en">English (en)</button>
            <button class="language-btn" data-lang="zh-CN">ä¸­æ–‡ç®€ä½“ (zh-CN)</button>
            <button class="language-btn" data-lang="zh-TW">ä¸­æ–‡ç¹é«” (zh-TW)</button>
            <button class="language-btn" data-lang="ko">í•œêµ­ì–´ (ko)</button>
        </div>
    </div>
    
    <div class="container">
        <div class="tabs">
            <button class="tab active" data-tab="hreflang">hreflangã‚¿ã‚°</button>
            <button class="tab" data-tab="meta">ãƒ¡ã‚¿ã‚¿ã‚°</button>
            <button class="tab" data-tab="structured">æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿</button>
            <button class="tab" data-tab="sitemap">ã‚µã‚¤ãƒˆãƒãƒƒãƒ—</button>
            <button class="tab" data-tab="validation">æ¤œè¨¼</button>
        </div>
        
        <!-- hreflangã‚¿ãƒ– -->
        <div class="tab-content active" id="hreflang">
            <h3>ğŸ”— hreflangã‚¿ã‚°ç”Ÿæˆãƒ†ã‚¹ãƒˆ</h3>
            <div class="controls">
                <button class="button" onclick="generateHreflangTags()">hreflangã‚¿ã‚°ç”Ÿæˆ</button>
                <button class="button secondary" onclick="testDifferentPaths()">è¤‡æ•°ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div class="output" id="hreflangOutput">hreflangã‚¿ã‚°ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
        
        <!-- ãƒ¡ã‚¿ã‚¿ã‚°ã‚¿ãƒ– -->
        <div class="tab-content" id="meta">
            <h3>ğŸ·ï¸ å¤šè¨€èªãƒ¡ã‚¿ã‚¿ã‚°ãƒ†ã‚¹ãƒˆ</h3>
            <div class="controls">
                <button class="button" onclick="generateLocalizedMeta()">å¤šè¨€èªãƒ¡ã‚¿ã‚¿ã‚°ç”Ÿæˆ</button>
                <button class="button secondary" onclick="testGameStateContext()">ã‚²ãƒ¼ãƒ çŠ¶æ…‹é€£æºãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div class="meta-preview" id="metaPreview"></div>
            <div class="output" id="metaOutput">ãƒ¡ã‚¿ã‚¿ã‚°æƒ…å ±ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
        
        <!-- æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚¿ãƒ– -->
        <div class="tab-content" id="structured">
            <h3>ğŸ“Š å¤šè¨€èªæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ</h3>
            <div class="controls">
                <button class="button" onclick="generateStructuredData()">æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ</button>
                <button class="button secondary" onclick="testAllLanguagesStructured()">å…¨è¨€èªãƒ†ã‚¹ãƒˆ</button>
            </div>
            <div class="output" id="structuredOutput">æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
        
        <!-- ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚¿ãƒ– -->
        <div class="tab-content" id="sitemap">
            <h3>ğŸ—ºï¸ å¤šè¨€èªã‚µã‚¤ãƒˆãƒãƒƒãƒ—ãƒ†ã‚¹ãƒˆ</h3>
            <div class="controls">
                <button class="button" onclick="generateMultilingualSitemap()">å¤šè¨€èªã‚µã‚¤ãƒˆãƒãƒƒãƒ—ç”Ÿæˆ</button>
                <button class="button secondary" onclick="downloadSitemap()">ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
            </div>
            <div class="output" id="sitemapOutput">ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
        
        <!-- æ¤œè¨¼ã‚¿ãƒ– -->
        <div class="tab-content" id="validation">
            <h3>âœ… SEOå¤šè¨€èªåŒ–æ¤œè¨¼</h3>
            <div class="controls">
                <button class="button" onclick="validateI18nSEO()">SEOæ¤œè¨¼å®Ÿè¡Œ</button>
                <button class="button secondary" onclick="generateComplianceReport()">ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ</button>
            </div>
            <div id="validationResults"></div>
            <div class="output" id="validationOutput">æ¤œè¨¼çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
        </div>
    </div>
    
    <div class="container">
        <h2>ğŸ® å®Ÿéš›ã®ã‚²ãƒ¼ãƒ é€£æºãƒ†ã‚¹ãƒˆ</h2>
        <div class="controls">
            <button class="button" onclick="simulateGameContext()">ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</button>
            <button class="button secondary" onclick="testSEOIntegration()">SEOçµ±åˆãƒ†ã‚¹ãƒˆ</button>
        </div>
        <div class="output" id="integrationOutput">çµ±åˆãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
    </div>

    <script type="module">
        import { SEOI18nManager } from './src/seo/SEOI18nManager.js';
        import { SEOMetaManager } from './src/seo/SEOMetaManager.js';
        
        let i18nManager;
        let metaManager;
        let currentLanguage = 'ja';
        let lastGeneratedSitemap = '';
        
        // ãƒ¢ãƒƒã‚¯LocalizationManagerï¼ˆå®Ÿéš›ã®ãƒ†ã‚¹ãƒˆç”¨ï¼‰
        const mockLocalizationManager = {
            currentLanguage: 'ja',
            translations: {
                ja: {
                    'seo.title': 'BubblePop',
                    'seo.subtitle': 'æ³¡å‰²ã‚Šã‚²ãƒ¼ãƒ ',
                    'seo.description': 'HTML5 Canvas ã‚’ä½¿ç”¨ã—ãŸãƒãƒ–ãƒ«ãƒãƒƒãƒ—ã‚²ãƒ¼ãƒ ã€‚18ç¨®é¡ä»¥ä¸Šã®ç‰¹æ®Šãªæ³¡ã‚’å‰²ã£ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†ï¼',
                    'seo.keywords': 'ãƒãƒ–ãƒ«ãƒãƒƒãƒ—,ã‚²ãƒ¼ãƒ ,HTML5,ãƒ–ãƒ©ã‚¦ã‚¶ã‚²ãƒ¼ãƒ ,ç„¡æ–™,æ³¡å‰²ã‚Š,ãƒ‘ã‚ºãƒ«'
                },
                en: {
                    'seo.title': 'BubblePop',
                    'seo.subtitle': 'Bubble Popping Game',
                    'seo.description': 'A bubble popping game built with HTML5 Canvas. Pop over 18 types of special bubbles to achieve high scores!',
                    'seo.keywords': 'bubble pop,game,HTML5,browser game,free,puzzle,casual'
                },
                'zh-CN': {
                    'seo.title': 'BubblePop',
                    'seo.subtitle': 'æ³¡æ³¡å°„å‡»æ¸¸æˆ',
                    'seo.description': 'ä½¿ç”¨ HTML5 Canvas æ„å»ºçš„æ³¡æ³¡å°„å‡»æ¸¸æˆã€‚å°„å‡»è¶…è¿‡18ç§ç‰¹æ®Šæ³¡æ³¡ï¼Œäº‰å–é«˜åˆ†ï¼',
                    'seo.keywords': 'æ³¡æ³¡å°„å‡»,æ¸¸æˆ,HTML5,æµè§ˆå™¨æ¸¸æˆ,å…è´¹,ç›Šæ™º'
                },
                'zh-TW': {
                    'seo.title': 'BubblePop',
                    'seo.subtitle': 'æ³¡æ³¡å°„æ“ŠéŠæˆ²',
                    'seo.description': 'ä½¿ç”¨ HTML5 Canvas æ§‹å»ºçš„æ³¡æ³¡å°„æ“ŠéŠæˆ²ã€‚å°„æ“Šè¶…é18ç¨®ç‰¹æ®Šæ³¡æ³¡ï¼Œçˆ­å–é«˜åˆ†ï¼',
                    'seo.keywords': 'æ³¡æ³¡å°„æ“Š,éŠæˆ²,HTML5,ç€è¦½å™¨éŠæˆ²,å…è²»,ç›Šæ™º'
                },
                ko: {
                    'seo.title': 'BubblePop',
                    'seo.subtitle': 'ë²„ë¸”íŒ ê²Œì„',
                    'seo.description': 'HTML5 Canvasë¡œ ì œì‘ëœ ë²„ë¸”íŒ ê²Œì„. 18ê°€ì§€ ì´ìƒì˜ íŠ¹ìˆ˜ ë²„ë¸”ì„ í„°ëœ¨ë ¤ ë†’ì€ ì ìˆ˜ë¥¼ ë‹¬ì„±í•˜ì„¸ìš”!',
                    'seo.keywords': 'ë²„ë¸”íŒ,ê²Œì„,HTML5,ë¸Œë¼ìš°ì €ê²Œì„,ë¬´ë£Œ,í¼ì¦'
                }
            },
            languageChangeListeners: [],
            
            getCurrentLanguage() {
                return this.currentLanguage;
            },
            
            t(key) {
                const translation = this.translations[this.currentLanguage]?.[key];
                return translation || key;
            },
            
            isRTLLanguage(lang) {
                const rtlLanguages = ['ar', 'he', 'fa', 'ur'];
                return rtlLanguages.includes(lang);
            },
            
            getTextDirection() {
                return this.isRTLLanguage(this.currentLanguage) ? 'rtl' : 'ltr';
            },
            
            addLanguageChangeListener(callback) {
                this.languageChangeListeners.push(callback);
            },
            
            removeLanguageChangeListener(callback) {
                const index = this.languageChangeListeners.indexOf(callback);
                if (index > -1) {
                    this.languageChangeListeners.splice(index, 1);
                }
            },
            
            setLanguage(lang) {
                const oldLang = this.currentLanguage;
                this.currentLanguage = lang;
                this.languageChangeListeners.forEach(listener => listener(lang, oldLang));
            }
        };
        
        // åˆæœŸåŒ–
        async function initialize() {
            try {
                metaManager = new SEOMetaManager(mockLocalizationManager);
                i18nManager = new SEOI18nManager(mockLocalizationManager, metaManager);
                
                log('ğŸš€ SEOå¤šè¨€èªåŒ–ã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¾ã—ãŸ');
                log('ğŸ“± å„ã‚¿ãƒ–ã§ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã‚’è©¦ã—ã¦ãã ã•ã„');
            } catch (error) {
                log(`âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã®å®šç¾©
        window.generateHreflangTags = async function() {
            try {
                log('ğŸ”— hreflangã‚¿ã‚°ã‚’ç”Ÿæˆä¸­...');
                
                const hreflangTags = await i18nManager.generateHreflangTags('/');
                document.getElementById('hreflangOutput').textContent = hreflangTags;
                
                log('âœ… hreflangã‚¿ã‚°ã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ hreflangã‚¿ã‚°ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testDifferentPaths = async function() {
            try {
                log('ğŸ›¤ï¸ è¤‡æ•°ãƒ‘ã‚¹ã®hreflangãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...');
                
                const paths = ['/', '/help/', '/stats/', '/achievements/'];
                let allTags = '';
                
                for (const path of paths) {
                    const tags = await i18nManager.generateHreflangTags(path);
                    allTags += `\\n<!-- ${path} -->\\n${tags}`;
                }
                
                document.getElementById('hreflangOutput').textContent = allTags;
                log('âœ… è¤‡æ•°ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ è¤‡æ•°ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.generateLocalizedMeta = async function() {
            try {
                log('ğŸ·ï¸ å¤šè¨€èªãƒ¡ã‚¿ã‚¿ã‚°ã‚’ç”Ÿæˆä¸­...');
                
                const metadata = await i18nManager.generateLocalizedMetaTags({
                    pageType: 'game'
                });
                
                // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
                const preview = document.getElementById('metaPreview');
                preview.innerHTML = `
                    <h3>ğŸ“„ ${metadata.language.toUpperCase()} ãƒ¡ã‚¿ã‚¿ã‚°ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
                    <p><strong>Title:</strong> ${metadata.title}</p>
                    <p><strong>Description:</strong> ${metadata.description}</p>
                    <p><strong>Keywords:</strong> ${metadata.keywords}</p>
                    <p><strong>Locale:</strong> ${metadata.locale}</p>
                    <p><strong>Direction:</strong> ${metadata.direction}</p>
                `;
                
                // è©³ç´°æƒ…å ±
                document.getElementById('metaOutput').textContent = JSON.stringify(metadata, null, 2);
                
                log('âœ… å¤šè¨€èªãƒ¡ã‚¿ã‚¿ã‚°ã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ ãƒ¡ã‚¿ã‚¿ã‚°ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testGameStateContext = async function() {
            try {
                log('ğŸ® ã‚²ãƒ¼ãƒ çŠ¶æ…‹é€£æºãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...');
                
                const gameState = {
                    score: 150000,
                    level: 5,
                    achievements: ['combo_master', 'speed_demon'],
                    playTime: 1200
                };
                
                const metadata = await i18nManager.generateLocalizedMetaTags({
                    pageType: 'game',
                    gameState: gameState
                });
                
                document.getElementById('metaOutput').textContent = JSON.stringify(metadata, null, 2);
                log('âœ… ã‚²ãƒ¼ãƒ çŠ¶æ…‹é€£æºãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ ã‚²ãƒ¼ãƒ çŠ¶æ…‹ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.generateStructuredData = async function() {
            try {
                log('ğŸ“Š æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆä¸­...');
                
                const gameData = {
                    screenshots: [
                        '/assets/screenshots/game-portrait-1.png',
                        '/assets/screenshots/game-landscape-1.png'
                    ],
                    video: '/assets/videos/gameplay-trailer.mp4'
                };
                
                const structuredData = await i18nManager.generateLocalizedStructuredData(
                    currentLanguage, 
                    gameData
                );
                
                document.getElementById('structuredOutput').textContent = JSON.stringify(structuredData, null, 2);
                log('âœ… æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testAllLanguagesStructured = async function() {
            try {
                log('ğŸŒ å…¨è¨€èªã®æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...');
                
                const languages = ['ja', 'en', 'zh-CN', 'zh-TW', 'ko'];
                const allData = {};
                
                for (const lang of languages) {
                    const data = await i18nManager.generateLocalizedStructuredData(lang);
                    allData[lang] = data;
                }
                
                document.getElementById('structuredOutput').textContent = JSON.stringify(allData, null, 2);
                log('âœ… å…¨è¨€èªæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ å…¨è¨€èªãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.generateMultilingualSitemap = async function() {
            try {
                log('ğŸ—ºï¸ å¤šè¨€èªã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚’ç”Ÿæˆä¸­...');
                
                const baseUrls = ['/', '/help/', '/stats/', '/achievements/'];
                const sitemap = await i18nManager.generateMultilingualSitemap(baseUrls);
                
                lastGeneratedSitemap = sitemap;
                document.getElementById('sitemapOutput').textContent = sitemap;
                
                log('âœ… å¤šè¨€èªã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.downloadSitemap = function() {
            if (!lastGeneratedSitemap) {
                log('âš ï¸ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ãšç”Ÿæˆã—ã¦ãã ã•ã„ã€‚', 'warning');
                return;
            }
            
            try {
                const blob = new Blob([lastGeneratedSitemap], { type: 'application/xml' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = 'multilingual-sitemap.xml';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                log('âœ… ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.validateI18nSEO = async function() {
            try {
                log('âœ… SEOå¤šè¨€èªåŒ–æ¤œè¨¼ã‚’å®Ÿè¡Œä¸­...');
                
                const validation = i18nManager.validateI18nSEO();
                
                // æ¤œè¨¼çµæœã®è¡¨ç¤º
                const resultsDiv = document.getElementById('validationResults');
                const isValid = validation.isValid;
                
                resultsDiv.innerHTML = `
                    <div class="validation-result ${isValid ? 'valid' : 'invalid'}">
                        <h4>${isValid ? 'âœ… æ¤œè¨¼åˆæ ¼' : 'âŒ æ¤œè¨¼ä¸åˆæ ¼'}</h4>
                        <p><strong>ã‚µãƒãƒ¼ãƒˆè¨€èªæ•°:</strong> ${validation.supportedLanguages}</p>
                        <p><strong>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨€èª:</strong> ${validation.defaultLanguage}</p>
                        <p><strong>LocalizationManagerçµ±åˆ:</strong> ${validation.hasLocalizationManager ? 'âœ…' : 'âŒ'}</p>
                    </div>
                `;
                
                document.getElementById('validationOutput').textContent = JSON.stringify(validation, null, 2);
                
                log(`${isValid ? 'âœ…' : 'âŒ'} æ¤œè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸ`);
            } catch (error) {
                log(`âŒ æ¤œè¨¼ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.generateComplianceReport = async function() {
            try {
                log('ğŸ“‹ ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆä¸­...');
                
                const report = {
                    timestamp: new Date().toISOString(),
                    hreflangCompliance: await testHreflangCompliance(),
                    metaTagCompliance: await testMetaTagCompliance(),
                    structuredDataCompliance: await testStructuredDataCompliance(),
                    overallScore: 0
                };
                
                // ã‚¹ã‚³ã‚¢è¨ˆç®—
                const scores = [
                    report.hreflangCompliance.score,
                    report.metaTagCompliance.score,
                    report.structuredDataCompliance.score
                ];
                report.overallScore = Math.round(scores.reduce((a, b) => a + b, 0) / scores.length);
                
                document.getElementById('validationOutput').textContent = JSON.stringify(report, null, 2);
                log('âœ… ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆãŒå®Œæˆã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        async function testHreflangCompliance() {
            const languages = ['ja', 'en', 'zh-CN', 'zh-TW', 'ko'];
            const paths = ['/', '/help/'];
            let score = 0;
            const issues = [];
            
            for (const path of paths) {
                try {
                    const tags = await i18nManager.generateHreflangTags(path);
                    
                    // hreflangã‚¿ã‚°ã®æ•°ã‚’ãƒã‚§ãƒƒã‚¯
                    const hreflangCount = (tags.match(/hreflang=/g) || []).length;
                    const expectedCount = languages.length + 1; // +1 for x-default
                    
                    if (hreflangCount === expectedCount) {
                        score += 20;
                    } else {
                        issues.push(`Path ${path}: Expected ${expectedCount} hreflang tags, found ${hreflangCount}`);
                    }
                } catch (error) {
                    issues.push(`Path ${path}: ${error.message}`);
                }
            }
            
            return { score: Math.min(score, 100), issues };
        }
        
        async function testMetaTagCompliance() {
            const languages = ['ja', 'en', 'zh-CN', 'zh-TW', 'ko'];
            let score = 0;
            const issues = [];
            
            for (const lang of languages) {
                try {
                    mockLocalizationManager.setLanguage(lang);
                    const metadata = await i18nManager.generateLocalizedMetaTags();
                    
                    if (metadata.title && metadata.description && metadata.keywords) {
                        score += 20;
                    } else {
                        issues.push(`Language ${lang}: Missing required meta tags`);
                    }
                } catch (error) {
                    issues.push(`Language ${lang}: ${error.message}`);
                }
            }
            
            return { score: Math.min(score, 100), issues };
        }
        
        async function testStructuredDataCompliance() {
            const languages = ['ja', 'en'];
            let score = 0;
            const issues = [];
            
            for (const lang of languages) {
                try {
                    const data = await i18nManager.generateLocalizedStructuredData(lang);
                    
                    if (data['@context'] && data['@type'] && data.name && data.description) {
                        score += 50;
                    } else {
                        issues.push(`Language ${lang}: Missing required structured data properties`);
                    }
                } catch (error) {
                    issues.push(`Language ${lang}: ${error.message}`);
                }
            }
            
            return { score: Math.min(score, 100), issues };
        }
        
        window.simulateGameContext = async function() {
            try {
                log('ğŸ® ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆä¸­...');
                
                const gameContext = {
                    currentScene: 'GameScene',
                    playerData: {
                        score: 245000,
                        level: 8,
                        achievements: ['bubble_master', 'speed_demon', 'combo_king'],
                        totalPlayTime: 3600
                    },
                    gameState: {
                        bubblesPopped: 1250,
                        currentCombo: 15,
                        specialBubblesHit: 45
                    }
                };
                
                const metadata = await i18nManager.generateLocalizedMetaTags({
                    pageType: 'game',
                    gameState: gameContext.gameState,
                    playerData: gameContext.playerData,
                    titleKey: 'seo.titles.game_active',
                    descriptionKey: 'seo.descriptions.game_active'
                });
                
                document.getElementById('integrationOutput').textContent = JSON.stringify({
                    gameContext,
                    generatedMetadata: metadata
                }, null, 2);
                
                log('âœ… ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Œäº†ã—ã¾ã—ãŸ');
            } catch (error) {
                log(`âŒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        window.testSEOIntegration = async function() {
            try {
                log('ğŸ”„ SEOçµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...');
                
                const integrationTests = [];
                
                // ãƒ†ã‚¹ãƒˆ1: è¨€èªå¤‰æ›´æ™‚ã®ãƒ¡ã‚¿ã‚¿ã‚°æ›´æ–°
                for (const lang of ['ja', 'en', 'zh-CN']) {
                    mockLocalizationManager.setLanguage(lang);
                    const metadata = await i18nManager.generateLocalizedMetaTags();
                    integrationTests.push({
                        test: `Language Change to ${lang}`,
                        result: metadata.language === lang ? 'PASS' : 'FAIL',
                        metadata: {
                            language: metadata.language,
                            title: metadata.title,
                            locale: metadata.locale
                        }
                    });
                }
                
                // ãƒ†ã‚¹ãƒˆ2: hreflangã¨æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®ä¸€è²«æ€§
                const hreflangTags = await i18nManager.generateHreflangTags('/');
                const structuredData = await i18nManager.generateLocalizedStructuredData('ja');
                integrationTests.push({
                    test: 'hreflang and Structured Data Consistency',
                    result: (hreflangTags.includes('ja') && structuredData.inLanguage === 'ja') ? 'PASS' : 'FAIL',
                    details: {
                        hreflangHasJapanese: hreflangTags.includes('ja'),
                        structuredDataLanguage: structuredData.inLanguage
                    }
                });
                
                document.getElementById('integrationOutput').textContent = JSON.stringify(integrationTests, null, 2);
                
                const passedTests = integrationTests.filter(t => t.result === 'PASS').length;
                const totalTests = integrationTests.length;
                
                log(`âœ… SEOçµ±åˆãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ (${passedTests}/${totalTests} PASS)`);
            } catch (error) {
                log(`âŒ çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
            }
        };
        
        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function log(message, type = 'info') {
            console.log(`[SEO I18n Test] ${message}`);
            
            // ç”»é¢ã«ã‚‚è¡¨ç¤ºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
            const timestamp = new Date().toLocaleTimeString();
            console.log(`[${timestamp}] ${message}`);
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.addEventListener('DOMContentLoaded', function() {
            // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.dataset.tab;
                    
                    // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–ã®æ›´æ–°
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(targetTab).classList.add('active');
                });
            });
            
            // è¨€èªé¸æŠ
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const lang = this.dataset.lang;
                    
                    // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–è¨€èªã®æ›´æ–°
                    document.querySelectorAll('.language-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // è¨€èªå¤‰æ›´
                    currentLanguage = lang;
                    mockLocalizationManager.setLanguage(lang);
                    
                    log(`è¨€èªã‚’ ${lang} ã«å¤‰æ›´ã—ã¾ã—ãŸ`);
                });
            });
        });
        
        // åˆæœŸåŒ–ã®å®Ÿè¡Œ
        initialize();
    </script>
</body>
</html>